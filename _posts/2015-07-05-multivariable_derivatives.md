---
id: 3276
title: "אנליזה וקטורית - נגזרת ונגזרת חלקית"
date: 2015-07-05 22:31:59
layout: post
categories: 
  - אנליזה מתמטית
tags: 
  - נגזרת
  - נגזרת חלקית
  - נגזרת מכוונת
---
אחרי <a href="http://www.gadial.net/2015/07/02/vector_analysis_intro/">פוסט המבוא</a> שבו הבטחתי גדולות ונצורות, בואו נעבור לאקשן. כאמור, אני מניח ידע קודם אצל הקוראים, הן <a href="http://www.gadial.net/2010/09/05/calculus_intro/">באינפי של פונקציות ממשיות</a> והן ב<a href="http://www.gadial.net/2011/09/21/linear_algebra_overview/">אלגברה לינארית</a> (עד וכולל <a href="http://www.gadial.net/2012/02/06/inner_products_intro/">מכפלות פנימיות</a>) כך שלא אציג מחדש את המושגים הללו. אלא אם יש ערך מוסף כלשהו בלהציג אותם מחדש. כמו למשל עכשיו! אני רוצה שנדבר שוב על מהי נגזרת של פונקציה ממשית.

האינטואיציה הסטנדרטית מאחורי נגזרת של פונקציה {::nomarkdown}\( f:\mathbb{R}\to\mathbb{R}\){:/nomarkdown} היא למצוא את "קצב השינוי הרגעי" של פונקציה בנקודה מסויימת {::nomarkdown}\( a\in\mathbb{R}\){:/nomarkdown}. אינטואיציה סטנדרטית נוספת היא למצוא את <strong>המשיק</strong> לגרף הפונקציה באותה נקודה - קו ישר שבנקודה הזו הכיוון שלו הוא כמו הכיוון של הפונקציה. את "קצב השינוי הרגעי" לוקחים על ידי חישוב של קצב השינוי הממוצע לאורך פרק זמן, ואז מקטינים את פרק הזמן כך שהוא שואף לאפס; את המשיק מוצאים על ידי כך שמחשבים את המיתר בין גרף הפונקציה ב-{::nomarkdown}\( a\){:/nomarkdown} ונקודה נוספת {::nomarkdown}\( b\){:/nomarkdown}, קרובה אליה, ואז אנחנו משאיפים את {::nomarkdown}\( b\){:/nomarkdown} אל {::nomarkdown}\( a\){:/nomarkdown}. עבור האינטואיציה הראשונה, מה שאנחנו מוצאים הוא <strong>מספר ממשי</strong>; עבור האינטואיציה השניה מה שאנחנו מוצאים הוא <strong>פונקציה לינארית</strong> (קו ישר). הקשר בין השניים מיידי: המספר הממשי (<strong>המספר הנגזר</strong>) הוא השיפוע של הפונקציה הלינארית, שבתורה מכונה <strong>הדיפרנציאל</strong> של הפונקציה.

הפורמליזם של האינטואיציה הראשונה הוא זה:

{::nomarkdown}\( f^{\prime}\left(a\right)=\lim_{h\to0}\frac{f\left(a+h\right)-f\left(a\right)}{h}\){:/nomarkdown}

הביטוי {::nomarkdown}\( \frac{f\left(a+h\right)-f\left(a\right)}{h}\){:/nomarkdown} הוא בדיוק השינוי הממוצע בין ערך הפונקציה ב-{::nomarkdown}\( a\){:/nomarkdown} וערכה בנקודה אחרת {::nomarkdown}\( b\){:/nomarkdown}, רק שבמקום לכתוב {::nomarkdown}\( \frac{f\left(b\right)-f\left(a\right)}{b-a}\){:/nomarkdown} יותר קל לסמן {::nomarkdown}\( b=a+h\){:/nomarkdown} ולהמשיך משם.

את הביטוי הזה באופן די ברור אי אפשר להכליל כמו שהוא. בואו ניקח פונקציה {::nomarkdown}\( F:\mathbb{R}^{n}\to\mathbb{R}^{m}\){:/nomarkdown} וננסה לכתוב את הביטוי הזה עבורה:

{::nomarkdown}\( \lim_{h\to0}\frac{F\left(a+h\right)-F\left(a\right)}{h}\){:/nomarkdown}

מה נשבר כאן? ובכן, {::nomarkdown}\( h\){:/nomarkdown} היא חלק מה<strong>קלט</strong> של {::nomarkdown}\( F\){:/nomarkdown}, ולכן {::nomarkdown}\( h\in\mathbb{R}^{n}\){:/nomarkdown} היא וקטור. במונה אנחנו מקבלים את ה<strong>פלט</strong> של {::nomarkdown}\( F\){:/nomarkdown}, גם כן וקטור, רק שב-{::nomarkdown}\( \mathbb{R}^{m}\){:/nomarkdown}. אנחנו לא יודעים איך לאכול את הביטוי הזה מבחינה מתמטית; אין לנו דרך לחלק וקטורים אלו באלו, למעט במקרה שבו {::nomarkdown}\( n=1\){:/nomarkdown} (וכפי שנראה בהמשך, המקרה שבו {::nomarkdown}\( n=1\){:/nomarkdown} הוא אכן פשוט במיוחד, גם אם {::nomarkdown}\( m&gt;1\){:/nomarkdown}). אגב, כאן אנחנו מתפצלים מהאנליזה המרוכבת; שם מה שקורה הוא שמחלקים במספר מרוכב, שמצד אחד אמנם נראה כמו וקטור דו ממדי של מספרים ממשיים, ומצד שני במרוכבים <strong>כן</strong> ידוע לנו איך לבצע את החלוקה.

דרך אפשרית להתמודד עם הבעיה הזו היא לא לחלק ב-{::nomarkdown}\( h\){:/nomarkdown} אלא ב<strong>נורמה</strong> של {::nomarkdown}\( h\){:/nomarkdown}, כלומר ב-{::nomarkdown}\( \left\|h\right\|\){:/nomarkdown}. בדרך הזו נקבל "נגזרת" שהיא וקטור ב-{::nomarkdown}\( \mathbb{R}^{m}\){:/nomarkdown} ולא לגמרי ברור מה היא אומרת - חסרה לנו אינטואיציה.

אז בואו נעבור להגדרה השניה, עם המשיק. אמרנו ש-{::nomarkdown}\( f^{\prime}\left(a\right)\){:/nomarkdown} הוא השיפוע של המשיק, כלומר המשיק הוא הפונקציה {::nomarkdown}\( f^{\prime}\left(a\right)\left(x-a\right)+f\left(a\right)\){:/nomarkdown} (זו גאומטריה אנליטית: אם יש לנו ישר עם שיפוע {::nomarkdown}\( m\){:/nomarkdown} שעובר דרך {::nomarkdown}\( \left(a,b\right)\){:/nomarkdown} אז משוואותו היא {::nomarkdown}\( y=m\left(x-a\right)+b\){:/nomarkdown}). החלק שמעניין אותנו במשיק הוא הפונקציה {::nomarkdown}\( T\left(x\right)=f^{\prime}\left(a\right)x\){:/nomarkdown} - זו טרנספורמציה לינארית (המשיק עצמו איננו טרנספורמציה לינארית באופן כללי כי הוא לא עובר דרך ראשית הצירים). לחלק הזה אנחנו קוראים <strong>הדיפרנציאל</strong> של {::nomarkdown}\( f\){:/nomarkdown} בנקודה {::nomarkdown}\( a\){:/nomarkdown}. כדי לראות למה הוא מעניין, בואו נחזור אל הנוסחה:

{::nomarkdown}\( f^{\prime}\left(a\right)=\lim_{h\to0}\frac{f\left(a+h\right)-f\left(a\right)}{h}\){:/nomarkdown}

נעביר אגפים:

{::nomarkdown}\( \lim_{h\to0}\frac{f\left(a+h\right)-f\left(a\right)}{h}-f^{\prime}\left(a\right)=0\){:/nomarkdown}

נעלה למונה:

{::nomarkdown}\( \lim_{h\to0}\frac{f\left(a+h\right)-f\left(a\right)-f^{\prime}\left(a\right)h}{h}=0\){:/nomarkdown}

וקיבלנו:

{::nomarkdown}\( \lim_{h\to0}\frac{f\left(a+h\right)-f\left(a\right)-T\left(h\right)}{h}=0\){:/nomarkdown}

אז הנה הגדרה אלטרנטיבית: הדיפרנציאל של {::nomarkdown}\( f\){:/nomarkdown} הוא הטרנספורמציה הלינארית {::nomarkdown}\( T\){:/nomarkdown} שעבורה הגבול לעיל שווה לאפס. אפשר עם קצת עבודה להוכיח שאם קיימת טרנספורמציה לינארית כזו, אז היא יחידה, כך שההגדרה הגיונית.

את ההגדרה הזו אפשר להכליל בצורה פשוטה לפונקציות כלליות: אם {::nomarkdown}\( F:\mathbb{R}^{n}\to\mathbb{R}^{m}\){:/nomarkdown} אז הדיפרנציאל של {::nomarkdown}\( F\){:/nomarkdown} בנקודה {::nomarkdown}\( a\){:/nomarkdown}, אם הוא קיים, הוא הטרנספורמציה הלינארית היחידה שמקיימת

{::nomarkdown}\( \lim_{h\to0}\frac{f\left(a+h\right)-f\left(a\right)-T\left(h\right)}{\left\|h\right\|}=0\){:/nomarkdown}

אם הדיפרנציאל קיים, אז אומרים ש-{::nomarkdown}\( f\){:/nomarkdown} <strong>גזירה</strong> בנקודה {::nomarkdown}\( a\){:/nomarkdown}. במילה <strong>נגזרת</strong> משתמשים כדי לתאר או את {::nomarkdown}\( T\){:/nomarkdown} או את המטריצה המייצגת שלה; זה לא כל כך משנה כי ברור לנו שבמובנים המהותיים זה בדיוק אותו דבר. אם כן, עבור פונקציות ממשיות רגילות, הנגזרת היא בעצם מטריצה {::nomarkdown}\( 1\times1\){:/nomarkdown}!

הסימון המקובל לנגזרת של {::nomarkdown}\( f\){:/nomarkdown} בהקשר הזה הוא {::nomarkdown}\( Df\left(a\right)\){:/nomarkdown} (אם רוצים, אפשר לחשוב על {::nomarkdown}\( D\){:/nomarkdown} בתור אופרטור שלוקח את {::nomarkdown}\( f\){:/nomarkdown} ומחזיר פונקציה שלכל {::nomarkdown}\( a\){:/nomarkdown} מחזירה מטריצה/טרנספורמציה). שימו לב לאופן שבו כללי המשחק השתנו קצת ממה שהיה עם פונקציות ממשיות: בפונקציות ממשיות, {::nomarkdown}\( Df\){:/nomarkdown} הוא פונקציה ממשית (שמקבלת {::nomarkdown}\( a\){:/nomarkdown} ומחזירה את המטריצה {::nomarkdown}\( 1\times1\){:/nomarkdown} שדיברתי עליה, שגם היא מספר ממשי) ולכן אפשר היה לגזור שוב ושוב ושוב. כאן בבירור זה לא עובד ואין משמעות לסימון {::nomarkdown}\( DDf\){:/nomarkdown}, מה שאולי מעלה אצלכם את התהיה אם אי אפשר להגדיר גם נגזרות "רגילות" על פונקציות שכאלו.

אז בואו נתחיל עם דוגמה פשוטה ככל הניתן. פונקציה סקלרית (שמחזירה סקלר, כלומר הטווח שלה הוא ממימד 1) על המישור, {::nomarkdown}\( f:\mathbb{R}^{2}\to\mathbb{R}\){:/nomarkdown}. למשל, {::nomarkdown}\( f\left(x,y\right)=x\sin y\){:/nomarkdown}. אין לנו מושג כרגע איך למצוא לה את הנגזרת, אבל כל אחד מאיתנו שמיומן בגזירה כן יודע להתעלל בביטוי {::nomarkdown}\( x\sin y\){:/nomarkdown}: אם נחשוב לרגע על {::nomarkdown}\( y\){:/nomarkdown} כפרמטר ועל {::nomarkdown}\( x\){:/nomarkdown} בתור משתנה, ברור לנו איך אפשר לגזור את הביטוי הזה. פורמלית, אם אני אסמן {::nomarkdown}\( f_{y}\left(x\right)=x\sin y\){:/nomarkdown} אז קל לי לחשב את {::nomarkdown}\( f_{y}^{\prime}\left(x\right)=\sin y\){:/nomarkdown}. קל גם לחשב את {::nomarkdown}\( f_{x}^{\prime}\left(y\right)=x\cos y\){:/nomarkdown}. הנגזרות הללו נקראות <strong>נגזרות חלקיות</strong> של {::nomarkdown}\( f\){:/nomarkdown}, כי במובן מסויים אנחנו גוזרים רק חלק מ-{::nomarkdown}\( f\){:/nomarkdown}. עבור פונקציות במספר קטן של משתנים, נהוג להשתמש בסימן {::nomarkdown}\( \partial\){:/nomarkdown} לתיאור נגזרת חלקית, כמו שמשתמשים ב-{::nomarkdown}\( d\){:/nomarkdown} לתיאור נגזרת של פונקציה ממשית: דהיינו, אם מסמנים {::nomarkdown}\( \frac{df}{dx}\){:/nomarkdown} בתור הנגזרת של הפונקציה {::nomarkdown}\( f\left(x\right)\){:/nomarkdown}, אז מסמנים {::nomarkdown}\( \frac{\partial f}{\partial x},\frac{\partial f}{\partial y}\){:/nomarkdown} לתיאור שתי הנגזרות החלקיות של {::nomarkdown}\( f\left(x,y\right)\){:/nomarkdown}. זה סימון מאוד ידוע ופופולרי, אבל אני בקושי אשתמש בו, כי עבור פונקציות בעלות מספר שרירותי הוא הופך למסורבל. נאמר ש-{::nomarkdown}\( F\left(x_{1},\dots,x_{n}\right)\){:/nomarkdown} היא פונקציה סקלרית . אז במקום לכתוב {::nomarkdown}\( \frac{\partial F}{\partial x_{i}}\){:/nomarkdown} כבר יותר קל לכתוב {::nomarkdown}\( D_{i}F\){:/nomarkdown} וחסל.

אז בואו נדבר על נגזרות חלקיות של פונקציה כללית, אבל לא כללית עד הסוף - אני אמשיך לדבר על פונקציות סקלריות, שהטווח שלהן הוא ממימד אחד. באופן כללי, אם {::nomarkdown}\( F:\mathbb{R}^{n}\to\mathbb{R}^{m}\){:/nomarkdown}, אז נהוג לפרק אותה לרכיבים: לסמן {::nomarkdown}\( F=\left(f_{1},\dots,f_{m}\right)\){:/nomarkdown} כך ש-{::nomarkdown}\( f_{i}:\mathbb{R}^{n}\to\mathbb{R}\){:/nomarkdown} היא פונקציה סקלרית. את רוב התוצאות שנדבר עליהן אפשר לתאר עבור פונקציה סקלרית, ודי מובן מאליו איך "להרכיב" אותן עבור פונקציה כללית - עוד נעשה את זה, אבל כאמור, בואו נדבר רק על פונקציות סקלריות לרגע.

מצד אחד, אין דבר טבעי יותר מנגזרת חלקית עבור פונקציה בכמה משתנים. מצד שני, זו הגדרה שנראית צרה באופן כמעט שרירותי. הרי נגזרת חלקית היא מה שמקבלים כאשר מסתכלים על הפונקציה במקום על כל המרחב שבו היא מוגדרת, רק על ישר אחד, שבו היא נראית כמו פונקציה במשתנה יחיד עם פרמטרים - או ציר {::nomarkdown}\( x\){:/nomarkdown}, או ציר {::nomarkdown}\( y\){:/nomarkdown} וכדומה. אבל אפשר להסתכל עליה גם על כל ישר אחר. זה מוביל אותנו להגדרה של <strong>נגזרת מכוונת</strong>: אם {::nomarkdown}\( 0\ne u\in\mathbb{R}^{n}\){:/nomarkdown} הוא וקטור כלשהו שונה מאפס ב-{::nomarkdown}\( \mathbb{R}^{n}\){:/nomarkdown} ו-{::nomarkdown}\( F:\mathbb{R}^{n}\to\mathbb{R}\){:/nomarkdown} היא פונקציה, אז אפשר להגדיר את הנגזרת המכוונת של {::nomarkdown}\( F\){:/nomarkdown} עבור {::nomarkdown}\( u\){:/nomarkdown} בנקודה {::nomarkdown}\( a\){:/nomarkdown} בתור

{::nomarkdown}\( \lim_{h\to0}\frac{F\left(a+hu\right)-F\left(a\right)}{h}\){:/nomarkdown}

כאשר כאן {::nomarkdown}\( h\in\mathbb{R}\){:/nomarkdown} הוא סקלר. הנגזרות החלקיות הן מקרה פרטי של נגזרות מכוונות, עבור וקטורי הבסיס {::nomarkdown}\( e_{i}=\left(0,\dots,1,\dots,0\right)\){:/nomarkdown} של המרחב {::nomarkdown}\( \mathbb{R}^{n}\){:/nomarkdown} (שימו לב ש-{::nomarkdown}\( u\){:/nomarkdown} הוא חשוב, ולא רק הכיוון שלו; הכפלה של {::nomarkdown}\( u\){:/nomarkdown} בסקלר כלשהו תשפיע גם על הנגזרת המכוונת שהוא מגדיר. לכן לפעמים דורשים ש-{::nomarkdown}\( u\){:/nomarkdown} יהיה מנורמה 1).

עכשיו אפשר לחבר את כל המושגים הללו ביחד. ניקח {::nomarkdown}\( F:\mathbb{R}^{n}\to\mathbb{R}\){:/nomarkdown}. אם {::nomarkdown}\( F\){:/nomarkdown} גזירה, אז כל הנגזרות המכוונות שלה קיימות, וקל מאוד לקבל אותן - הנגזרת המכוונת בכיוון {::nomarkdown}\( u\){:/nomarkdown} בנקודה {::nomarkdown}\( a\){:/nomarkdown} היא בדיוק {::nomarkdown}\( DF\left(a\right)\cdot u\){:/nomarkdown} - כלומר, לוקחים את המטריצה שמייצגת את {::nomarkdown}\( DF\){:/nomarkdown} בנקודה {::nomarkdown}\( a\){:/nomarkdown} ומכפילים סקלרית ב-{::nomarkdown}\( u\){:/nomarkdown} (מטילים על {::nomarkdown}\( u\){:/nomarkdown}). כלומר, {::nomarkdown}\( DF\){:/nomarkdown} מקודדת איכשהו את המידע על <strong>כל</strong> הנגזרות המכוונות של {::nomarkdown}\( F\){:/nomarkdown}. מצד שני, זה אומר שעכשיו ברור לגמרי איך לחשב את {::nomarkdown}\( DF\){:/nomarkdown}: אנחנו יודעים ש-{::nomarkdown}\( DF\left(a\right)\){:/nomarkdown} הוא וקטור ב-{::nomarkdown}\( \mathbb{R}^{n}\){:/nomarkdown} (מטריצה {::nomarkdown}\( 1\times n\){:/nomarkdown}) ולכן ניתן להצגה כצירוף לינארי {::nomarkdown}\( \sum_{i=1}^{n}\lambda_{i}e_{i}\){:/nomarkdown}, כאשר המקדמים נתונים בדיוק על ידי {::nomarkdown}\( \left(a\right)\cdot e_{i}\){:/nomarkdown}{::nomarkdown}\( \lambda_{i}=DF\){:/nomarkdown}. מסקנה: {::nomarkdown}\( DF\left(a\right)=\left(D_{1}F\left(a\right),\dots,D_{n}F\left(a\right)\right)\){:/nomarkdown}. הוקטור הזה כל כך חשוב שנותנים לו <strong>עוד</strong> סימון ושם: הוא נקרא <strong>הגרדיאנט</strong> של {::nomarkdown}\( F\){:/nomarkdown} ומסומן {::nomarkdown}\( \nabla F\){:/nomarkdown} (למשולש הזה קוראים <strong>נבלה</strong>, אם רציתם לדעת).

ההוכחה של הטענה הזו היא קלה למדי ומראה כמה היא מתבקשת. נניח ש-{::nomarkdown}\( F\){:/nomarkdown} גזירה ויהא {::nomarkdown}\( u\){:/nomarkdown} וקטור שונה מאפס כלשהו. אנחנו רוצים להראות ש-{::nomarkdown}\( \lim_{h\to0}\frac{F\left(a+hu\right)-F\left(a\right)}{h}=DF\left(a\right)\cdot u\){:/nomarkdown}. כזכור, על פי הגדרת הנגזרת, {::nomarkdown}\( \lim_{t\to0}\frac{F\left(a+t\right)-F\left(a\right)-DF\left(a\right)\cdot t}{\left\|t\right\|}=0\){:/nomarkdown} (בהוכחה הזו {::nomarkdown}\( h\){:/nomarkdown} הוא סקלר ו-{::nomarkdown}\( t\){:/nomarkdown} הוא וקטור). מכיוון שהגבול הזה נכון עבור השאפה של {::nomarkdown}\( t\){:/nomarkdown} כללי לאפס, הוא נכון גם אם משאיפים את {::nomarkdown}\( t\){:/nomarkdown} לאפס רק לאורך ציר מסויים, הציר שמגדיר {::nomarkdown}\( u\){:/nomarkdown} (למי שלא מאמין, פשוט תפתחו את הגדרת האפסילון-דלתא ותראו). כלומר, אנחנו מקבלים את הגבול

{::nomarkdown}\( \lim_{h\to0}\frac{F\left(a+hu\right)-F\left(a\right)-DF\left(a\right)\cdot\left(hu\right)}{\left\|hu\right\|}=0\){:/nomarkdown}

נכפול את שני האגפים בקבוע {::nomarkdown}\( \left\|u\right\|\){:/nomarkdown}, נשתמש בהומוגניות של מכפלה סקלרית ושל נורמה, ונקבל

{::nomarkdown}\( \lim_{h\to0}\frac{F\left(a+hu\right)-F\left(a\right)}{\left\|h\right\|}-\frac{h}{\left\|h\right\|}DF\left(a\right)\cdot u=0\){:/nomarkdown}

אם {::nomarkdown}\( h\){:/nomarkdown} שואף לאפס מימין, אנחנו מקבלים בדיוק את מה שרצינו: {::nomarkdown}\( \lim_{h\to0^{+}}\frac{F\left(a+hu\right)-F\left(a\right)}{h}-DF\left(a\right)\cdot u=0\){:/nomarkdown}; אחרת, נכפול במינוס 1 ונקבל {::nomarkdown}\( \lim_{h\to0^{-}}\frac{F\left(a+hu\right)-F\left(a\right)}{h}-DF\left(a\right)\cdot u=0\){:/nomarkdown}. המסקנה הסופית היא שאכן מתקיים {::nomarkdown}\( \lim_{h\to0}\frac{F\left(a+hu\right)-F\left(a\right)}{\left\|h\right\|}=DF\left(a\right)\cdot u\){:/nomarkdown}.

אם כן, <strong>אם</strong> {::nomarkdown}\( F\){:/nomarkdown} היא גזירה, אז הנגזרת שלה נתונה בדיוק באמצעות הנגזרות החלקיות, מה שאומר שיש לנו עכשיו טכניקה פרקטית לחישוב נגזרת כללית על ידי רדוקציה לבעיה של חישוב נגזרת רגילה. מה שמפתיע הוא שההפך אינו נכון - ייתכן שכל הנגזרות החלקיות יהיו קיימות (או אפילו יותר מכך, כל הנגזרות המכוונות יהיו קיימות) ועדיין {::nomarkdown}\( F\){:/nomarkdown} לא תהיה גזירה. הגרדיאנט עדיין יהיה קיים, כמובן, אבל הוא לא יגדיר טרנספורמציה לינארית שמקרבת את {::nomarkdown}\( F\){:/nomarkdown} בצורה מוצלחת. הפתולוגיה הזו היא בדיוק הסיבה שבגללה הגדרנו נגזרת בצורה מוזרה שכזו במקום להתחיל מנגזרות חלקיות - התנאי של גזירות יותר חזק מהתנאי של קיום הנגזרות החלקיות. ההכללה לפונקציה {::nomarkdown}\( F:\mathbb{R}^{n}\to\mathbb{R}^{m}\){:/nomarkdown} קלה: {::nomarkdown}\( F\){:/nomarkdown} גזירה אם ורק אם כל הרכיבים שלה גזירים, ואם היא גזירה אז הנגזרת שלה היא המטריצה {::nomarkdown}\( m\times n\){:/nomarkdown} שהשורות שלה הן הגרדיאנטים של הרכיבים.

בואו נראה דוגמה לפונקציה {::nomarkdown}\( f:\mathbb{R}^{2}\to\mathbb{R}\){:/nomarkdown} שהגרדיאנט שלה קיים אבל היא לא גזירה:

{::nomarkdown}\( f\left(x,y\right)=\begin{cases}0 &amp; x=y=0\\\frac{x^{2}y}{x^{4}+y^{2}} &amp; \mbox{else}\end{cases}\){:/nomarkdown}

הרעיון כאן הוא ש-0 היא נקודה בעייתית עבור הפונקציה - הגדרנו את ערכה להיות 0 שם כי אם נקפיא את {::nomarkdown}\( x\){:/nomarkdown} או את {::nomarkdown}\( y\){:/nomarkdown} להיות 0 ונלך על הציר של המשתנה השני נקבל כל הזמן את הערך 0; אבל באותה מידה יכלנו להגדיר אותו להיות חצי, כי לאורך העקום {::nomarkdown}\( \left(t,t^{2}\right)\){:/nomarkdown} הערך של הפונקציה הוא {::nomarkdown}\( \frac{1}{2}\){:/nomarkdown}. כלומר, אין דרך טובה להגדיר את {::nomarkdown}\( f\){:/nomarkdown} כך שתהיה רציפה בראשית הצירים, ולא קשה לראות שכמו עבור פונקציות ממשיות, גם במקרה שלנו גזירות של פונקציה בנקודה גוררת רציפות שלה בנקודה.

מצד שני, אפשר לחשב כל נגזרת מכוונת ב-{::nomarkdown}\( \left(0,0\right)\){:/nomarkdown} בלי קושי של ממש. בואו נעשה את זה לפי הגדרה. ניקח {::nomarkdown}\( u=\left(a,b\right)\){:/nomarkdown}, ונחשב:

{::nomarkdown}\( \lim_{h\to0}\frac{f\left(0+hu\right)-f\left(0\right)}{h}=\lim_{h\to0}\frac{\left(ha\right)^{2}\left(hb\right)}{\left(ha\right)^{4}+\left(hb\right)^{2}}\frac{1}{h}=\lim_{h\to0}\frac{a^{2}b}{h^{2}a^{4}+b^{2}}=\frac{a^{2}}{b}\){:/nomarkdown}

כמובן, בהנחה ש-{::nomarkdown}\( b\ne0\){:/nomarkdown}, אחרת נקבל {::nomarkdown}\( 0\){:/nomarkdown}. בפרט ברור שהנגזרות החלקיות בנקודה הזו הן 0. אז על פניו טרנספורמציית האפס <strong>אמורה</strong> להיות הנגזרת של הפונקציה; אבל מן הסתם היא לא עובדת, ולכן הפונקציה לא גזירה למרות שהנגזרות החלקיות קיימות. הלקח כאן הוא שהסתכלות "חד ממדית" על הפונקציה מפספסת אינפורמציה חשובה - אפשר לקחת פונקציה שהיא כמו הפיל בסיפור על הפיל והעיוורים; שאם נסתכל עליה מכיוון מסויים, נראה משהו אחד, אבל אם נסתכל עליה מכיוון אחר נראה משהו שונה לחלוטין, וכך גם עבור כל כיוון הסתכלות חד ממדי אפשרי. חייבים להסתכל על הכל "בבת אחת" כדי לא לפספס.

חישבתי את הנגזרות החלקיות בנקודה 0, אבל עבור נקודות אחרות אני יכול לחשב אותן על פי חוקי הגזירה של פונקציות ממשיות: נאמר, כדי לגזור את {::nomarkdown}\( \frac{x^{2}y}{x^{4}+y^{2}}\){:/nomarkdown} לפי {::nomarkdown}\( x\){:/nomarkdown} אני חושב על {::nomarkdown}\( y\){:/nomarkdown} בתור קבוע ומשתמש בכללי הגזירה של מנת פונקציות. אני מקבל {::nomarkdown}\( \frac{2xy\left(x^{4}+y^{2}\right)-x^{2}y\left(4x^{3}\right)}{\left(x^{4}+y^{2}\right)^{2}}=\frac{2x^{5}y+2xy^{3}-4x^{5}y}{\left(x^{4}+y^{2}\right)^{2}}=\frac{2xy^{3}-2x^{5}y}{\left(x^{4}+y^{2}\right)^{2}}=\frac{2xy\left(y^{2}-x^{4}\right)}{\left(x^{4}+y^{2}\right)^{2}}\){:/nomarkdown}.

כששואפים ל-0 על צירי {::nomarkdown}\( x,y\){:/nomarkdown} מקבלים 0, אבל על הציר {::nomarkdown}\( \left(2t,t^{2}\right)\){:/nomarkdown} נקבל {::nomarkdown}\( \frac{4t^{3}\left(t^{4}-16t^{4}\right)}{\left(3t^{4}\right)^{2}}=-5\frac{t^{7}}{t^{8}}=-\frac{5}{t}\){:/nomarkdown}

והיצור הזה מתפוצץ כש-{::nomarkdown}\( t\){:/nomarkdown} שואף לאפס, כך שקיבלנו נגזרת חלקית לא רציפה. זה מרמז לנו מה בעייתי פה - נגזרות לא רציפות הן יצורים שמתנהגים בצורה מעצבנת. ואכן, מסתבר שתנאי מספיק לגזירות של פונקציה הוא שהנגזרות החלקיות שלה יהיו קיימות <strong>ורציפות</strong>. פונקציה כזו נקראת "גזירה ברציפות", ואומרים שהיא שייכת למחלקה {::nomarkdown}\( C^{1}\){:/nomarkdown} (באופן כללי, {::nomarkdown}\( C^{k}\){:/nomarkdown} היא מחלקת הפונקציות שגזירות {::nomarkdown}\( k\){:/nomarkdown} פעמים והנגזרות רציפות; ו-{::nomarkdown}\( C^{\infty}\){:/nomarkdown} היא מחלקת הפונקציות שגזירות מספר כלשהו של פעמים והנגזרות, מן הסתם, רציפות). לעתים קרובות נוח לנו מראש להגביל את הדיון רק לפונקציות שהן {::nomarkdown}\( C^{1}\){:/nomarkdown} ואז הכל מתנהג נחמד; אבל באופן כללי קיימים מקרים פתולוגיים שצריך להיות מודעים אליהם.

אז אם לסכם: אם {::nomarkdown}\( F\){:/nomarkdown} גזירה, אז נובע שכל הנגזרות החלקיות שלה קיימות - <strong>אבל</strong> זה לא אומר שהן רציפות. אם לעומת זאת כל הנגזרות החלקיות קיימות ורציפות, אז מובטח ש-{::nomarkdown}\( F\){:/nomarkdown} גזירה, <strong>אבל</strong> רק קיום הנגזרות החלקיות לא גורר רציפות. אם כן, הכרנו את הגיבורים של החלק הדיפרנציאלי של אנליזה וקטורית - הנגזרת והנגזרות החלקיות והמכוונות; וזמן טוב לעצור את הפוסט הזה הוא בדיוק אחרי ההוכחה שקיום נגזרות חלקיות רציפות גורר גזירות, כי זו לא הוכחה טריוויאלית.

פורמלית, הטענה שאני אוכיח היא זו: אם {::nomarkdown}\( A\subseteq\mathbb{R}^{n}\){:/nomarkdown} היא קבוצה פתוחה כך שלכל {::nomarkdown}\( a\in A\){:/nomarkdown} הנגזרות החלקיות של {::nomarkdown}\( F\){:/nomarkdown} קיימות ב-{::nomarkdown}\( a\){:/nomarkdown} ורציפות בה, אז {::nomarkdown}\( F\){:/nomarkdown} גזירה בכל נקודה של {::nomarkdown}\( A\){:/nomarkdown}. "קבוצה פתוחה" היא קבוצה {::nomarkdown}\( A\){:/nomarkdown} כך שלכל {::nomarkdown}\( a\in A\){:/nomarkdown} קיים "כדור פתוח" סביב {::nomarkdown}\( a\){:/nomarkdown} שמוכל כולו ב-{::nomarkdown}\( A\){:/nomarkdown}, כלומר יש {::nomarkdown}\( \varepsilon&gt;0\){:/nomarkdown} כך ש{::nomarkdown}\( \left\|x-a\right\|&lt;\varepsilon\){:/nomarkdown} גורר ש-{::nomarkdown}\( x\in A\){:/nomarkdown}.

הרעיון הבסיסי פשוט: אם כל הנגזרות החלקיות של {::nomarkdown}\( F\){:/nomarkdown} קיימות, אנחנו יודעים בדיוק איך {::nomarkdown}\( DF\left(a\right)\){:/nomarkdown} אמור להיראות: {::nomarkdown}\( DF\left(a\right)=\left(D_{1}F\left(a\right),\dots,D_{n}F\left(a\right)\right)\){:/nomarkdown}. לכן, בהינתן {::nomarkdown}\( h\in\mathbb{R}^{n}\){:/nomarkdown} כלשהו, {::nomarkdown}\( DF\left(a\right)\cdot h=\sum D_{i}F\left(a\right)h_{i}\){:/nomarkdown}. היעד שלנו הוא להוכיח שמתקיים {::nomarkdown}\( \lim_{h\to0}\frac{F\left(a+h\right)-F\left(a\right)-\sum D_{i}F\left(a\right)h_{i}}{\left\|h\right\|}=0\){:/nomarkdown}. אנחנו לא חייבים לטפל בכל {::nomarkdown}\( h\){:/nomarkdown} - מספיק לטפל בכל {::nomarkdown}\( h\){:/nomarkdown} שהוא קטן דיו כך שהכדור הפתוח ברדיוס {::nomarkdown}\( h\){:/nomarkdown} סביב {::nomarkdown}\( a\){:/nomarkdown} מוכל כולו ב-{::nomarkdown}\( A\){:/nomarkdown}.

לשם כך אני ארצה לקבל תיאור אחר של {::nomarkdown}\( F\left(a+h\right)-F\left(a\right)\){:/nomarkdown}, כזה שמשתמש בנגזרות החלקיות. האם זה מזכיר לכם משהו? זו סיטואציה דומה לזו של אחד מהמשפטים החשובים ביותר באינפי - משפט הערך הממוצע של לגראנז'. מכיוון שאני הולך להשתמש בו בהמשך, בואו נזכיר אותו. יש לנו פונקציה {::nomarkdown}\( f:\left[a,b\right]\to\mathbb{R}\){:/nomarkdown} שהיא גזירה לכל הפחות ב-{::nomarkdown}\( \left(a,b\right)\){:/nomarkdown} ורציפה על כל {::nomarkdown}\( \left[a,b\right]\){:/nomarkdown}. השינוי הממוצע של {::nomarkdown}\( f\){:/nomarkdown} בכל הקטע הזה שווה בדיוק ל-{::nomarkdown}\( \frac{f\left(b\right)-f\left(a\right)}{b-a}\){:/nomarkdown}. נגזרת, כזכור, היא תיאור של שינוי <strong>רגעי</strong>, ולכן כל עוד {::nomarkdown}\( a,b\){:/nomarkdown} מרוחקים זה מזה, לא מובטח שהנגזרת בנקודות הללו (אם היא בכלל קיימת) תתאר את השינוי הממוצע הזה. הקסם (ובעיני זה באמת קסם) הוא ש<strong>קיימת</strong> בקטע נקודה שעבורה זה כן עובד: קיימת נקודה {::nomarkdown}\( c\in\left(a,b\right)\){:/nomarkdown} כך ש-{::nomarkdown}\( \frac{f\left(b\right)-f\left(a\right)}{b-a}=f^{\prime}\left(c\right)\){:/nomarkdown}. דרך אחרת לחשוב על כך היא זו:{::nomarkdown}\( f\left(b\right)-f\left(a\right)=\left(b-a\right)f^{\prime}\left(c\right)\){:/nomarkdown}, כלומר גודל השינוי של הפונקציה בקטע כולו יכול להיגזר מהשינוי הרגעי שלה ברגע נתון אחד - אבל כמובן, צריך לדעת איזה רגע.

הבעיה היא ש-{::nomarkdown}\( F\left(a+h\right)-F\left(a\right)\){:/nomarkdown} הוא לא ביטוי שאפשר להפעיל עליו ישירות את לגראנז', כי אנחנו לא ב-{::nomarkdown}\( \mathbb{R}\){:/nomarkdown} אלא ב-{::nomarkdown}\( \mathbb{R}^{n}\){:/nomarkdown}. אבל כרגיל, אפשר לבצע מעין <strong>רדוקציה</strong> ל-{::nomarkdown}\( \mathbb{R}\){:/nomarkdown} על ידי פירוק הביטוי הזה ל<strong>טור טלסקופי</strong> של איברים שכל אחד מהם יהיה חד-ממדי באופיו (טור טלסקופי הוא טור שכל האיברים בו מצמצמים זה את זה למעט הראשון והאחרון; למשל, אם נפתח את המכפלה {::nomarkdown}\( \left(1+q+q^{2}+\dots q^{n}\right)\left(q-1\right)\){:/nomarkdown} נקבל טור טלסקופי שאחרי צמצום יישאר ממנו רק {::nomarkdown}\( q^{n+1}-1\){:/nomarkdown}, והופס קיבלנו את הנוסחה {::nomarkdown}\( 1+q+\dots+q^{n}=\frac{q^{n+1}-1}{q-1}\){:/nomarkdown} לטור הנדסי).

בואו נכתוב את {::nomarkdown}\( h\){:/nomarkdown} במפורש רגע: {::nomarkdown}\( h=\left(h_{1},h_{2},\dots,h_{n}\right)\){:/nomarkdown}. אפשר לתאר את {::nomarkdown}\( h\){:/nomarkdown} כסכום לפי הבסיס הסטנדרטי: {::nomarkdown}\( h=\sum_{i=1}^{n}h_{i}e_{i}\){:/nomarkdown}. יהיה נוח לסמן "סכומים חלקיים" של {::nomarkdown}\( a+h\){:/nomarkdown} באופן הבא: {::nomarkdown}\( p_{i}=a+\sum_{j=1}^{i}h_{j}e_{j}\){:/nomarkdown} (כאשר {::nomarkdown}\( p_{0}=a\){:/nomarkdown}, עם המוסכמה שלפיה הסכום הוא "ריק" אם האינדקס למעלה גדול מהערך ההתחלתי למטה). עכשיו קל לראות שמתקיים

{::nomarkdown}\( F\left(a+h\right)-F\left(a\right)=F\left(p_{n}\right)-F\left(p_{n-1}\right)+F\left(p_{n-1}\right)-\dots-F\left(p_{1}\right)+F\left(p_{1}\right)-F\left(p_{0}\right)\){:/nomarkdown}

זה טור טלסקופי שבו כל זוג של מחובר חיובי ואז שלילי, כלומר משהו מהצורה {::nomarkdown}\( F\left(p_{i}\right)-F\left(p_{i-1}\right)\){:/nomarkdown} מתאים לשני וקטורים שהם זהים, פרט לכך שקואורדינטה אחת במחובר החיובי היא {::nomarkdown}\( h_{i}\){:/nomarkdown} בעוד שמקבילתה במחובר השלילי היא 0; חשבו על כך כאילו אנחנו הולכים מהנקודה {::nomarkdown}\( h\){:/nomarkdown} אל הנקודה {::nomarkdown}\( 0\){:/nomarkdown} "ציר אחד בכל פעם". אם אתם לא רואים את זה, ציירו את הנקודות {::nomarkdown}\( \left(1,1,1\right),\left(0,1,1\right),\left(0,0,1\right),\left(0,0,0\right)\){:/nomarkdown} והסתכלו על המסלול שעובר דרכן בסדר זה: תראו שקיבלנו קוביה שאנחנו הולכים על צלעות שלה. בואו נכתוב את הטור שוב, בסימון מקוצר:

אני הולך להשתמש בלגראנז' על {::nomarkdown}\( F\left(p_{i}\right)-F\left(p_{i-1}\right)\){:/nomarkdown}, אבל מכיוון שהסימון אולי עדיין מבלבל, אני אכתוב את הכל במפורש בתור פונקציות ממשיות. נשתמש ב-{::nomarkdown}\( t\){:/nomarkdown} בתור משתנה שמייצג מספר ממשי. נגדיר {::nomarkdown}\( f_{i}\left(t\right)=F\left(p_{i-1}+te_{i}\right)\){:/nomarkdown} (כלומר, הרכיב ה-{::nomarkdown}\( i\){:/nomarkdown}-י הוא {::nomarkdown}\( t\){:/nomarkdown}). נסתכל על הקטע {::nomarkdown}\( \left[0,h_{i}\right]\){:/nomarkdown} (אם {::nomarkdown}\( h_{i}\){:/nomarkdown} שלילי אז צריך לכתוב את הקטע {::nomarkdown}\( \left[h_{i},0\right]\){:/nomarkdown}, אבל זה לא באמת משנה). בגלל שבחרנו את {::nomarkdown}\( h\){:/nomarkdown} להיות קטן מספיק כך שהסביבה של {::nomarkdown}\( a\){:/nomarkdown} ברדיוס {::nomarkdown}\( h\){:/nomarkdown} מוכלת ב-{::nomarkdown}\( A\){:/nomarkdown}, נקבל ש-{::nomarkdown}\( F\left(p_{i-1}+te_{i}\right)\){:/nomarkdown} מוגדרת לכל {::nomarkdown}\( t\in\left[0,h_{i}\right]\){:/nomarkdown}, ומהנתון לגבי הנגזרות החלקיות, {::nomarkdown}\( f_{i}\){:/nomarkdown} היא גם גזירה ברציפות שם - כאן זה קריטי לחלוטין ש-{::nomarkdown}\( f_{i}\){:/nomarkdown} מקפיאה את כל הרכיבים למעט אחד.

עכשיו אפשר להשתמש בלגראנז' על {::nomarkdown}\( f_{i}\){:/nomarkdown} ולקבל שקיימת נקודה {::nomarkdown}\( c_{i}\in\left[0,h_{i}\right]\){:/nomarkdown} כך ש-{::nomarkdown}\( f_{i}\left(h_{i}\right)-f_{i}\left(0\right)=h_{i}f_{i}^{\prime}\left(c_{i}\right)\){:/nomarkdown}. בואו נסמן ב-{::nomarkdown}\( q_{i}\){:/nomarkdown} את הנקודה המתאימה עבור {::nomarkdown}\( F\){:/nomarkdown}, כלומר {::nomarkdown}\( q_{i}=p_{i-1}+c_{i}e_{i}\){:/nomarkdown}. אז נקבל ש-{::nomarkdown}\( F\left(p_{i}\right)-F\left(p_{i-1}\right)=D_{i}F\left(q_{i}\right)h_{i}\){:/nomarkdown}. הנה קיבלנו את הלגראנז' שלנו. אם נחזור אל הטור הטלסקופי ממקודם, קיבלנו ש-

{::nomarkdown}\( F\left(a+h\right)-F\left(a\right)=\sum_{i=1}^{n}F\left(p_{i}\right)-F\left(p_{-1}\right)=\sum_{i=1}^{n}D_{i}F\left(q_{i}\right)h_{i}\){:/nomarkdown}

נחזור עכשיו אל הגבול שאנחנו רוצים להוכיח:

{::nomarkdown}\( \lim_{h\to0}\frac{F\left(a+h\right)-F\left(a\right)-\sum D_{i}F\left(a\right)h_{i}}{\left\|h\right\|}=0\){:/nomarkdown}

נציב בו את מה שקיבלנו, ונקבל:

{::nomarkdown}\( \lim_{h\to0}\frac{\sum D_{i}F\left(q_{i}\right)h_{i}-\sum D_{i}F\left(a\right)h_{i}}{\left\|h\right\|}=0\){:/nomarkdown}

או, יותר פשוט

{::nomarkdown}\( \lim_{h\to0}\sum\left(D_{i}F\left(q_{i}\right)-D_{i}F\left(a\right)\right)\frac{h_{i}}{\left\|h\right\|}=0\){:/nomarkdown}

הנקודות {::nomarkdown}\( q_{i}\){:/nomarkdown} תלויות ב-{::nomarkdown}\( h\){:/nomarkdown}; כאשר {::nomarkdown}\( h\){:/nomarkdown} שואף לאפס, הנקודות הללו שואפות ל-{::nomarkdown}\( a\){:/nomarkdown} (הוכיחו!). ומכיוון ש-{::nomarkdown}\( D_{i}F\){:/nomarkdown} רציפה, אז {::nomarkdown}\( \lim_{q_{i}\to a}D_{i}F\left(q_{i}\right)=D_{i}F\left(a\right)\){:/nomarkdown}, כלומר הביטוי {::nomarkdown}\( D_{i}F\left(q_{i}\right)-D_{i}F\left(a\right)\){:/nomarkdown} שואף לאפס. הוא מוכפל בביטוי {::nomarkdown}\( \frac{h_{i}}{\left\|h\right\|}\){:/nomarkdown}, שהוא כמובן חסום בערכו המוחלט על ידי {::nomarkdown}\( 1\){:/nomarkdown} (כי {::nomarkdown}\( \left\|h\right\|\){:/nomarkdown} גדול מהערך המוחלט של כל אחד מהרכיבים של {::nomarkdown}\( h\){:/nomarkdown}). לכן קיבלנו שהגבול הוא אכן אפס, וזה מה שרצינו.

לסיכום, הכרנו את הנגזרת, ולמדנו איך לבדוק שהיא קיימת ולחשב אותה בצורה פשוטה יחסית, עבור מחלקה גדולה ויפה של פונקציות ({::nomarkdown}\( C_{1}\){:/nomarkdown}). בפוסט הבא נראה עוד דברים מגניבים שקשורים אליה.
