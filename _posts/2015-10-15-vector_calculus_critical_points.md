---
id: 3296
title: "אנליזה וקטורית - מציאת ערכי קיצון"
date: 2015-10-15 15:55:49
layout: post
categories: 
  - אלגברה לינארית
  - אנליזה מתמטית
tags: 
  - בעיות קיצון
  - כופלי לגראנז'
---
<h2>חלק ראשון, שבו אנו מוצאים ערכי קיצון מקומיים</h2>
אחד מהשימושים הראשונים של החשבון הדיפרנציאלי והאינטגרלי, שאפשר להציג כבר בשלב מוקדם יחסית, כבר אחרי שראינו מהי נגזרת, הוא פתרון <strong>בעיות אופטימיזציה</strong>. למשל, מה הזווית הטובה ביותר שבה כדאי לזרוק כדור אם אנחנו רוצים למקסם את המרחק שהוא יגיע אליו. בבעיות כאלו יש לנו מערכת שההתנהגות שלה תלויה בפרמטר כלשהו ("הזווית שבה זורקים את הכדור"), ועבור ערכים שונים של הפרמטר אנחנו מקבלים "תוצאה" שהיא ערך מספרי כלשהו של המערכת ("המרחק שאליו הכדור מגיע") ואנחנו רוצים למצוא את הערך הטוב ביותר של הפרמטר מבחינתנו. לפעמים זה הערך שעבורו התוצאה היא הגדולה ביותר, ולפעמים זה הערך שעבורו התוצאה היא הקטנה ביותר, תלוי באופי הבעיה (לפעמים הערך הוא ה"מחיר" שאנחנו צריכים לשלם). בעיות אופטימיזציה צצות בתחומים שונים ומשונים במתמטיקה ויש טכניקות שונות ומשונות לטפל בהן. לעתים קרובות מאוד יש לנו <strong>אילוצים</strong> על הפרמטרים שהמערכת יכולה לקבל, ושקלול שלהם פנימה הוא חלק רציני מפתרון הבעיה.

מה שמתעסקים איתו בחדו"א הוא סיטואציה פשוטה יחסית, שבה המערכת מתוארת על ידי פונקציה {::nomarkdown}\( f:\mathbb{R}\to\mathbb{R}\){:/nomarkdown} שהיא "נחמדה", במובן זה שהיא גזירה. הרעיון הוא שאפשר להשתמש בנגזרת של {::nomarkdown}\( f\){:/nomarkdown} כדי לאתר מייד את כל נקודות המקסימום ומינימום <strong>הנקודתיות</strong> של הפונקציה; ובתקווה, אם אין הרבה כאלו, בדיקה קצרה תעלה מה מהן היא המבוקשת שלנו (שעבורה הערך הוא הטוב ביותר אבסולוטית עבור בחירת פרמטרים חוקית). זה לא עובד תמיד טוב, אבל זה עובד טוב מספיק כדי שזה יהיה שימושי ביותר. הטכניקה עצמה מאוד פשוטה - בכל נקודת קיצון מקומית של הפונקציה, הנגזרת שלה חייבת להתאפס (ההפך לאו דווקא נכון). הסיבה פשוטה: ניקח למשל נקודת מקסימום מקומית. כל עוד הפונקציה "עדיין לא הגיעה" אל נקודת המקסימום אבל היא קרובה אליה, היא <strong>עולה</strong> אליה; ומייד אחרי נקודת המקסימום היא <strong>יורדת</strong> ממנה. זה אומר שממש לפני ההגעה לנקודת הקיצון הנגזרת היא <strong>חיובית</strong> ומייד אחרי היא <strong>שלילית</strong>. זה מכריח את הנגזרת באותה נקודה להיות "בו זמנית חיובית ושלילית", כלומר בהכרח 0.

בסדרת הפוסטים הנוכחית אנחנו מתעסקים באנליזה וקטורית, כלומר בפונקציות ממשיות מרובות משתנים. אז יש לנו פונקציה {::nomarkdown}\( f:\mathbb{R}^{n}\to\mathbb{R}\){:/nomarkdown} ואנחנו רוצים לפתור את אותה בעיה - למצוא נקודות קיצון. קל לחשוב על הנקודות הללו בצורה ציורית כאשר {::nomarkdown}\( n=2\){:/nomarkdown} - אפשר לחשוב על {::nomarkdown}\( f\){:/nomarkdown} כאילו היא מתארת <strong>מפה טופוגרפית</strong>, במובן זה שלכל נקודה {::nomarkdown}\( \left(x,y\right)\){:/nomarkdown} במפה הדו-ממדית נתון לנו גם ה<strong>גובה</strong> של אותה נקודה, {::nomarkdown}\( f\left(x,y\right)\){:/nomarkdown}. נקודת מקסימום היא "פסגת הר" ונקודת מינימום היא "תחתית עמק". וזה מה שאנחנו רוצים למצוא.

הניחוש הנאיבי ביותר הוא שאותה אינדיקציה שעבדה במימד אחד תעבוד גם ב-{::nomarkdown}\( n\){:/nomarkdown} ממדים: אם יש לפונקציה נקודת קיצון ב-{::nomarkdown}\( a\in\mathbb{R}^{n}\){:/nomarkdown}, אז {::nomarkdown}\( Df\left(a\right)=0\){:/nomarkdown} (כאשר כאן {::nomarkdown}\( 0\){:/nomarkdown} מציין את <strong>טרנספורמציית האפס</strong>, טרנספורמציה לינארית שמחזירה 0 עבור הכל). למרבה השמחה, הניחוש הנאיבי הזה עובד, ואוכיח זאת עוד רגע; למרבה הצער, בכל זאת יש חלק קשה יותר, והוא ה<strong>סיווג</strong> של נקודות הקיצון הפוטנציאליות, שמטרתו להכריע מי הן נקודות הקיצון האמיתיות ומי הן אנומליות לא קשורות.

בואו ניתן כמה הגדרות פורמליות. כרגיל, כל מה שאנחנו מניחים על {::nomarkdown}\( f\){:/nomarkdown} הוא שהיא מוגדרת על קבוצה פתוחה {::nomarkdown}\( U\subseteq\mathbb{R}^{n}\){:/nomarkdown}; אין צורך להניח שהיא מוגדרת בכל מקום. עבור {::nomarkdown}\( f\){:/nomarkdown} כזו, אנחנו אומרים ש-{::nomarkdown}\( a\in U\){:/nomarkdown} היא <strong>נקודת מקסימום מקומית</strong> אם קיימת סביבה {::nomarkdown}\( V\){:/nomarkdown} של {::nomarkdown}\( a\){:/nomarkdown} ב-{::nomarkdown}\( U\){:/nomarkdown} ("סביבה" היא קבוצה פתוחה שמכילה את {::nomarkdown}\( a\){:/nomarkdown}) כך ש-{::nomarkdown}\( f\left(a\right)\ge f\left(x\right)\){:/nomarkdown} לכל {::nomarkdown}\( x\in V\){:/nomarkdown}. באופן דומה מגדירים גם נקודות מינימום.

עכשיו, בואו נגדיר <strong>נקודה קריטית</strong> של {::nomarkdown}\( f\){:/nomarkdown} בתור נקודה {::nomarkdown}\( a\){:/nomarkdown} שבה {::nomarkdown}\( f\){:/nomarkdown} אינה גזירה, או שהיא גזירה אבל {::nomarkdown}\( Df\left(a\right)=0\){:/nomarkdown}. המשפט הראשון שלנו אומר שאם {::nomarkdown}\( a\){:/nomarkdown} היא נקודת קיצון אז היא נקודה קריטית; אבל יכולות להיות נקודות קריטיות שאינן נקודות קיצון, וקוראים להן <strong>נקודות אוכף</strong> (כי נקודה שנמצאת על מושב האוכף היא דוגמה יפה לנקודה שבה הנגזרת מתאפסת אבל היא אינה נקודת קיצון). האתגר יהיה לזהות, בהינתן נקודה קריטית, האם היא נקודת קיצון או לא.

ההוכחה שנקודת קיצון היא קריטית מתבססת על <strong>רדוקציה</strong> למקרה החד ממדי. אם הפונקציה לא גזירה בנקודה, אז על פי הגדרה הנקודה היא נקודת קיצון; לכן אני מניח ש-{::nomarkdown}\( Df\left(a\right)\){:/nomarkdown} מוגדרת. כדי להראות ש-{::nomarkdown}\( Df\left(a\right)=0\){:/nomarkdown} אני צריך להוכיח שהטרנספורמציה הזו מחזירה 0, לא משנה על איזה וקטור היא מופעלת. ומה זו "הפעלה" של הנגזרת על וקטור {::nomarkdown}\( u\){:/nomarkdown}? אם תזכרו, כי דיברנו על זה מזמן מזמן, זה מה שנותן לנו את <strong>הנגזרת המכוונת</strong> של {::nomarkdown}\( f\){:/nomarkdown} בכיוון {::nomarkdown}\( h\){:/nomarkdown}, שהוגדרה כך: {::nomarkdown}\( \lim_{h\to0}\frac{f\left(a+hu\right)-f\left(a\right)}{h}\){:/nomarkdown}. עכשיו, בואו נגדיר פונקציה {::nomarkdown}\( \phi:\mathbb{R}\to\mathbb{R}\){:/nomarkdown} על ידי {::nomarkdown}\( \phi\left(h\right)=f\left(a+hu\right)\){:/nomarkdown}. אז קיבלנו ש-

{::nomarkdown}\( Df\left(a\right)\cdot u=\lim_{h\to0}\frac{f\left(a+hu\right)-f\left(a\right)}{h}=\lim_{h\to0}\frac{\phi\left(h\right)-\phi\left(0\right)}{h}=\phi^{\prime}\left(0\right)\){:/nomarkdown}

עכשיו, אם {::nomarkdown}\( a\){:/nomarkdown} היא נקודת קיצון של {::nomarkdown}\( f\){:/nomarkdown}, אז {::nomarkdown}\( 0\){:/nomarkdown} היא נקודת קיצון של {::nomarkdown}\( \phi\){:/nomarkdown}, ולכן {::nomarkdown}\( \phi^{\prime}\left(0\right)=0\){:/nomarkdown} (מהמשפט על נקודת קיצון במקרה החד ממדי), וסיימנו: ראינו ש-{::nomarkdown}\( Df\left(a\right)\cdot u=0\){:/nomarkdown} לכל {::nomarkdown}\( u\){:/nomarkdown} ולכן {::nomarkdown}\( Df\left(a\right)=0\){:/nomarkdown}. אז זה היה קל, כמובטח. מה הלאה?

בואו נראה שתי דוגמאות פשוטות כדי לקבל תחושה של נקודת קיצון אל מול נקודת אוכף. נתחיל מ-{::nomarkdown}\( f\left(x,y\right)=x^{2}+y^{2}\){:/nomarkdown} - גרף של הפונקציה הזו נראה כמו מין קערית שכזו. הגרדיאנט קל לחישוב: {::nomarkdown}\( \nabla f=\left(2x,2y\right)\){:/nomarkdown}. הוא מתאפס בדיוק בנקודה אחת: {::nomarkdown}\( x=y=0\){:/nomarkdown}. לכן זו הנקודה היחידה שעשויה להיות נקודת קיצון, וקל לראות במקרה הזה שמדובר על נקודת מינימום. מסקנה: אין נקודות מקסימום בכלל, אחרת היינו מקבלים עוד נקודות קריטיות.

עכשיו בואו נעבור לדבר על האוכף. נתבונן ב-{::nomarkdown}\( f\left(x,y\right)=x^{2}y+y^{2}x\){:/nomarkdown}. הגרדיאנט שלה הוא {::nomarkdown}\( \nabla f=\left(2xy+y^{2},2yx+x^{2}\right)\){:/nomarkdown}. אז קיבלנו מערכת של שתי משוואות בשני נעלמים עבור {::nomarkdown}\( \nabla f=0\){:/nomarkdown}. אם {::nomarkdown}\( y=0\){:/nomarkdown} אז {::nomarkdown}\( 2yx+x^{2}=0\){:/nomarkdown} גורר ש-{::nomarkdown}\( x=0\){:/nomarkdown} ולכן פרט לנקודת הקיצון הברורה ב-{::nomarkdown}\( x=y=0\){:/nomarkdown} אנחנו יכולים להניח בהמשך הניתוח ש-{::nomarkdown}\( x\ne0\){:/nomarkdown} וגם {::nomarkdown}\( y\ne0\){:/nomarkdown} ולכן אפשר לחלק בהם. כעת, אם {::nomarkdown}\( 2xy+y^{2}=0\){:/nomarkdown} נחלק ב-{::nomarkdown}\( y\){:/nomarkdown} ונקבל {::nomarkdown}\( y=-2x\){:/nomarkdown}, ובאופן סימטרי {::nomarkdown}\( x=-2y\){:/nomarkdown} מתקבל מהמשוואה השניה. קיבלנו {::nomarkdown}\( x=-2y=4x\){:/nomarkdown}, מה שגורר {::nomarkdown}\( x=0\){:/nomarkdown}, וזו סתירה להנחה שלנו שהוא שונה; לכן הנקודה הקריטית היחידה היא {::nomarkdown}\( x=y=0\){:/nomarkdown}. קל לראות שזו לא נקודת קיצון על ידי הסתכלות בישר {::nomarkdown}\( x=y\){:/nomarkdown}: עליו, הפונקציה היא {::nomarkdown}\( \phi\left(x\right)=f\left(x,x\right)=2x^{3}\){:/nomarkdown} ולכן עבור {::nomarkdown}\( x&gt;0\){:/nomarkdown} נקבל ערך חיובי ועבור {::nomarkdown}\( x&lt;0\){:/nomarkdown} נקבל ערך שלילי, ומכאן ש-{::nomarkdown}\( \left(0,0\right)\){:/nomarkdown} היא לא נקודת קיצון. זו סיטואציה דומה למה שקורה במימד אחד עם, למשל, {::nomarkdown}\( \tan x\){:/nomarkdown}.

אז איך מבדילים בין נקודת קיצון ובין "סתם" נקודה קריטית? בחדו"א של משתנה יחיד היה מבחן שעבד טוב במקרה שבו הפונקציה היא "נחמדה מספיק" - אם היא הייתה גזירה פעמיים, אז הנגזרת השניה שלה נתנה לנו את המידע הדרוש. אם הנגזרת השניה בנקודה הקריטית הייתה חיובית, הנקודה הייתה נקודת מינימום; אם היא הייתה שלילית, זו הייתה נקודת מקסימום; ואם היא הייתה 0 אז זו הייתה נקודה קריטית שאינה נקודת קיצון.

האינטואיציה כאן היתה פשוטה. בנקודת מינימום, רגע לפני הנקודה הפונקציה <strong>יורדת</strong>, כלומר בעלת נגזרת שלילית; רגע אחרי הנקודה הפונקציה <strong>עולה</strong>, כלומר בעלת נגזרת חיובית; זה אומר שבסביבות הנקודה, ה<strong>נגזרת</strong> היא פונקציה עולה (בהתחלה שלילית, אחר כך 0, לבסוף חיובית). אם היא פונקציה עולה, אז הנגזרת <strong>שלה</strong> היא חיובית. שיקול דומה מטפל גם בנקודת מקסימום. ומה קרה ב-{::nomarkdown}\( \tan x\){:/nomarkdown}, למשל? הפונקציה היא עולה <strong>כל הזמן</strong>, כלומר הנגזרת היא חיובית כל הזמן (למעט בנקודה הקריטית עצמה, שם היא 0). אבל בהתחלה הנגזרת היא פונקציה יורדת (מתחילה מאוד גדולה ולאט לאט קטנה עד שהיא מגיעה ל-0) ואחרי הנקודה הקריטית היא מתחילה לעלות מחדש. כלומר, בנקודה הקריטית הנגזרת היא חיובית <strong>קודם</strong> וחיובית <strong>אחר כך</strong>, כלומר הנקודה הקריטית היא <strong>נקודת מינימום</strong> של הנגזרת, ולכן הנגזרת השניה היא 0.

היינו שמחים להכליל את הטיעון הזה ל-{::nomarkdown}\( n\){:/nomarkdown} ממדים, וזה אכן מה שנעשה; אפשר להסיק את הקריטריון החד ממדי מהתוצאה שנראה. אבל למרבה הצער, הקריטריון שלנו יהיה <strong>מסובך</strong> משמעותית יותר מאשר במקרה החד משמעי, ודורש היכרות עם אלגברה לינארית. הקושי הוא בכך שאנחנו צריכים למצוא הכללה כלשהי ל"נגזרת השניה" של מימד אחד. הרי אצלנו "נגזרת" היא כבר לא פונקציה {::nomarkdown}\( f:\mathbb{R}^{n}\to\mathbb{R}\){:/nomarkdown} כמו הפונקציה שאותה גזרנו; היא אופרטור שלכל נקודה במרחב מתאים <strong>טרנספורמציה לינארית</strong> (או מטריצה, איך שתעדיפו להסתכל על זה), ואי אפשר לגזור את זה. אז אנחנו משתמשים במשהו אחר - מטריצה {::nomarkdown}\( n\times n\){:/nomarkdown} שכוללת את כל <strong>הנגזרות החלקיות המעורבות מסדר שני</strong>. המטריצה הזו נקראת <strong>הסיאן</strong>.

מה זו נגזרת חלקית אנחנו כבר יודעים - פשוט גוזרים את הפונקציה רק על פי משתנה בודד ומתייחסים ליתר בתור פרמטרים. ראינו כבר שאם {::nomarkdown}\( f\){:/nomarkdown} גזירה אז הנגזרת שלה ניתנת לתיאור בתור וקטור הנגזרות החלקיות של {::nomarkdown}\( f\){:/nomarkdown}. נגזרת חלקית "מסדר שני" היא מה שמתקבל כשגוזרים נגזרת חלקית שוב, ו"מעורבת" אומר שאפשר לגזור שוב על פי כל אחד מהמשתנים. אני מסמן {::nomarkdown}\( \frac{\partial^{2}f}{\partial x\partial y}\){:/nomarkdown} את מה שמתקבל כשאני גוזר את {::nomarkdown}\( f\){:/nomarkdown} קודם כל לפי המשתנה {::nomarkdown}\( x\){:/nomarkdown} ואז לפי המשתנה {::nomarkdown}\( y\){:/nomarkdown}. למשל, עבור פונקציית נקודת האוכף {::nomarkdown}\( f\left(x,y\right)=x^{2}y+y^{2}x\){:/nomarkdown} אנחנו יודעים ש-{::nomarkdown}\( \frac{\partial f}{\partial x}=2xy+y^{2}\){:/nomarkdown}, ולכן אם נגזור שוב לפי {::nomarkdown}\( y\){:/nomarkdown}, נקבל ש-{::nomarkdown}\( \frac{\partial^{2}f}{\partial x\partial y}=2x+2y\){:/nomarkdown}.

מטריצת הסיאן מתקבלת באופן דומה - הכניסה בשורה ה-{::nomarkdown}\( i\){:/nomarkdown} ובעמודה ה-{::nomarkdown}\( j\){:/nomarkdown} שווה לנגזרת החלקית קודם לפי המשתנה {::nomarkdown}\( x_{i}\){:/nomarkdown} ואחר כך לפי המשתנה {::nomarkdown}\( x_{j}\){:/nomarkdown}, כלומר {::nomarkdown}\( \left[H\right]_{ij}=\frac{\partial^{2}f}{\partial x_{i}\partial x_{j}}\){:/nomarkdown}. אם נכתוב את ההסיאן של {::nomarkdown}\( f\left(x,y\right)=x^{2}+y^{2}\){:/nomarkdown} נקבל {::nomarkdown}\( \left[\begin{array}{cc}2 &amp; 0\\0 &amp; 2\end{array}\right]\){:/nomarkdown}. אם נכתוב את ההסיאן של {::nomarkdown}\( f\){:/nomarkdown} של נקודת האוכף, נקבל {::nomarkdown}\( \left[\begin{array}{cc}2y &amp; 2x+2y\\2x+2y &amp; 2x\end{array}\right]\){:/nomarkdown}. שימו לב שזו מטריצה <strong>סימטרית</strong>, כלומר יוצא שהנגזרת המעורבת קודם לפי {::nomarkdown}\( x\){:/nomarkdown} ואז על פי {::nomarkdown}\( y\){:/nomarkdown} שווה לנגזרת המעורבת קודם על פי {::nomarkdown}\( y\){:/nomarkdown} ואז על פי {::nomarkdown}\( x\){:/nomarkdown}; זה לא מקרי וזה תמיד מתקיים אם שתי הנגזרות המעורבות הללו הן רציפות; אנחנו נניח מעכשיו ש-{::nomarkdown}\( f\){:/nomarkdown} היא ב-{::nomarkdown}\( C^{2}\){:/nomarkdown}, אחרת המשפט שאני מתאר לא יהיה נכון.

עכשיו אפשר לנסח את הקריטריון שלנו בלשון שאותה יבינו מי שמכירים אלגברה לינארית: אם בנקודה הקריטית ההסיאן הוא <strong>מטריצה חיובית לחלוטין</strong> (Positive Definite Matrix), אז הנקודה הקריטית היא נקודת מינימום; ואם ההסיאן הוא <strong>מטריצה שלילית לחלוטין</strong> (Negative Definite Matrix) אז הנקודה הקריטית היא נקודת מקסימום; ואחרת אין לנו מושג מהי הנקודה הקריטית. מן הסתם המושג המרכזי פה הוא "חיובית/שלילית לחלוטין" שתכף אסביר, אבל למי שרוצים את התכל'ס, תנאי שקול לכך שמטריצה תהיה חיובית לחלוטין הוא שכל הערכים העצמיים שלה יהיו חיוביים, ואילו עבור שלילית לחלוטין, שכולם יהיו שליליים. זה מסביר את התוצאה בשתי הדוגמאות שראינו; במקרה הראשון קיבלנו מטריצה שהערך העצמי היחיד שלה הוא 2 החיובי, ולכן הנקודה הקריטית היא נקודת מינימום; ובמקרה השני ההסיאן ב-{::nomarkdown}\( x=y=0\){:/nomarkdown} הוא מטריצת האפס, שהערך העצמי היחיד שלה הוא 0 שאינו חיובי או שלילי.

הנה הסבר קצר לגבי מה זה מוגדרת חיובית ולמה זה רלוונטי פה, בלי להיכנס להוכחות עד הסוף. אם אין לכם כוח אליו אתם מוזמנים לדלג להמשך, שבו מדברים על כופלי לגראנז' שהם נושא נפרד ומגניב וחשוב בפני עצמו.

אנחנו יודעים שכל מטריצה {::nomarkdown}\( A\){:/nomarkdown} מסדר {::nomarkdown}\( n\times n\){:/nomarkdown} מעל שדה {::nomarkdown}\( \mathbb{F}\){:/nomarkdown} מגדירה טרנספורמציה לינארית {::nomarkdown}\( T_{A}:\mathbb{F}^{n}\to\mathbb{F}^{n}\){:/nomarkdown}. אבל יש עוד סוג מעניין של העתקה בערך-לינארית שהמטריצה מגדירה: <strong>תבנית בילינארית</strong>, שהיא פונקציה {::nomarkdown}\( B_{A}:\mathbb{F}^{n}\times\mathbb{F}^{n}\to\mathbb{F}\){:/nomarkdown} שלינארית בכל אחד משני הרכיבים שלה בנפרד, ומוגדרת על ידי {::nomarkdown}\( B\left(v,u\right)=v^{t}Au\){:/nomarkdown} (כלומר, כופלים את המטריצה {::nomarkdown}\( A\){:/nomarkdown} בוקטור העמודה {::nomarkdown}\( u\){:/nomarkdown} כרגיל ומקבלים וקטור ב-{::nomarkdown}\( \mathbb{F}^{n}\){:/nomarkdown}, אבל אחר כך כופלים את התוצאה הזו גם בוקטור השורה {::nomarkdown}\( v^{t}\){:/nomarkdown}, דהיינו מבצעים מכפלה סקלרית של {::nomarkdown}\( v\){:/nomarkdown} ושל {::nomarkdown}\( Au\){:/nomarkdown}). כל תבנית בילינארית מגדירה, בתורה, גם פונקציה {::nomarkdown}\( g:\mathbb{F}^{n}\to\mathbb{F}\){:/nomarkdown} על ידי {::nomarkdown}\( g_{A}\left(v\right)=B_{A}\left(v,v\right)=v^{t}Av\){:/nomarkdown} (במילים, כופלים סקלרית את {::nomarkdown}\( v\){:/nomarkdown} בתמונה של {::nomarkdown}\( v\){:/nomarkdown} על ידי הטרנספורמציה הלינארית שמוגדרת על ידי {::nomarkdown}\( A\){:/nomarkdown}). לפונקציה כזו קוראים <strong>תבנית ריבועית</strong> והיא מה שמעניין אותנו כאן. דוגמה פשוטה לתבנית בילינארית היא <strong>מכפלה פנימית</strong>, ודוגמה פשוטה לתבנית ריבועית שמוגדרת על ידה היא <strong>נורמה</strong> (כמעט; כזכור, נורמה היא השורש של מכפלה פנימית של וקטור עם עצמו). תבניות בילינאריות וריבועיות מופיעות באינספור מקומות במתמטיקה, הגם שהן קצת פחות נפוצות מטרנספורמציות לינאריות, ולרוב מגיעים אליהן רק בקורס שני באלגברה לינארית.

עכשיו בואו נעזוב את האלגברה הלינארית הכללית ונזכור שאנחנו מדברים על המקרה שבו {::nomarkdown}\( \mathbb{F}=\mathbb{R}\){:/nomarkdown}. בממשיים יש <strong>יחס סדר</strong> - אפשר להגיד "חיובי" ו"שלילי" (אפילו ב-{::nomarkdown}\( \mathbb{C}\){:/nomarkdown} אי אפשר להגיד דברים כאלו). זה מוביל אותנו להגדרה שאנחנו רוצים - {::nomarkdown}\( A\){:/nomarkdown} היא מטריצה חיובית לחלוטין אם התבנית הריבועית שהיא מגדירה מקיימת ש-{::nomarkdown}\( g_{A}\left(x\right)&gt;0\){:/nomarkdown} לכל {::nomarkdown}\( x\ne0\){:/nomarkdown} (עבור {::nomarkdown}\( x=0\){:/nomarkdown} תמיד נקבל {::nomarkdown}\( g_{A}\left(x\right)=0\){:/nomarkdown}, כמובן). בדומה {::nomarkdown}\( A\){:/nomarkdown} היא שלילית לחלוטין אם {::nomarkdown}\( g_{A}\left(x\right)&lt;0\){:/nomarkdown} לכל {::nomarkdown}\( x\ne0\){:/nomarkdown}. עבור מטריצה מסדר {::nomarkdown}\( 1\times1\){:/nomarkdown} הקריטריון הזה שקול לכך שהכניסה היחידה של המטריצה תהיה חיובית/שלילית (כי אם {::nomarkdown}\( A=\left[a\right]\){:/nomarkdown} אז נקבל ש-{::nomarkdown}\( g_{A}\left(x\right)=a\cdot x^{2}\){:/nomarkdown}) ולכן קיבלנו פה הכללה של התוצאה עבור {::nomarkdown}\( n=1\){:/nomarkdown}.

כדי להבין למה זה עובד ומאיפה {::nomarkdown}\( H\){:/nomarkdown} הגיעה בכלל אני צריך לשלוף מהכובע שפן שלפחות לעת עתה בחרתי לא לתת לו פוסט, אבל אולי בעתיד כן - <strong>פולינומי טיילור</strong>. <a href="http://www.gadial.net/2010/03/27/exponent/">תיארתי אותם פעם</a> בבלוג במקרה החד ממדי, וכנראה שכדאי לתאר אותם בפירוט גם במקרה הרב ממדי, אבל לבינתיים אסתפק בהסבר קצר. כזכור, פולינום טיילור "רגיל" מאפשר לנו לקרב פונקציות מסובכות על ידי פולינומים שמחושבים מתוך כל הנגזרות של הפונקציה בנקודה מסויימת ש"סביבה" מפתחים אותה. פורמלית, {::nomarkdown}\( f\left(x_{0}+h\right)=\sum_{k=0}^{n}\frac{f^{\left(k\right)}\left(x_{0}\right)}{k!}h^{k}+R_{n+1}\left(x_{0},h\right)\){:/nomarkdown}, כאשר {::nomarkdown}\( \sum_{k=0}^{n}\frac{f^{\left(k\right)}\left(x_{0}\right)}{k!}h^{k}\){:/nomarkdown} הוא הפולינום, ואילו {::nomarkdown}\( R_{n+1}\left(x_{0},h\right)\){:/nomarkdown} היא פונקציית ה"שארית" שמתארת את הטעות של הפולינום (ומן הסתם לב העניין הוא לחסום את הגודל שלה, מה שיוצא שונה עבור פונקציות שונות ונקודות פיתוח שונות). לפעמים פשוט כותבים טור חזקות אינסופי, {::nomarkdown}\( \sum_{n=0}^{\infty}\frac{f^{\left(n\right)}\left(x_{0}\right)}{n!}h^{n}\){:/nomarkdown}, אבל עם הכתיב הזה צריך להיזהר כי לא בהכרח ברור עבור אילו ערכים של {::nomarkdown}\( h\){:/nomarkdown} הטור הזה מתכנס בכלל (עבור {::nomarkdown}\( h=0\){:/nomarkdown} הוא מתכנס תמיד, אבל פרט לכך? הדיון על <strong>רדיוס ההתכנסות</strong> של טורי חזקות הוא מעניין בפני עצמו וצריך להציג אותו בבלוג מתישהו) וגם לא ברור שאפילו אם הטור מתכנס, אז {::nomarkdown}\( f\left(x_{0}+h\right)\){:/nomarkdown} שווה לסכום שלו.

פולינומי טיילור של פונקציות {::nomarkdown}\( f:\mathbb{R}^{n}\to\mathbb{R}\){:/nomarkdown} עובדים בצורה דומה, אבל כפי שאתם מנחשים, צריך לזרוק פנימה את כל הנגזרות החלקיות וזה יוצא מתוסבך למדי לכתיבה בלי שמסכימים מראש על כל מני קיצורים. בכל זאת אני לא יכול להתאפק ואציג את הטור המלא של פיתוח סביב {::nomarkdown}\( \left(a_{1},\dots,a_{n}\right)\){:/nomarkdown}:

{::nomarkdown}\( \sum_{k_{1}=0}^{\infty}\cdots\sum_{k_{n}=0}^{\infty}\frac{\partial^{k_{1}}}{\partial x_{1}^{k_{1}}}\cdots\frac{\partial^{k_{n}}}{\partial x_{n}^{k_{n}}}f\left(a_{1},\dots,a_{n}\right)\frac{h_{1}^{k1}\cdots h_{n}^{k_{n}}}{k_{1}!\cdots k_{n}!}\){:/nomarkdown}

או במילים: כל איבר בטור הזה מתקבל על ידי כך שגוזרים את {::nomarkdown}\( f\){:/nomarkdown} מספר מסויים של פעמים על פי כל משתנה, כופלים את התוצאה בחזקות מתאימות של כניסות {::nomarkdown}\( \left(h_{1},\dots,h_{n}\right)\){:/nomarkdown} ומחלקים בעצרת מתאימה. בואו נראה דוגמה פשוטה עבור פונקציה {::nomarkdown}\( f\left(x,y\right)\){:/nomarkdown} שהיא ב-{::nomarkdown}\( C^{2}\){:/nomarkdown} ולכן {::nomarkdown}\( \frac{\partial^{2}f}{\partial x\partial y}=\frac{\partial^{2}f}{\partial y\partial x}\){:/nomarkdown}; נפתח את הטור עד סדר שני, כלומר עד וכולל ערכי ה-{::nomarkdown}\( k\){:/nomarkdown} שמקיימים {::nomarkdown}\( k_{1}+k_{2}=2\){:/nomarkdown}:

{::nomarkdown}\( f\left(x+h_{1},y+h_{2}\right)=f\left(x,y\right)+\frac{\partial f}{\partial x}\left(x,y\right)h_{1}+\frac{\partial f}{\partial y}\left(x,y\right)h_{2}+\frac{\partial^{2}f}{\partial x^{2}}\left(x,y\right)\frac{h_{1}^{2}}{2}+\frac{\partial^{2}f}{\partial y^{2}}\left(x,y\right)\frac{h_{2}^{2}}{2}+\frac{\partial^{2}f}{\partial x\partial y}\left(x,y\right)h_{1}h_{2}+R_{3}\left(h_{1},h_{2}\right)\){:/nomarkdown}

ואם יש לנו {::nomarkdown}\( n\){:/nomarkdown} משתנים, הכתיב נשאר דומה:

{::nomarkdown}\( f\left(x_{1}+h_{1},\dots,x_{n}+h_{n}\right)=f\left(x_{1},\dots,x_{n}\right)+\sum_{i=1}^{n}\frac{\partial f}{\partial x_{i}}\left(x_{1},\dots,x_{n}\right)h_{i}+\frac{1}{2}\sum_{i,j=1}^{n}\frac{\partial^{2}f}{\partial x_{i}\partial x_{j}}\left(x_{1},\dots,x_{n}\right)h_{i}h_{j}+R_{3}\left(h_{1},\dots,h_{n}\right)\){:/nomarkdown}

כאן אנחנו קצת מרמים בסימון אבל מתקנים את זה בו זמנית: למשל, בסכום מופיעים גם {::nomarkdown}\( \frac{\partial^{2}f}{\partial x_{1}\partial x_{2}}\){:/nomarkdown} וגם {::nomarkdown}\( \frac{\partial^{2}f}{\partial x_{2}\partial x_{1}}\){:/nomarkdown} למרות שהאיבר הזה (אלו שתי הצגות שונות לאותו איבר, כי אמרתי שבמקרה שלנו הנגזרות המעורבות שוות) אמור להופיע רק פעם אחת. אז יש לי ספירה כפולה, אבל זה מתקזז עם הכפל ב-{::nomarkdown}\( \frac{1}{2}\){:/nomarkdown} שהוספתי שם (אם תשימו לב, בנוסחה המקורית אם גזרנו פעמיים לפי אותו משתנה צריך לכפול ב-{::nomarkdown}\( \frac{1}{2!}\){:/nomarkdown} ואם גזרנו לפי שני משתנים שונים לא עושים את זה).

את כל זה אפשר לכתוב אפילו עוד יותר בקיצור:

{::nomarkdown}\( f\left(x+h\right)=f\left(x\right)+\nabla f\left(x\right)\cdot h+\frac{1}{2}H_{x}\left(h\right)+R_{3}\left(h\right)\){:/nomarkdown}

במילים אחרות, הגרדיאנט של {::nomarkdown}\( f\){:/nomarkdown} הוא "האיבר הראשון" בפיתוח טיילור של {::nomarkdown}\( f\){:/nomarkdown}, וההסיאן {::nomarkdown}\( H\){:/nomarkdown} הוא "האיבר השני". האנלוגיה למקרה החד ממדי (שבו האיבר הראשון בפיתוח הוא הנגזרת הראשונה, והאיבר השני הוא הנגזרת השניה) מובהקת כאן.

איך כל זה רלוונטי לענייננו? כזכור, אנחנו מניחים שב-{::nomarkdown}\( x\){:/nomarkdown} יש ל-{::nomarkdown}\( f\){:/nomarkdown} נקודה קריטית ורוצים לסווג אותה. נקודה קריטית פירושו של דבר ש-{::nomarkdown}\( \nabla f\left(x\right)=0\){:/nomarkdown}, כך שאפשר לכתוב את פיתוח הטיילור גם בתור

{::nomarkdown}\( f\left(x+h\right)-f\left(x\right)=\frac{1}{2}H_{x}\left(h\right)+R_{3}\left(h\right)\){:/nomarkdown}

נניח שההסיאן ב-{::nomarkdown}\( x\){:/nomarkdown} הוא חיובי לחלוטין, ולכן על פי המשפט אמור לנבוע מכך ש-{::nomarkdown}\( x\){:/nomarkdown} היא נקודת מינימום. אם {::nomarkdown}\( x\){:/nomarkdown} היא נקודת מינימום של {::nomarkdown}\( f\){:/nomarkdown}, אנחנו מצפים שאגף שמאל יהיה חיובי עבור כל ה-{::nomarkdown}\( h\){:/nomarkdown}-ים בסביבה קרובה מספיק של {::nomarkdown}\( x\){:/nomarkdown}. ומה קורה באגף ימין? יש לנו קרב ענקים בין ההסיאן ובין {::nomarkdown}\( R_{3}\left(h\right)\){:/nomarkdown}, השארית. כאן מגיע טיעון אינפי סטנדרטי - אם ניקח {::nomarkdown}\( h\){:/nomarkdown} "מספיק קטן" אז מצד אחד השארית תהיה קטנה מאוד, ומצד שני ההסיאן יחזיר לנו ערך שהוא יחסית גדול <strong>וחיובי</strong>, והערך הזה "ינצח" בתחרות. אני אדלג על המשך ההוכחה כי הוא טכני באופן סטנדרטי ואומר בדיוק את זה; הפואנטה המרכזית היא שבגלל שההסיאן הוא פונקציה "נחמדה" (בילינארית) מקבלים שקיים קבוע {::nomarkdown}\( M\){:/nomarkdown} כלשהי כך ש-{::nomarkdown}\( H\left(h\right)\ge M\\|h\\|^{2}\){:/nomarkdown} לכל {::nomarkdown}\( h\){:/nomarkdown}, וזה נותן לנו את ה"יחסית גדול וחיובי" שלנו. הפרטים הטכניים פחות קריטיים פה - מה שמעניין בסיפור הזה, לטעמי, הוא מאיפה ההסיאן הזה צץ בכלל; כשברור שזה הרכיב השני בפיתוח הטיילור של הפונקציה, ושהרכיב הראשון איננו עמנו עוד כי אנחנו בנקודה קריטית, העניין נהיה מאוד ברור.
<h2>חלק שני, שבו כל העסק נהיה מאולץ</h2>
בתחילת הפוסט אמרתי שבבעיות אופטימיזציה יש לנו לעתים קרובות <strong>אילוצים</strong> על המערכת, כלומר לא כל פרמטר הוא חוקי. זה מגדיל מייד את רמת הקושי של הבעיה שלנו ועל פניו הופך את כל הטכניקה שראינו עד כה לחסרת תועלת. אתן דוגמה פשוטה. נסתכל על הפונקציה {::nomarkdown}\( f:\mathbb{R}^{2}\to\mathbb{R}\){:/nomarkdown} המוגדרת על ידי {::nomarkdown}\( f\left(x,y\right)=x\){:/nomarkdown}. בבירור אין לה לא נקודת מינימום ולא נקודת מקסימום בשום מקום ולכן הטכניקה שראינו קודם לא תסייע לנו עם העיסוק בה בכלל. מצד שני, אם נוסיף למערכת את האילוץ שהקלטים ל-{::nomarkdown}\( f\){:/nomarkdown} חייבים להילקח רק ממעגל היחידה, אז ברור שפתאום יש ל-{::nomarkdown}\( f\){:/nomarkdown} מקסימום ב-{::nomarkdown}\( \left(1,0\right)\){:/nomarkdown} ומינימום ב-{::nomarkdown}\( \left(-1,0\right)\){:/nomarkdown}. אבל איך מוצאים את זה?

לפני שנפתור את הבעיה הזו, צריך להבין מה המשמעות של "אילוץ". עבורנו זה אומר שנתונה פונקציה {::nomarkdown}\( g:\mathbb{R}^{n}\to\mathbb{R}\){:/nomarkdown} כלשהי ונתון {::nomarkdown}\( c\in\mathbb{R}\){:/nomarkdown}, ואנחנו מגדירים אילוץ על ידי המשוואה {::nomarkdown}\( g\left(x\right)=c\){:/nomarkdown}. כלומר, מותר לחפש את הפתרון רק בקרב ה-{::nomarkdown}\( x\){:/nomarkdown}-ים שמקיימים {::nomarkdown}\( g\left(x\right)=c\){:/nomarkdown}. בדוגמה שלי, {::nomarkdown}\( g\left(x,y\right)=x^{2}+y^{2}\){:/nomarkdown} ואילו {::nomarkdown}\( c=1\){:/nomarkdown}. כפי שבטח כבר ברור לכם, השיטה הזו להבעת אילוצים היא נוחה מאוד ומאפשרת לתאר שלל יצורים גאומטריים (ראינו כרגע מעגל; קו ישר מתואר על ידי {::nomarkdown}\( g\left(x,y\right)=ax-by\){:/nomarkdown} עבור {::nomarkdown}\( a,b\){:/nomarkdown} כלשהם, וכדומה).

כעת, נניח ש-{::nomarkdown}\( g\){:/nomarkdown} היא פונקציה "נחמדה" - גזירה. נסמן ב-{::nomarkdown}\( S\){:/nomarkdown} את המרחב שמוגדר על ידי {::nomarkdown}\( S=\left\{ x\in\mathbb{R}^{n}\ \|\ g\left(x\right)=c\right\} \){:/nomarkdown} (מעכשיו אקרא לו "משטח" כי בתלת מימד משוואות כאלו מגדירות משטחים; שם מדויק יותר למקרה הכללי שבו אני עוסק הוא <strong>יריעה</strong> אבל זה מושג לא טריוויאלי ואני לא רוצה להיכנס להגדרה שלו כרגע), וניקח {::nomarkdown}\( x_{0}\in S\){:/nomarkdown} כלשהו. הנה אבחנה מיידית שבלבלה אותי בצורה יוצאת דופן כשרק למדתי את הנושא הזה: {::nomarkdown}\( \nabla g\left(x_{0}\right)\){:/nomarkdown} הוא <strong>אורתוגונלי</strong> ל-{::nomarkdown}\( S\){:/nomarkdown} בנקודה {::nomarkdown}\( x_{0}\){:/nomarkdown}. הגרדיאנט של הפונקציה שמגדירה את המשטח ניצב למשטח באותה נקודה. למה זה מבלבל? כי לעתים קרובות נהוג להגדיר את הגרדיאנט של פונקציה בנקודה כלשהי בתור הוקטור שמצביע על הכיוון שבו היא "הכי תלולה". אם הגרדיאנט ניצב למשטח, הוא מצביע על כיוון שבו הפונקציה בכלל לא גדלה, וזה נראה הכי לא נכון שרק אפשר. אז למה זה מסתדר?

זה מסתדר כי עשיתי מיש-מש מכל העסק. הגרדיאנט לא ניצב <strong>לפונקציה</strong>; הוא ניצב <strong>למשטח שהפונקציה מגדירה בצורה מסויימת</strong>. מה שבלבל אותי בשעתו הוא שאפשר להגדיר משטחים בשתי דרכים שונות. דרך אחת, כללית פחות, היא לכתוב {::nomarkdown}\( z=f\left(x,y\right)\){:/nomarkdown} ובכך לתאר את המשטח {::nomarkdown}\( S=\left\{ \left(x,y,f\left(x,y\right)\right)\ \|\ x,y\in\mathbb{R}^{2}\right\} \){:/nomarkdown}; הדרך השניה, הכללית יותר, היא לכתוב {::nomarkdown}\( S=\left\{ \left(x,y,z\right)\ \|\ F\left(x,y,z\right)=c\right\} \){:/nomarkdown}. שימו לב שבדרך הראשונה אנחנו משתמשים בפונקציה של <strong>שני</strong> משתנים ובשניה בפונקציה של <strong>שלושה</strong> משתנים כדי להגדיר את אותו הדבר - משטח ב-{::nomarkdown}\( \mathbb{R}^{3}\){:/nomarkdown}. אם יש לי פונקציה {::nomarkdown}\( f:\mathbb{R}^{2}\to\mathbb{R}\){:/nomarkdown} ואני רוצה להציג את המשטח שמוגדר על ידה בדרך הראשונה בעזרת דרך ההצגה השניה, אני פשוט אגדיר {::nomarkdown}\( F\left(x,y,z\right)=z-f\left(x,y\right)\){:/nomarkdown} ו-{::nomarkdown}\( c=0\){:/nomarkdown}; לכן דרך ההצגה השניה כללית יותר. היא כללית יותר <strong>ממש</strong> (כלומר, יש דברים שאי אפשר לעשות בדרך הראשונה) כי למשל אני יכול לתאר את כדור היחידה על ידי {::nomarkdown}\( F\left(x,y,z\right)=x^{2}+y^{2}+z^{2}\){:/nomarkdown} ו-{::nomarkdown}\( c=1\){:/nomarkdown}, אבל אין לי דרך לעשות את זה באמצעות הצגת קואורדינטת ה-{::nomarkdown}\( z\){:/nomarkdown} כפונקציה של שתי האחרות (כי עבור אותם {::nomarkdown}\( x,y\){:/nomarkdown} עשויים להיות שני ערכי {::nomarkdown}\( z\){:/nomarkdown} אפשריים שונים על המשטח).

הנה הוכחה זריזה לכך שהגרדיאנט ניצב למשטח שהפונקציה מגדירה. הרעיון הוא לקחת מסלול כלשהו במשטח שעובר דרך {::nomarkdown}\( x_{0}\){:/nomarkdown} ולהראות שהגרדיאנט ב-{::nomarkdown}\( x_{0}\){:/nomarkdown} ניצב אליו. בלי להיכנס לעובי ההגדרות, מסלול הוא פונקציה גזירה {::nomarkdown}\( c:\left[0,1\right]\to\mathbb{R}^{n}\){:/nomarkdown}, ומסלול במשטח {::nomarkdown}\( S\subseteq\mathbb{R}^{n}\){:/nomarkdown} מקיים את הדרישה ש-{::nomarkdown}\( c\left(\left[0,1\right]\right)\subseteq S\){:/nomarkdown}, ונניח ש-{::nomarkdown}\( c\left(0\right)=x_{0}\){:/nomarkdown}. עכשיו, הרעיון במסלול שעובר דרך {::nomarkdown}\( S\){:/nomarkdown} הוא שכל נקודה בו מקיימת את האילוץ שמגדיר את {::nomarkdown}\( S\){:/nomarkdown}. נניח שהאילוץ הזה הוא {::nomarkdown}\( F\left(x\right)=c\){:/nomarkdown}, אז {::nomarkdown}\( F\left(c\left(t\right)\right)=c\){:/nomarkdown} לכל {::nomarkdown}\( t\in\left[0,1\right]\){:/nomarkdown}. עכשיו אפשר להשתמש בכלל השרשרת, לגזור ולקבל ש-{::nomarkdown}\( DF\left(c\left(0\right)\right)\cdot Dc\left(0\right)=0\){:/nomarkdown}, או בסימון קצת שונה, ש-{::nomarkdown}\( \nabla F\left(x_{0}\right)\cdot c^{\prime}\left(0\right)=0\){:/nomarkdown}. עכשיו, {::nomarkdown}\( c^{\prime}\left(0\right)\){:/nomarkdown} הוא בדיוק שיפוע המשיק ל-{::nomarkdown}\( c\){:/nomarkdown} ב-{::nomarkdown}\( x_{0}\){:/nomarkdown}, ואילו {::nomarkdown}\( \nabla F\left(x_{0}\right)\){:/nomarkdown} הוא הגרדיאנט של {::nomarkdown}\( F\){:/nomarkdown}, וקיבלנו שהמכפלה הפנימית שלהם היא 0 - כלומר, הם ניצבים.

עכשיו בואו נפתור את הבעיה של אופטימיזציה-עם-אילוצים. הפתרון הוא סוג של הכללה של מה שראינו קודם. קודם בדקנו איפה הגרדיאנט של {::nomarkdown}\( f\){:/nomarkdown} <strong>מתאפס</strong>. ההכללה שלנו תהיה לבדוק איפה הגרדיאנט של {::nomarkdown}\( f\){:/nomarkdown} שווה ל<strong>צירוף לינארי של האילוצים</strong>. המקדמים של האילוצים נקראים "<strong>כופלי לגראנז'</strong>", והשיטה נקראת על שמם - שיטת כופלי לגראנז'.

הנה הניסוח הפורמלי. נניח שיש לנו פונקציה {::nomarkdown}\( f:\mathbb{R}^{n}\to\mathbb{R}\){:/nomarkdown} שהיא מה שאנחנו רוצים לאפטמז, ופונקציות אילוצים {::nomarkdown}\( g_{1},\dots,g_{k}:\mathbb{R}^{n}\to\mathbb{R}\){:/nomarkdown} עם קבועים {::nomarkdown}\( c_{1},\dots,c_{k}\){:/nomarkdown} שמגדירות קבוצה {::nomarkdown}\( S\){:/nomarkdown} (כלומר, האילוץ הוא {::nomarkdown}\( g_{i}\left(x\right)=c_{i}\){:/nomarkdown} עבור {::nomarkdown}\( 1\le i\le k\){:/nomarkdown}). נניח ש-{::nomarkdown}\( x_{0}\){:/nomarkdown} היא נקודה שמקיימת את כל האילוצים ({::nomarkdown}\( g_{i}\left(x_{0}\right)=c_{i}\){:/nomarkdown}) וש-{::nomarkdown}\( \nabla g_{i}\left(x_{0}\right)\ne0\){:/nomarkdown}, ושיש ל-{::nomarkdown}\( f\|_{S}\){:/nomarkdown} מקסימום או מינימום מקומי ב-{::nomarkdown}\( x_{0}\){:/nomarkdown} (הסימון {::nomarkdown}\( f\|_{S}\){:/nomarkdown} פירושו "{::nomarkdown}\( f\){:/nomarkdown} מצומצמת ל-{::nomarkdown}\( S\){:/nomarkdown}"), אז קיימים {::nomarkdown}\( \lambda_{1},\dots,\lambda_{k}\in\mathbb{R}\){:/nomarkdown} כך ש-{::nomarkdown}\( \nabla f\left(x_{0}\right)=\lambda_{1}\nabla g_{1}\left(x_{0}\right)+\dots+\lambda_{k}\nabla g_{k}\left(x_{0}\right)\){:/nomarkdown}. זה אומר שכשאנחנו מחפשים נקודות קיצון, אנחנו מקבלים מערכת של משוואות שנקודות הקיצון חייבות להיכלל בפתרונות שלה.

בואו נראה איך זה עובד במקרה של דוגמת המעגל שנתתי קודם. מכיוון ש-{::nomarkdown}\( f\left(x,y\right)=x\){:/nomarkdown} אז {::nomarkdown}\( \nabla f=\left(1,0\right)\){:/nomarkdown}, ומכיוון ש-{::nomarkdown}\( g\left(x,y\right)=x^{2}+y^{2}\){:/nomarkdown}, אז {::nomarkdown}\( \nabla g=\left(2x,2y\right)\){:/nomarkdown}. משוואת כופלי לגראנז' נותנת לנו כאן את המשוואה {::nomarkdown}\( \left(1,0\right)=\lambda\left(2x,2y\right)\){:/nomarkdown} שמתורגמת בתורה לשתי משוואות פשוטות:

{::nomarkdown}\( 2x\lambda=1\){:/nomarkdown}

{::nomarkdown}\( 2y\lambda=0\){:/nomarkdown}

מהמשוואה הראשונה ברור ש-{::nomarkdown}\( \lambda\ne0\){:/nomarkdown} ולכן מהשניה קיבלנו ש-{::nomarkdown}\( y=0\){:/nomarkdown} הוא הכרחי. הנקודות היחידות שמקיימות את האילוץ {::nomarkdown}\( g\left(x,y\right)=1\){:/nomarkdown} ומקיימות {::nomarkdown}\( y=0\){:/nomarkdown} הן {::nomarkdown}\( \left(1,0\right)\){:/nomarkdown} ו-{::nomarkdown}\( \left(-1,0\right)\){:/nomarkdown} ועבור כל אחת מהן יש, כמובן, {::nomarkdown}\( \lambda\){:/nomarkdown} שפותר את המשוואה. קיבלנו ששתי אלו הן נקודות הקיצון שלנו, וזה אכן מה שהתחלתי ממנו.

חסרים לנו עוד שני דברים - אינטואיציה למה כל זה עובד, והוכחה. את ההוכחה המלאה אני לא אביא כאן, ובמקום זה אתן דגש חזק על הרעיונות הכלליים. הדבר הראשון שצריך להבין הוא שנתתי למעלה את הגרסה ה"שימושית" של המשפט - קחו את הגרדיאנט של {::nomarkdown}\( f\){:/nomarkdown}, אז הוא צירוף לינארי של הגרדיאנטים של האילוצים. זה משהו שקל להשתמש בו פרקטית, אבל זו לאו דווקא הדרך הקלה ביותר לחשוב על המשפט. אז הנה ניסוח <strong>כללי יותר</strong> של המשפט: אם {::nomarkdown}\( S\){:/nomarkdown} הוא משטח, {::nomarkdown}\( x_{0}\in S\){:/nomarkdown} היא נקודה על המשטח ו-{::nomarkdown}\( f\){:/nomarkdown} היא פונקציה כך של-{::nomarkdown}\( f\|_{S}\){:/nomarkdown} יש נקודת קיצון ב-{::nomarkdown}\( x_{0}\){:/nomarkdown}, אז <strong>המישור המשיק</strong> ל-{::nomarkdown}\( S\){:/nomarkdown} בנקודה {::nomarkdown}\( x_{0}\){:/nomarkdown} מוכל בגרעין של {::nomarkdown}\( \nabla f\left(x_{0}\right)\){:/nomarkdown}. אם אני אסמן את המישור המשיק ל-{::nomarkdown}\( S\){:/nomarkdown} בנקודה {::nomarkdown}\( x_{0}\){:/nomarkdown} בתור {::nomarkdown}\( T_{x_{0}}S\){:/nomarkdown} אז אפשר לכתוב פשוט {::nomarkdown}\( T_{x_{0}}S\subseteq\ker\left(\nabla f\left(x_{0}\right)\right)\){:/nomarkdown} (אתם אמורים להכיר גרעין כי זה מושג בסיסי באלגברה לינארית; אוסף כל הנקודות שמאפסות את הטרנספורמציה הלינארית {::nomarkdown}\( \nabla f\left(x_{0}\right)\){:/nomarkdown}).

המשפט הזה מכליל את התוצאה שלנו על נקודות קיצון ללא אילוצים: אם אין אילוצים, אז המשטח {::nomarkdown}\( S\){:/nomarkdown} שלנו הוא המרחב כולו, ולכן הדרך היחידה שבה הוא יהיה מוכל בגרעין של טרנספורמציה לינארית כלשהי הוא שזו תהיה טרנספורמציית האפס (עם זאת, כמו שנראה בהמשך, אנחנו משתמשים במשפט ה"בסיסי" כדי להוכיח את המשפט הכללי יותר, כך שאי אפשר להשתמש במשפט הכללי כדי לחסוך לנו עבודה).

הדרך להגיע מהניסוח הזה לניסוח שהצגתי קודם היא דרך תוצאה לא מרתקת במיוחד באלגברה לינארית: נניח ש-{::nomarkdown}\( f:\mathbb{R}^{n}\to\mathbb{R}\){:/nomarkdown} היא טרנספורמציה לינארית ו-{::nomarkdown}\( G:\mathbb{R}^{n}\to\mathbb{R}^{m}\){:/nomarkdown} היא טרנספורמציה לינארית, אז {::nomarkdown}\( \ker G\subseteq\ker f\){:/nomarkdown} אם ורק אם קיימים {::nomarkdown}\( \lambda_{1},\dots,\lambda_{m}\){:/nomarkdown} כך ש-{::nomarkdown}\( f=\sum\lambda_{i}G_{i}\){:/nomarkdown}, כאשר {::nomarkdown}\( G_{i}\){:/nomarkdown} הוא ההטלה של {::nomarkdown}\( G\){:/nomarkdown} לרכיב ה-{::nomarkdown}\( i\){:/nomarkdown}, כלומר {::nomarkdown}\( G_{i}\left(a\right)=\left[G\left(a\right)\right]_{i}\){:/nomarkdown}.

מה שמעניין הוא להבין מה האינטואיציה שמאחורי המשפט הכללי. למה שהוא יהיה נכון? הנקודה הקריטית היא שאם {::nomarkdown}\( S\){:/nomarkdown} הוא משטח שמוגדר בצורה "נחמדה מספיק" אז בהינתן נקודה {::nomarkdown}\( x_{0}\in S\){:/nomarkdown} כלשהי, יש סביבה של {::nomarkdown}\( x_{0}\){:/nomarkdown} ש<strong>נראית כמו </strong>תת-מרחב לינארי של {::nomarkdown}\( \mathbb{R}^{n}\){:/nomarkdown}. ההגדרה של "יריעה", שאני חומק ממנה בפוסט הזה, מפרמלת את הרעיון הזה; בואו נראה דוגמה פשוטה. את המעגל שלנו מתחילת הפוסט אפשר לתאר באמצעות <strong>פרמטריזציה</strong>: פונקציה גזירה {::nomarkdown}\( p:\mathbb{R}\to\mathbb{R}^{2}\){:/nomarkdown} שמוגדרת על ידי {::nomarkdown}\( p\left(t\right)=\left(\sin t,\cos t\right)\){:/nomarkdown}. על ה-{::nomarkdown}\( p\){:/nomarkdown} הזו אפשר <strong>להרכיב</strong> את {::nomarkdown}\( f\){:/nomarkdown} שלנו, שהיא הפונקציה שאנחנו מנסים לאפטמז, ולקבל את הפונקציה {::nomarkdown}\( \varphi\left(t\right)=f\left(p\left(t\right)\right)=\sin t\){:/nomarkdown}. קיבלנו פונקציה במשתנה בודד שמוגדרת מעל {::nomarkdown}\( \mathbb{R}\){:/nomarkdown}, כך שאפשר לחפש לה מקסימום ומינימום בדרך הרגילה - גוזרים ומשווים לאפס. תנסו, תראו שזה עובד.

אז גם באופן כללי, אם יש לנו פרמטריזציה של {::nomarkdown}\( S\){:/nomarkdown} בסביבה של {::nomarkdown}\( x_{0}\){:/nomarkdown} מצבנו טוב. בואו נניח ש-{::nomarkdown}\( p:\mathbb{R}^{n}\to\mathbb{R}^{n}\){:/nomarkdown} היא פרמטריזציה שכזו; פירוש הדבר הוא ש-{::nomarkdown}\( p\left(\mathbb{R}^{n}\right)\){:/nomarkdown} הוא סביבה של {::nomarkdown}\( x_{0}\){:/nomarkdown} ב-{::nomarkdown}\( S\){:/nomarkdown}. אנחנו מניחים שב-{::nomarkdown}\( x_{0}\){:/nomarkdown} יש ל-{::nomarkdown}\( f\){:/nomarkdown} נקודת קיצון מקומית; בואו נסמן ב-{::nomarkdown}\( a\in\mathbb{R}^{n}\){:/nomarkdown} נקודה שמקיימת {::nomarkdown}\( p\left(a\right)=x_{0}\){:/nomarkdown}. אז לפונקציה {::nomarkdown}\( f\left(p\left(t\right)\right)\){:/nomarkdown} יש נקודת קיצון מקומית ב-{::nomarkdown}\( a\){:/nomarkdown}, מה שאומר ש-{::nomarkdown}\( D\left[f\left(p\left(a\right)\right)\right]\){:/nomarkdown} תהיה טרנספורמציית האפס. מכלל השרשרת נובע שזה אומר ש-{::nomarkdown}\( Df\left(p\left(a\right)\right)\cdot Dp\left(a\right)\){:/nomarkdown} היא טרנספורמציית האפס.

עכשיו, את {::nomarkdown}\( Df\left(p\left(a\right)\right)\){:/nomarkdown} אנחנו מכירים בסימון קצת שונה. ראשית, {::nomarkdown}\( p\left(a\right)=x_{0}\){:/nomarkdown}. שנית, מכיוון ש-{::nomarkdown}\( f\){:/nomarkdown} היא פונקציה שמחזירה סקלר, אני מסמן את {::nomarkdown}\( Df\){:/nomarkdown} ב-{::nomarkdown}\( \nabla f\){:/nomarkdown}. כלומר, {::nomarkdown}\( Df\left(p\left(a\right)\right)=\nabla f\left(x_{0}\right)\){:/nomarkdown} הישן והטוב.

שנית, מה זה {::nomarkdown}\( Dp\left(a\right)\){:/nomarkdown}? זכרו ש-{::nomarkdown}\( p\){:/nomarkdown} היא פונקציה שמגדירה לנו משטח; לכן {::nomarkdown}\( Dp\left(a\right)\){:/nomarkdown} מתארת את המישור המשיק למשטח בנקודה {::nomarkdown}\( p\left(a\right)=x_{0}\){:/nomarkdown}, מה שסימנתי בתור {::nomarkdown}\( T_{x_{0}}S\){:/nomarkdown} (כן, זה היה נפנוף ידיים). כלומר, לכל קלט שהיא מקבלת, {::nomarkdown}\( Dp\left(a\right)\){:/nomarkdown} מחזירה לנו נקודה ששייכת ל-{::nomarkdown}\( T_{x_{0}}S\){:/nomarkdown}.

עכשיו, ראינו שההרכבה של {::nomarkdown}\( \nabla f\left(x_{0}\right)\){:/nomarkdown} על {::nomarkdown}\( Dp\left(a\right)\){:/nomarkdown} היא זהותית אפס. זה אומר שלכל קלט ש-{::nomarkdown}\( Dp\left(a\right)\){:/nomarkdown} מקבלת, הפלט שלה (נקודה ב-{::nomarkdown}\( T_{x_{0}}S\){:/nomarkdown}) יגרום ל-{::nomarkdown}\( \nabla f\left(x_{0}\right)\){:/nomarkdown} להחזיר אפס. מכיוון ש-{::nomarkdown}\( Dp\left(a\right)\){:/nomarkdown} היא פונקציה על כל {::nomarkdown}\( T_{x_{0}}S\){:/nomarkdown} נקבל את התוצאה - {::nomarkdown}\( T_{x_{0}}S\subseteq\ker\nabla f\left(x_{0}\right)\){:/nomarkdown}. הפורמליזם פה לא היה מלא אבל אני מקווה שהרעיון ברור עכשיו.
