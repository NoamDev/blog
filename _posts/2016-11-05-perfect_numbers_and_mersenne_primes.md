---
id: 3382
title: "מספרים מושלמים וראשוניי מרסן"
date: 2016-11-05 14:04:15
layout: post
categories: 
  - תורת המספרים
tags: 
  - מספר מושלם
  - מספר מרסן
  - פשוט
  - ראשוני מרסן
---
לפני זמן מה פנה אלי מישהו בשאלה - הוא הסתכל על רשימת המספרים המושלמים (מה זה מספר מושלם? תכף נגיע לזה), שם לב לכך שכל המספרים בה מסתיימים ב-6 או ב-28 ורצה לדעת אם זה מקרי או לא. או אחת מהדרכים הנחמדות ביותר להציג נושא מתמטי - לשים לב לאיזו שהיא תופעה "אמפירית" ואז להתחיל לחפור עד שמגיעים אל ההגיון הכללי הרבה יותר שגורר את אותה תופעה אמפירית. למרבה השמחה, הנושא הזה פשוט מספיק כדי שנוכל בפוסט אחד לענות על השאלה הזו בשלמות. התשובה הקצרה היא שזה אכן לא מקרי וזה נובע ישירות מקשר אמיץ שקיים בין המספרים המושלמים ובין ראשוניי מרסן (מה זה ראשוני מרסן? תכף נגיע לזה). בפוסט הזה נראה מה הקשר הזה, נכיר את שני הכוכבים שלו (מספרים מושלמים וראשוניי מרסן), ונסביר איך מזה מתקבל עניין ה-6 או 28.

הסיפור שלנו מתחיל עם האופן שבו אנחנו אוהבים לקחת מספרים טבעיים ולפרק להם את הצורה לגורמים. כלומר, למצוא מספרים שמחלקים אותם ולהציג את המכפלות הללו. למשל, את 36 אפשר לפרק ל-{::nomarkdown}\( 36=3\times12\){:/nomarkdown} או ל-{::nomarkdown}\( 36=36\times1\){:/nomarkdown} או ל-{::nomarkdown}\( 36=6\times6\){:/nomarkdown} או ל-{::nomarkdown}\( 36=2\times2\times3\times3\){:/nomarkdown}. הפירוק האחרון מעניין במיוחד כי אי אפשר "להמשיך לפרק" את המספרים שמופיעים בו - המספרים הללו (2,3) נקראים <strong>ראשוניים</strong>. הפירוק {::nomarkdown}\( 36\times1\){:/nomarkdown}, לעומת זאת, הוא קצת מעצבן כי לא באמת למדנו ממנו משהו חדש - סתם תקענו 1 בלי מטרה. זו סיבה אחת למה אנחנו לא קוראים ל-1 ראשוני למרות שגם אותו אי אפשר "להמשיך לפרק" - בניגוד למספרים אחרים, הוא לא תורם כלום למכפלות שבהן הוא משתתף ואפשר פשוט למחוק אותו. עכשיו, מה שנחמד במספרים ראשוניים הוא שלכל מספר טבעי גדול מ-1 קיים פירוק <strong>יחיד</strong> למכפלה של ראשוניים - גם אם ננסה לפרק את 36 בשתי דרכים שונות, בסוף נגיע אל {::nomarkdown}\( 2\times2\times3\times3\){:/nomarkdown} וכך גם לכל מספר אחר.

<strong>מספרים מושלמים</strong> נולדים מתוך המשחק הזה: ניקח מספר, נסתכל על כל המחלקים שלו שקטנים ממנו (כל אחד נספר רק פעם אחת), ואז נחבר את כולם. למשל, עבור 36 המחלקים שלו שקטנים ממנו הם {::nomarkdown}\( 1,2,3,4,6,9,12,18\){:/nomarkdown}. אם נחבר את כולם נקבל {::nomarkdown}\( 55\){:/nomarkdown}. זה לא נראה כרגע מעניין במיוחד, אבל אבל אנחנו משחקים פה משחק, אז בואו נקבל את זה שהתהליך הזה של "לקחת את כל המחלקים ולחבר אותם" הוא מעניין.

המחלקים של 55 הם רק {::nomarkdown}\( 1,5,11\){:/nomarkdown} ולכן סכום המחלקים של 55 הוא 17. מכיוון ש-{::nomarkdown}\( 17\){:/nomarkdown} ראשוני יש לו רק מחלק אחד שקטן ממנו שהוא 1, ולכן סכום המחלקים שלו הוא 1. כאן נפלנו על האף - אם אני אמשיך להפעיל את הפעולה של "סכום המחלקים" אני אמשיך להיות תקוע ב-1. זה אומר ש-1 הוא מין "נקודת שבת" - אם הגענו אליו, יותר לא נצא.

האם יש נקודות שבת אחרות? מספרים שסכום המחלקים שלהם שקטנים מהם שווה להם עצמם? למרבה השמחה יש ויש, ושתי הדוגמאות הראשונות הן 6 (עם המחלקים {::nomarkdown}\( 1,2,3\){:/nomarkdown}) ו-{::nomarkdown}\( 28\){:/nomarkdown} (עם המחלקים {::nomarkdown}\( 1,2,4,7,14\){:/nomarkdown}). מכיוון שהמשחק הזה היה ממש מעניין ליוונים הקדמונים, אוקלידס קרא למספרים כאלו <strong>מושלמים</strong> בספרו "יסודות" (מה זה "יסודות"? תכף נגיע לזה). מאז עברו אי-אלו שנים וגילינו הרבה תכונות מעניינות אחרות של מספרים, אבל אין מה לעשות - אוקלידס קרא למספרים הללו דווקא מושלמים, אז מכאן ועד לנצח זו תהיה התכונה שתהפוך מספר ל"מושלם".

בדרך כלל כשמציגים לנו הגדרה מתמטית נטולת הקשר שכזו, השאלה הנכונה לשאול היא לא "למה זה מעניין" כי כרגע זה עוד לא, אלא "אילו שאלות מעניינות אפשר לשאול על זה?". למשל, איך המספרים הללו נראים? כמה כאלו יש? האם יש נוסחה עבורם? מכיוון שיש לנו תשובות כלשהן עבור השאלות הללו ואלו תשובות <strong>יפות</strong>, גם המספרים עצמם הופכים למעניינים.

אבל נתחיל מהתעלומה הגדולה שעדיין קיימת. במהלך השנים, ובפרט מאז שמחשבים נכנסנו לשימוש, מצאנו המון מספרים מושלמים. כאמור, כולם מסתיימים ב-6 או ב-28, ובפרט כולם <strong>זוגיים</strong>. האם מספר מושלם אי זוגי פשוט לא יכול להתקיים? זו שאלה פתוחה. כיום אין לנו שום הוכחה לכך שמספר מושלם אי זוגי לא יכול להתקיים; פשוט מעולם לא מצאנו כזה ולא נראה סביר שנמצא אי פעם. העניין הוא שמרגע שמניחים את השאלה הפתוחה הזו בצד, ועוברים לדבר רק על מספרים מושלמים <strong>זוגיים</strong>, פתאום אפשר להגיד כל מני דברים מעניינים, כי את המספרים המושלמים הללו אנחנו מבינים יחסית טוב.

בואו נחזור לרגע אל אוקלידס. אם אתם לא מכירים, "יסודות" של אוקלידס הוא כנראה ספר המתמטיקה הראשון, ואולי גם החשוב ביותר שנכתב. אוקלידס ריכז בתוכו את המתמטיקה של תקופתו (והיוונים הללו התעסקו במתמטיקה לא מעט), אבל לא סתם ליקט ואסף - הספר בנוי בצורה מאוד זהירה של הגדרות, טענות, והוכחות - מבנה שעד היום ספרי המתמטיקה בנויים על פיו. אנחנו מכירים את אוקלידס בעיקר בהקשר של גיאומטריה של המישור, והיא אכן מהווה חלק נכבד מהספר; אבל הספר עוסק גם בדברים אחרים, ובפרט בתורת המספרים (אם כי האופן שבו הוא מציג מספרים גם הוא גיאומטרי במהותו, אבל על זה נדבר בפעם אחרת). אוקלידס מגדיר מספרים, ומחלקים שלהם, ואז מגדיר גם מספרים מושלמים (ספר 7 הגדרה 22), ואז עוזב את המספרים המושלמים בשקט למשך זמן רב עד לספר 9, טענה 36, שבה הוא מציג מעין שיטה לבנות מספרים מושלמים.

הנה מה שהוא מציע, בניסוח קצת יותר מודרני: קחו את המספרים {::nomarkdown}\( 1,2,4,8,\dots\){:/nomarkdown}, כלומר מתחילים מ-1 ואז כופלים שוב ושוב ב-2. את המספרים הללו בואו נחבר, כשאחרי כל חיבור אנחנו עוצרים כדי לבדוק אם קיבלנו מספר ראשוני. נניח שקיבלנו, אז בואו נכפול את המספר הראשוני שקיבלנו <strong>במחובר האחרון</strong> - הופס! התוצאה תהיה מספר מושלם!

זה נשמע כמו קסם, בואו נעשה את זה בפועל: {::nomarkdown}\( 1\){:/nomarkdown} לבדו הוא לא ראשוני (גם לא אצל אוקלידס). לעומת זאת, {::nomarkdown}\( 1+2=3\){:/nomarkdown} ו-3 הוא כן ראשוני; בואו נכפול אותו במחובר האחרון, כלומר ב-2, והופס! קיבלנו את 6, שהוא מספר מושלם. יפה! מה הלאה? {::nomarkdown}\( 1+2+4=7\){:/nomarkdown}, שהוא מספר ראשוני; נכפול ב-4 והופס! קיבלנו את {::nomarkdown}\( 28\){:/nomarkdown}, שהוא מספר מושלם. יפה! מה הלאה?

{::nomarkdown}\( 1+2+4+8=15\){:/nomarkdown} וזה לא מספר ראשוני, אבל {::nomarkdown}\( 1+2+4+8+16=31\){:/nomarkdown} שהוא כן ראשוני, ולכן {::nomarkdown}\( 16\times31=496\){:/nomarkdown} הוא מספר מושלם. ובוא נמשיך עם זה עוד טיפה: {::nomarkdown}\( 31+32=63\){:/nomarkdown} וזה לא מספר ראשוני ({::nomarkdown}\( 63=7\times9\){:/nomarkdown}) אבל {::nomarkdown}\( 63+64=127\){:/nomarkdown} שהוא כן מספר ראשוני, ולכן {::nomarkdown}\( 127\times64=8128\){:/nomarkdown} הוא מספר מושלם. ומה הלאה? ובכן, בואו לא נתקדם הלאה. העניין הוא שהמספרים הבאים בסכום יוצאים לא ראשוניים עד לשלב מתקדם יחסית, ואז זה כבר כאב ראש לבדוק אם קיבלנו משהו ראשוני או לא. אוקלידס עצמו לא הכיר, ככל הנראה, מספרים מושלמים מעבר לארבעה שמצאנו.

אם תסתכלו על החישובים שביצענו קל לראות שתמיד קיבלנו בסכום שלנו מספר ששווה לחזקה הבאה של 2 שעמדנו לחבר, פחות 1. למשל, {::nomarkdown}\( 1+2+4+8=15=16-1\){:/nomarkdown}. בסימונים אלגבריים, {::nomarkdown}\( 1+2+2^{2}+\dots+2^{n}=2^{n+1}-1\){:/nomarkdown}. אין כאן משהו מפתיע - זה מקרה פרטי של נוסחת הסכום של סדרה הנדסית {::nomarkdown}\( 1+q+q^{2}+\dots+q^{n}=\frac{q^{n+1}-1}{q-1}\){:/nomarkdown} (איך מוכיחים אותה? כפלו את שני האגפים ב-{::nomarkdown}\( q-1\){:/nomarkdown} ותראו מה קורה!). אז את השיטה של אוקלידס ניתן לתאר בנוסח המפושט הבא: אם {::nomarkdown}\( 2^{n}-1\){:/nomarkdown} הוא מספר ראשוני, אז {::nomarkdown}\( \left(2^{n}-1\right)\cdot2^{n-1}\){:/nomarkdown} יהיה מספר מושלם. אוקלידס לא נתן שמות למספרים מהצורה {::nomarkdown}\( 2^{n}-1\){:/nomarkdown}; הם נקראים <strong>מספרי מרסן</strong> על שם מתמטיקאי בן המאה ה-17 שכמובן לא המציא אותם אבל בנה רשימה גדולה (לזמנו, ועם כמה טעויות) של מספרי מרסן הראשוניים (ולכן, כפי שכבר ראינו, גם גילה על הדרך מספרים מושלמים). מספר מרסן ראשוני נקרא פשוט <strong>ראשוני מרסן</strong>, וגם בימינו הראשוניים הללו פופולריים להחריד; בכל פעם שבה מדווח על גילוי "המספר הראשוני הגדול ביותר אי פעם!!!!!" המספר הזה הוא ראשוני מרסן חדש שהתגלה (כבר גילינו 49 ובטח עוד כמה שנים נגלה עוד אחד). הסיבה לכך היא שיש מבחן בדיקת ראשוניות שמיועד ספציפית למספרי מרסן והיעילות שלו (ביחס לגודל של המספר הנבדק) היא משמעותית טובה יותר מהיעילות של שיטות כלליות לבדיקת ראשוניות, כך שאפשר לבדוק ראשוניות של מספרים גדולים מאוד בעיקר אם הם מספרי מרסן.

והנה צצה כמעט מעצמה עוד שאלה - ראינו שכל ראשוני מרסן יוצר לנו מספר מושלם. האם כל מספר מושלם נוצר באופן הזה? כלומר, האם בהינתן מספר מושלם <strong>כלשהו</strong> מובטח לנו שיהיה קיים מספר מרסן {::nomarkdown}\( 2^{n}-1\){:/nomarkdown} כלשהו כך שהמספר המושלם שלנו שווה ל-{::nomarkdown}\( \left(2^{n}-1\right)2^{n-1}\){:/nomarkdown} והגורם בסוגריים ראשוני? ובכן, מכיוון ש-{::nomarkdown}\( \left(2^{n}-1\right)2^{n-1}\){:/nomarkdown} הוא מספר זוגי, ברור שזה יכול לעבוד רק עבור מספרים מושלמים זוגיים; על האי-זוגיים אנחנו לא יודעים שום דבר. אבל עבור הזוגיים התוצאה הזו אכן מתקיימת: <strong>כל</strong> מספר מושלם זוגי הוא מהצורה {::nomarkdown}\( \left(2^{n}-1\right)2^{n-1}\){:/nomarkdown} כאשר {::nomarkdown}\( 2^{n}-1\){:/nomarkdown} הוא מספר ראשוני. את הדבר הזה לא הוכיח אוקלידס והוא חיכה כמה אלפי שנים עד שהוכיח אותו במאה ה-18 לאונרד אוילר, אחד מגדולי המתמטיקאים של כל הזמנים.

אז אם לסכם, מספרים מושלמים זוגיים וראשוניי מרסן קשורים זה לזה בקשר הדוק - לכל מספר מושלם זוגי יש ראשוני מרסן שיוצר אותו, וההפך. בפרט, אם תהיה לנו הוכחה לכך שקיימים אינסוף ראשוניי מרסן, זה יוכיח גם קיום של אינסוף מספרים מושלמים זוגיים, וכך גם בכיוון השני (אינסוף מספרים מושלמים זוגיים נותנים אינסוף ראשוניי מרסן). רק מה, עדיין אין לנו מושג איך להוכיח דבר שכזה.

נותרו לי עוד שתי שאלות, ואני לא יודע מה איתכם אבל בעיני הן המעניינות ביותר כאן: ראשית, מה עם ה-6 וה-28 הללו שנמצאים בסוף כל מספר מושלם? האם אנחנו כבר יכולים להבין למה הם שם? ושנית, איך מוכיחים את הטענות של אוקלידס ושל אוילר?

נתחיל מעניין ה-6 ו-28 הזה. איך אפשר להבין אותו, אם אנחנו רוצים לפתור את זה עצמאית? מה שאני הייתי עושה ראשית כל הוא לפתוח מחשב ולכתוב סקריפט שיחשב לי את כל הערכים של {::nomarkdown}\( \left(2^{n}-1\right)2^{n-1}\){:/nomarkdown} עבור 30 ה-{::nomarkdown}\( n\){:/nomarkdown}-ים הראשונים (בין אם {::nomarkdown}\( 2^{n}-1\){:/nomarkdown} הוא ראשוני ובין אם לאו) כדי לקבל תחושה של מה הולך פה. בשפה כמו רובי או פייתון זה סקריפט של שורה בודדת ולא צריך לדאוג לשטויות כמו מספרים גדולים מדי, כך שזה עניין פשוט מאוד (ולמתמטיקאים בעבר זה היה כאב ראש נוראי). חיש קל אפשר לראות שמקבלים מספרים משלושה סוגים בלבד: כאלו שמסתיימים ב-6; כאלו שמסתיימים ב-28; וכאלו שמסתיימים ב-0, למשל {::nomarkdown}\( 120=15\cdot8=\left(2^{4}-1\right)\cdot2^{3}\){:/nomarkdown}. מבין אלו, הכי קל להבין את אלו שמסתיימים ב-0 דווקא: מספר מסתיים ב-0 אם הוא מתחלק ב-10. מכיוון ש-{::nomarkdown}\( 10=2\times5\){:/nomarkdown}, מספר שמתחלק ב-10 צריך להתחלק הן ב-2 והן ב-5. עכשיו, המספר {::nomarkdown}\( \left(2^{n}-1\right)2^{n-1}\){:/nomarkdown} כבר מוצג לנו בתור פירוק לחלק זוגי (ה-{::nomarkdown}\( 2^{n-1}\){:/nomarkdown}) וחלק אי-זוגי, ה-{::nomarkdown}\( 2^{n}-1\){:/nomarkdown}. מכיוון שהחלק הזוגי הוא חזקה של 2 בלבד, המספרים היחידים שיכולים לחלק אותו הם זוגיים, ולכן מכיוון ש-5 הוא אי-זוגי, הוא מחלק רק את החלק האי-זוגי, לא את החלק הזוגי. במילים אחרות, קיבלנו שאם המספר שלנו מתחלק ב-10, אז {::nomarkdown}\( 2^{n}-1\){:/nomarkdown} מתחלק ב-5 ובפרט הוא איננו מספר ראשוני. זה מסביר למה אין ברשימה שלנו מספרים מושלמים שמסתיימים ב-0. עם זאת, עדיין נשאר להבין למה האפשרויות היחידות למה שהמספרים יסתיימו בהם הם או 0 או 6 או 28 - וכפי שאנחנו רואים, זו שאלה שבכלל לא קשורה לראשוניות של {::nomarkdown}\( 2^{n}-1\){:/nomarkdown}.

כעת, הספרה האחרונה של מכפלת שני מספרים נקבעת על פי המכפלה של הספרה האחרונה בכל אחד מהם; בניסוח מתמטי, {::nomarkdown}\( ab\){:/nomarkdown} מודולו 10 שווה למכפלה של {::nomarkdown}\( a\){:/nomarkdown} מודולו 10 ב-{::nomarkdown}\( b\){:/nomarkdown} מודולו 10, כל זה מודולו 10. במקרה שלנו {::nomarkdown}\( a=2^{n-1}\){:/nomarkdown} ואילו {::nomarkdown}\( b=2^{n}-1\){:/nomarkdown}. בדיקה מפורשת מראה לנו שהספרה האחרונה של חזקות של 2 מתנהגת באופן המחזורי הבא: {::nomarkdown}\( 2,4,8,6,2,4,8,6,\dots\){:/nomarkdown}. כדי לגלות איך מתנהגת הספרה האחרונה של מספר מרסן המתאים צריך לקחת כל מספר בסדרה הזו, להכפיל ב-2 ולהחסיר 1. מקבלים {::nomarkdown}\( 3,7,5,1,3,7,5,1\dots\){:/nomarkdown}. המכפלה (מודולו 10) של האיברים במקומות המתאימים בשתי הסדרות תיתן לנו את הסדרה {::nomarkdown}\( 6,8,0,6,6,8,0,6,\dots\){:/nomarkdown}. אז קיבלנו שהספרה האחרונה היא אכן תמיד 6 או 0 או 8. הדבר היחיד שחסר לנו הוא לראות שבמקרים שבהם הספרה האחרונה היא 8, <strong>שתי</strong> הספרות האחרונות ביחד הן 28. זה קצת יותר מסובך, כי עכשיו צריך להתחשב ב<strong>שתי</strong> הספרות האחרונות בכל המספרים שכופלים.

הנה נימוק פשוט יחסית שמטפל בסיטואציה הזו: ראשית, נשים לב לכך ש-{::nomarkdown}\( 2^{n}\){:/nomarkdown} מתחלק ב-4 תמיד פרט למקרה {::nomarkdown}\( n=1\){:/nomarkdown} שלא רלוונטי לנו כי בו הספרה האחרונה אינה 4. לכן אם הספרה האחרונה ב-{::nomarkdown}\( 2^{n}\){:/nomarkdown} היא 4, שתי הספרות האחרונות יכולות להיות רק {::nomarkdown}\( 04,24,44,64,84\){:/nomarkdown} (כי אם מספר מתחלק ב-4 שתי הספרות האחרונות שלו צריכות מרכיבות מספר שמתחלק ב-4). כדי לקבל את שתי הספרות האחרונות של מספר מרסן המתאים שוב פעם צריך לכפול ב-2 ולהחסיר 1, ולכן נקבל {::nomarkdown}\( 07,47,87,27,67\){:/nomarkdown}. בואו נחדד את זה: אני מקבל שמכפלת שתי הספרות האחרונות של שני המספרים היא מכפלה מהצורה {::nomarkdown}\( \left(4+20k\right)\left(7+40k\right)\){:/nomarkdown}, והמכפלה הזו יוצאת {::nomarkdown}\( 28+140k+160k+800k^2=28+300k+800k^2\){:/nomarkdown}. כלומר, 28 ועוד מספר ששתי הספרות האחרונות שלו הן 0, ולכן שתי הספרות האחרונות יצאו 28. זה עניין ממוזל; אין כאן קסם עמוק במיוחד. בסופו של דבר, זו תוצאה שתלויה בבסיס הספירה שלנו.

עכשיו סוף סוף אנחנו מגיעים אל החלק המתמטי הרציני שלנו - הוכחות לטענות של אוקלידס ושל אוילר. ההוכחות הללו מתבססות על להבין קצת יותר טוב איך מתנהגת הפעולה הזו שלוקחת מספר ומחזירה את סכום מחלקיו. לפני שאצטט תוצאה כללית, אתן דוגמה: אמרנו שסכום המחלקים של 36 הוא הסכום {::nomarkdown}\( 1+2+3+4+6+9+12+18\){:/nomarkdown}. האם יכלנו לכתוב את הסכום הזה בצורה יותר קומפקטית? כאן בדיוק נכנס הפירוק לגורמים של {::nomarkdown}\( 36\){:/nomarkdown} לעזרתנו. {::nomarkdown}\( 36=2^{2}\cdot3^{2}\){:/nomarkdown}. כל מחלק של 36 מתקבל מכך שאנחנו לוקחים חזקה של 2 בין 0 ל-2, וחזקה של 3 בין 0 ל-2, וכופלים את שתי החזקות הללו. למתמטיקאים יש טריק פשוט לייצר את כל סכומי המכפלות האפשריים - כפל של חיבור:

{::nomarkdown}\( \left(1+2+4\right)\left(1+3+9\right)\){:/nomarkdown}

כאן אנחנו כותבים חיבור של כל החזקות הרלוונטיות של 2 וכל החזקות הרלוונטיות של 4, וכופלים. כשנפתח את הסוגריים, מה שנקבל יהיה סכום של איברים, שכל אחד מהם מתקבל על ידי כך שאנחנו בוחרים מישהו מהסוגריים השמאליים ומישהו מהסוגריים הימניים וכופלים אותם. כל מחלק של 36 יתקבל בצורה הזו, כי הפירוק לגורמים של כל מחלק כזה כולל <strong>בדיוק את אותם גורמים ראשוניים</strong> כמו 36, רק אולי עם חזקות קטנות יותר (בפרט החזקה עשויה להיות 0 ואז הגורם "נעלם"). לרוע המזל, גם 36 בעצמו יתקבל בצורה הזו (הרי גם הוא מחלק של 36) אבל אנחנו התעניינו בפעולה של "סכום כל המחלקים שקטנים מהמספר". לא נורא, בואו נתאים את עצמנו לגישה החדשה הזו, כי עליה יהיה קל לנו להוכיח דברים. אני אגדיר פונקציה {::nomarkdown}\( \sigma\left(n\right)=\sum_{d\|n}d\){:/nomarkdown} שעוברת על כל הטבעיים שמחלקים את {::nomarkdown}\( n\){:/nomarkdown} כולל {::nomarkdown}\( n\){:/nomarkdown} עצמו, ומחברת אותם (זו משמעות הסימון {::nomarkdown}\( \Sigma\){:/nomarkdown} פה). אם {::nomarkdown}\( n\){:/nomarkdown} הוא מספר מושלם, הוא מקיים {::nomarkdown}\( \sigma\left(n\right)=2n\){:/nomarkdown} (כי סכום כל מחלקיו של {::nomarkdown}\( n\){:/nomarkdown} מושלם שכזה שווה ל-{::nomarkdown}\( n\){:/nomarkdown} עצמו ועוד סכום כל יתר מחלקיו, שסכומם הוא {::nomarkdown}\( n\){:/nomarkdown} גם כן). את מה שראינו קודם במקרה הפרטי של 36 אפשר כעת להכליל לנוסחה נחמדה: אם הפירוק לגורמים של {::nomarkdown}\( n\){:/nomarkdown} הוא {::nomarkdown}\( n=p_{1}^{k_{1}}\dots p_{t}^{k_{t}}\){:/nomarkdown} אז

{::nomarkdown}\( \sigma\left(n\right)=\left(1+p_{1}+p_{1}^{2}+\dots+p_{1}^{k_{1}}\right)\dots\left(1+p_{t}+p_{t}^{2}+\dots+p_{t}^{k_{t}}\right)\){:/nomarkdown}

את הזוועה הזו אפשר לכתוב בצורה מקוצרת באמצעות הסימונים המקוצרים לכפל וסכום:

{::nomarkdown}\( \sigma\left(n\right)=\prod_{i=1}^{t}\left(\sum_{j=0}^{k_{i}}p_{i}^{j}\right)\){:/nomarkdown}

אבל למה להסתבך עם הסימונים הללו כשאפשר לפשט בצורה יותר מועילה: אנחנו יודעים בדיוק למה שווה ביטוי כמו {::nomarkdown}\( 1+p+p^{2}+\dots+p^{k}\){:/nomarkdown}, כי זה סכום הנדסי: זה שווה ל-{::nomarkdown}\( \frac{p^{k+1}-1}{p-1}\){:/nomarkdown}. לכן נקבל:

{::nomarkdown}\( \sigma\left(n\right)=\left(\frac{p_{1}^{k_{1}+1}-1}{p_{1}-1}\right)\cdots\left(\frac{p_{t}^{k_{t}+1}-1}{p_{t}-1}\right)\){:/nomarkdown}

זו נוסחה נטולת סכומים ארוכים והיא מאפשרת לנו חישוב מהיר מאוד של {::nomarkdown}\( \sigma\left(n\right)\){:/nomarkdown} אם אנחנו יודעים מה הפירוק לגורמים של {::nomarkdown}\( n\){:/nomarkdown}, ממש בלי שנצטרך לעבור על כל המחלקים שלו. זו המחשה נחמדה מאוד לאופן שבו היכרות עם הפירוק לגורמים של מספר נותנת לנו עליו אינפורמציה לא טריוויאלית (לרוע המזל, למצוא את הפירוק לגורמים של מספר יכולה להיות בעיה קשה מאוד בפני עצמה).

הנוסחה הזו גם נותנת לנו את הטענה של אוקלידס <strong>באופן מיידי לחלוטין</strong>. למה? כי נניח ש-{::nomarkdown}\( 2^{k}-1\){:/nomarkdown} הוא מספר ראשוני. אז אנחנו יודעים <strong>בדיוק</strong> מה הפירוק לגורמים של המספר {::nomarkdown}\( n=\left(2^{k}-1\right)2^{k-1}\){:/nomarkdown}: יש לו שני גורמים ראשוניים בלבד, אחד מהם הוא {::nomarkdown}\( 2^{k}-1\){:/nomarkdown} שהחזקה שלו היא 1, והשני הוא {::nomarkdown}\( 2\){:/nomarkdown}, שהחזקה שלו היא {::nomarkdown}\( k-1\){:/nomarkdown}. נציב בנוסחה ונקבל:

{::nomarkdown}\( \sigma\left(n\right)=\left(1+\left(2^{k}-1\right)\right)\left(\frac{2^{k}-1}{2-1}\right)=2^{k}\left(2^{k}-1\right)=2\left(\left(2^{k}-1\right)2^{k-1}\right)=2n\){:/nomarkdown}

כאן את {::nomarkdown}\( 2^{k}-1\){:/nomarkdown} השארתי בתור סכום כי יש בו בסך הכל שני איברים, ועכשיו אנחנו יכולים <strong>להרגיש</strong> מה הולך פה: כשאנו מציבים בנוסחה, שני הרכיבים של {::nomarkdown}\( n=\left(2^{k}-1\right)2^{k-1}\){:/nomarkdown} "מחליפים תפקיד" - הרכיב הראשוני, ה-{::nomarkdown}\( 2^{k}-1\){:/nomarkdown}, הופך להיות פשוט חזקה של 2, בזמן שהרכיב השני, ה-{::nomarkdown}\( 2^{k-1}\){:/nomarkdown} מגדיל את המעריך שלו ב-1 ואז מפחיתים ממנו 1 כך שמקבלים חזרה את {::nomarkdown}\( 2^{k}-1\){:/nomarkdown}. מאוד אלגנטי לטעמי.

נעבור עכשיו לכיוון השני, של אוקלידס: אני אקח מספר {::nomarkdown}\( n\){:/nomarkdown} זוגי כלשהו שמקיים {::nomarkdown}\( \sigma\left(n\right)=2n\){:/nomarkdown} וארצה להוכיח שהוא מהצורה {::nomarkdown}\( n=\left(2^{k}-1\right)2^{k-1}\){:/nomarkdown}. איך נעשה את זה?

ראשית כל, אמרנו ש-{::nomarkdown}\( n\){:/nomarkdown} הוא זוגי. אז אפשר לכתוב אותו בתור חזקה גדולה מ-0 של 2 כפול מספר אי זוגי. הבה ונעשה זאת: {::nomarkdown}\( n=2^{k-1}m\){:/nomarkdown}, כאשר {::nomarkdown}\( k\ge2\){:/nomarkdown}. בעצם כל מה שנשאר לנו להראות הוא ש-{::nomarkdown}\( m=2^{k}-1\){:/nomarkdown} ושהוא ראשוני.

הצעד הראשון הוא להשתמש בתכונה מועילה מאין כמותה של {::nomarkdown}\( \sigma\){:/nomarkdown} - היא <strong>כפלית</strong>. אם נסתכל על הנוסחה עבור {::nomarkdown}\( \sigma\){:/nomarkdown}, הצגנו אותה בתור מכפלה של סכומים, כאשר כל מכפלה מיועדת לטיפול בגורם ראשוני אחר של המספר שעליו מחשבים את {::nomarkdown}\( \sigma\){:/nomarkdown}. זה אומר שאם יש לנו שני מספרים {::nomarkdown}\( a,b\){:/nomarkdown}, שהם <strong>זרים</strong> - אין להם מחלקים משותפים - אז יתקיים {::nomarkdown}\( \sigma\left(ab\right)=\sigma\left(a\right)\sigma\left(b\right)\){:/nomarkdown} (זה לא נכון למספרים לא זרים; די נפוץ לקרוא לפונקציה בהקשר כמו שלנו "כפלית" גם אם זה רק על מספרים זרים; למשל פונקצית אוילר). במקרה שלנו, מכיוון ש-{::nomarkdown}\( m\){:/nomarkdown} אי זוגי, זה אומר ש-

{::nomarkdown}\( \sigma\left(n\right)=\sigma\left(2^{k-1}m\right)=\sigma\left(2^{k-1}\right)\sigma\left(m\right)=\left(2^{k}-1\right)\sigma\left(m\right)\){:/nomarkdown}

המעבר האחרון נובע מכך ש-{::nomarkdown}\( \sigma\left(2^{k-1}\right)=1+2+\dots+2^{k-1}=2^{k}-1\){:/nomarkdown} (שוב, סכום טור הנדסי). כעת, מכיוון ש-{::nomarkdown}\( n\){:/nomarkdown} מושלם אז {::nomarkdown}\( \sigma\left(n\right)=2n=2^{k}m\){:/nomarkdown}, ולכן קיבלנו:

{::nomarkdown}\( 2^{k}m=\left(2^{k}-1\right)\sigma\left(m\right)\){:/nomarkdown}

כעת, {::nomarkdown}\( 2^{k}-1\){:/nomarkdown} מחלק את אגף ימין ולכן מחלק את אגף שמאל. מכיוון שהוא אי זוגי הוא אינו מחלק את {::nomarkdown}\( 2^{k}\){:/nomarkdown} ולכן הוא מחלק את {::nomarkdown}\( m\){:/nomarkdown}. כלומר, אפשר לכתוב {::nomarkdown}\( m=\left(2^{k}-1\right)M\){:/nomarkdown}. בואו נציב את זה חזרה במשוואה {::nomarkdown}\( 2^{k}m=\left(2^{k}-1\right)\sigma\left(m\right)\){:/nomarkdown} ונחלק ב-{::nomarkdown}\( 2^{k}-1\){:/nomarkdown}. נקבל:

{::nomarkdown}\( 2^{k}M=\sigma\left(m\right)\){:/nomarkdown}

מה עכשיו? אנחנו יודעים ש-{::nomarkdown}\( m,M\){:/nomarkdown} שניהם מחלקים של {::nomarkdown}\( m\){:/nomarkdown} ולכן שניהם משתתפים בסכום שמרכיב את {::nomarkdown}\( \sigma\left(m\right)\){:/nomarkdown}, כלומר

{::nomarkdown}\( \sigma\left(m\right)\ge m+M=\left(2^{k}-1\right)M+M=2^{k}M\){:/nomarkdown}

אם היה מתקיים {::nomarkdown}\( \sigma\left(m\right)&gt;m+M\){:/nomarkdown} היינו מקבלים מיידית סתירה: {::nomarkdown}\( 2^{k}M=\sigma\left(m\right)&gt;2^{k}M\){:/nomarkdown}. לכן {::nomarkdown}\( \sigma\left(m\right)=m+M\){:/nomarkdown}. אבל זה אומר לנו את כל מה שאנחנו צריכים: ש-{::nomarkdown}\( m,M\){:/nomarkdown} הם שני המחלקים <strong>היחידים</strong> של {::nomarkdown}\( m\){:/nomarkdown}, ולכן חייב להתקיים {::nomarkdown}\( M=1\){:/nomarkdown}, כלומר {::nomarkdown}\( m=2^{k}-1\){:/nomarkdown}, ו-{::nomarkdown}\( m\){:/nomarkdown} ראשוני כי אין לו מחלקים פרט לשני אלו. סיימנו!

שאלה מעניינת אחת לסיום היא איפה הנחנו כאן, בעצם, ש-{::nomarkdown}\( n\){:/nomarkdown} הוא זוגי. כלומר, למה לא הוכחנו ש<strong>כל</strong> מספר מושלם הוא מהצורה הזו וחסל. אפשר לנסות לעקוב אחרי ההוכחה מחדש, כשבפירוק {::nomarkdown}\( n=2^{k-1}m\){:/nomarkdown} יוצא ש-{::nomarkdown}\( k=1\){:/nomarkdown} ולכן {::nomarkdown}\( n=m\){:/nomarkdown} ותו לא. אם תעקבו אחרי ההוכחה, בסופו של דבר אני מגיע לפירוק {::nomarkdown}\( m=\left(2^{k}-1\right)M\){:/nomarkdown} ומסתמך בהמשך חזק מאוד על כך ש-{::nomarkdown}\( M\){:/nomarkdown} <strong>שונה</strong> מ-{::nomarkdown}\( m\){:/nomarkdown}, אבל אם {::nomarkdown}\( k=1\){:/nomarkdown} אני מקבל ש-{::nomarkdown}\( m=M\){:/nomarkdown} אז אמנם יוצא בסוף {::nomarkdown}\( \sigma\left(m\right)=m+M\){:/nomarkdown} (כי {::nomarkdown}\( m\){:/nomarkdown} מושלם ולכן {::nomarkdown}\( \sigma\left(m\right)=2m\){:/nomarkdown}) אבל זה לא אומר ש-{::nomarkdown}\( m,M\){:/nomarkdown} הם המחלקים היחידים של {::nomarkdown}\( m\){:/nomarkdown}, כי {::nomarkdown}\( M\){:/nomarkdown} לא שונה מ-{::nomarkdown}\( m\){:/nomarkdown}.

לסיכום: לא אמרתי פה כלום על מספרים מושלמים אי זוגיים. אולי יש ואולי אין, אנחנו לא יודעים. על מספרים מושלמים זוגיים ראינו שהם בזוגיות בריאה עם ראשוניי מרסן - לכל מספר מושלם זוגי יש ראשוני מחמד שכזה, וההפך. האם יש אינסוף מהם? לא ידוע, אבל ידוע שאם נפתור את השאלה עבור סוג אחד של מספרים היא תיפתר גם עבור השני. זו אחת מהתוצאות הפשוטות הללו שהמתמטיקה הרבה יותר כיפית בזכותה.
