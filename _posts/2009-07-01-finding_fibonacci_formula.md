---
id: 199
title: "איך מוצאים את נוסחת פיבונאצ'י?"
date: 2009-07-01 15:06:15
layout: post
categories: 
  - אלגברה לינארית
  - קומבינטוריקה
tags: 
  - הוכחות יפות
  - טכני
  - מספרי פיבונאצ'י
  - מתמטיקאים הם עצלנים
  - מתמטיקה תיכונית
  - נוסחאות נסיגה
---
בדומה לפוסטים אחרים, גם המוטיבציה לפוסט הזה היא שאילתת חיפוש שראויה לתשובה רצינית ולא בת שתי שורות - במקרה הזה, "איך מוכיחים נוסחת פיבונאצ'י". איני בטוח אם הכוונה היא רק להוכחה שהנוסחה נכונה, או גם <strong>למציאת</strong> הנוסחה; לדעתי מציאת הנוסחה היא העיקר ואז ההוכחה (באינדוקציה, או באמצעות כלים כבדים מאלגברה לינארית שמטפלים במקרה כללי בהרבה) היא די אלמנטרית, ולכן אתמקד בשאלת מציאת הנוסחה. התשובה טמונה בשיטה סטנדרטית לפתרון נוסחאות נסיגה, שזכורה לי בתור אחד מהדברים היפים ביותר שבהם נתקלתי כשרק התחלתי ללמוד מתמטיקה. ההתלהבות שלי מכך שאפשר למצוא את הנוסחה בפחות או יותר שלוש שורות של חשבון ברמת בית ספר תיכון נבעה מכך שהייתה זו פחות או יותר הפעם הראשונה שבה ראיתי איך ניתוח מתמטי רציני של בעיה שגם אני תהיתי לגביה "מחסל" אותה בקלי קלות - ההמחשה הטובה ביותר לטענת "מתמטיקאים הם עצלנים" של <a href="http://www.gap-system.org/~history/Quotations/Polya.html">פוליה</a>.

אבל ראשית יש להציג את הבעיה. תחילתה באחד מהמתמטיקאים האירופאים הבולטים הבודדים של ימי הביניים, שהיו תקופה חשוכה במיוחד עבור המתמטיקה, בין הפריחה האדירה לה היא זכתה ביוון העתיקה, והפריחה האדירה שלה החל מימי הרנסנס והלאה. בימי הביניים עיקר המתמטיקה השתמר ופותח בידי המוסלמים, וגם ליאונרדו מפיזה המוכר יותר בשם <a href="http://he.wikipedia.org/wiki/%D7%A4%D7%99%D7%91%D7%95%D7%A0%D7%A6%27%D7%99">פיבונאצ'י</a>, איטלקי, למד מתמטיקה אצל מורים מוסלמים כשגדל באלג'יר. בשנת 1202 פרסם פיבונאצ'י ספר - "ספר החשבוניה" - שהקיף את הידע המתמטי על אלגברה של אותה תקופה (בתקופת היוונים עסקו בעיקר בגאומטריה, וגם בעיות מספריות, דוגמת מציאת <a href="http://he.wikipedia.org/wiki/%D7%9E%D7%97%D7%9C%D7%A7_%D7%9E%D7%A9%D7%95%D7%AA%D7%A3_%D7%9E%D7%A7%D7%A1%D7%99%D7%9E%D7%9C%D7%99">מחלק משותף מקסימלי</a> - "האלגוריתם האוקלידי" - נוסחו באופן גאומטרי; בשלהי תקופת יוון העתיקה ובתקופת המוסלמים עיקר הדגש עבר לאלגברה, והמילה "אלגברה" עצמה הגיעה משם ספר של המתמטיקאי המוסלמי המפורסם ביותר, <a href="http://he.wikipedia.org/wiki/%D7%90%D7%91%D7%95_%D7%92%27%D7%A2%D7%A4%D7%A8_%D7%9E%D7%95%D7%97%D7%9E%D7%93_%D7%90%D7%9C-%D7%97%27%D7%95%D7%90%D7%A8%D7%99%D7%96%D7%9E%D7%99">אל-ח'ואריזמי</a>). הספר הכיל כמה מהחידושים המסעירים בתחום - למשל, השיטה העשרונית ושימוש באפס. הוא גם הכיל חידה חביבה שעסקה בארנבים.

אציג כאן את אחד מהניסוחים של הבעיה - איני מתחייב לניסוח המקורי של פיבונאצ'י, שכן אני מעדיף את הניסוח שנראה לי הכי פשוט להבנה. נניח שאוכלוסיית ארנבים מתרבה באופן המשונה הבא: זוג בוגר של ארנבים מביא לעולם, תוך חודש, זוג צעיר של ארנבים, וכך בכל חודש. לזוג צעיר של ארנבים לוקח חודש לגדול ולהפוך לזוג בוגר בעצמו, ואז גם הוא מתחיל להוליד. הארנבים כולם בני אלמוות. כעת, נניח שאנחנו מתחילים עם זוג של ארנבים צעירים - כמה זוגות (שימו לב - זוגות, לא ארנבים בודדים; הזוגות הם תמיד של זכר ונקבה, באופן קסום) של ארנבים <strong>בוגרים</strong> יהיו לנו בחודש ה-{::nomarkdown}\( n\){:/nomarkdown}-י?

ובכן, בחודש הראשון יש 0 זוגות של ארנבים בוגרים - יש זוג אחד של ארנבים צעירים ותו לא. בחודש שלאחר מכן יש זוג אחד של ארנבים בוגרים (הזוג הצעיר שלנו התבגר), ואפס זוגות של ארנבים צעירים. בחודש לאחר מכן יש את אותו הזוג של ארנבים בוגרים, וזוג חדש של ארנבים צעירים שהם הולידו; ובחודש שלאחר מכן הארנבים שהיו צעירים התבגרו, כך שיש לנו שני זוגות של ארנבים בוגרים, ובנוסף יש זוג צעיר אחד חדש. אם תמשיכו את המשחק הזה עוד ועוד, בוודאי תקבלו את סדרת הערכים הבאה, עבור מספר הארנבים הבוגרים בכל חודש: {::nomarkdown}\( 0,1,1,2,3,5,8,13,\dots\){:/nomarkdown}. מה שפיבונאצ'י רצה לעשות הוא למצוא חוקיות בסדרה הזו.

נסמן את אברי הסדרה בתור {::nomarkdown}\( F_{n}\){:/nomarkdown}, כאשר {::nomarkdown}\( n\){:/nomarkdown} הוא מספר החודש המתאים. לצורך נוחות, החודש הראשון יסומן ב-0, ולכן הסדרה היא {::nomarkdown}\( F_{0}=0,F_{1}=1,F_{2}=1,F_{3}=2\){:/nomarkdown} וכן הלאה. החוקיות שפיבונאצ'י הצביע עליה היא פשוטה במיוחד: {::nomarkdown}\( F_{n}=F_{n-1}+F_{n-2}\){:/nomarkdown}. כלומר, כל איבר בסדרה (לאחר שני האיברים הראשונים) שווה לסכום שני האיברים שקדמו לו. מעט מחשבה מראה מדוע זה כך במקרה של הארנבונים. מהו {::nomarkdown}\( F_{n}\){:/nomarkdown}, בעצם? הוא מספר זוגות הארנבונים שהיו בוגרים בחודש שלפני כן, ועוד מספר זוגות הארנבונים שהיו <strong>צעירים</strong> בחודש שלפני כן, והתבגרו. מספר זוגות הארנבונים שהיו בוגרים בחודש שלפני כן הוא בדיוק {::nomarkdown}\( F_{n-1}\){:/nomarkdown} - זה מה שמספר זה סופר. אבל כמה זוגות ארנבונים צעירים היו? ובכן, הכלל הוא שארנבון צעיר בחודש מסויים הוא ה"תוצר" הישיר של זוג ארנבונים שהיו <strong>מבוגרים</strong> בחודש שלפני כן. כלומר, אם אנחנו רוצים לספור כמה ארנבונים צעירים היו בחודש {::nomarkdown}\( n-1\){:/nomarkdown}, התשובה היא שמספר זה שווה למספר הארנבונים המבוגרים בחודש {::nomarkdown}\( n-2\){:/nomarkdown}. כלומר, {::nomarkdown}\( F_{n-2}\){:/nomarkdown} הוא בדיוק מספר הארנבונים שהיו צעירים בחודש {::nomarkdown}\( n-1\){:/nomarkdown}, ומכאן נובעת הנוסחה. הנוסחה הזו, שבה איבר בסדרה מתואר באמצעות איברים מוקדמים יותר בסדרה, נקראת <strong>נוסחה רקורסיבית</strong> (רקורסיה היא הגדרה של דבר מה באמצעות הסתמכות על מופעים יותר פשוטים שלו - במקרה שלנו, איבר בסדרה מוגדר באמצעות איברים קטנים יותר בסדרה, עד לאיברים {::nomarkdown}\( F_{0},F_{1}\){:/nomarkdown} שמוגדרים בצורה ישירה) או בעברית, <strong>נוסחת נסיגה</strong>.

<a href="http://he.wikipedia.org/wiki/%D7%A1%D7%93%D7%A8%D7%AA_%D7%A4%D7%99%D7%91%D7%95%D7%A0%D7%90%D7%A6%27%D7%99">סדרת פיבונאצ'י</a>הייתה מוכרת זמן רב לפני פיבונאצ'י וחידת הארנבים שלו, אך פיבונאצ'י זכה בכבוד שבקריאת הסדרה על שמו. קשה להתחיל ולתאר בכמה מקומות במתמטיקה מופיעה הסדרה - החל בניתוח הסיבוכיות של האלגוריתם האוקלידי, וכלה בהוכחה ש<a href="http://he.wikipedia.org/wiki/%D7%94%D7%91%D7%A2%D7%99%D7%94_%D7%94%D7%A2%D7%A9%D7%99%D7%A8%D7%99%D7%AA_%D7%A9%D7%9C_%D7%94%D7%99%D7%9C%D7%91%D7%A8%D7%98">הבעיה העשירית של הילברט</a> היא בלתי כריעה. מכיוון שהפוסט הזה אינו מיועד לתיאור סדרת פיבונאצ'י ואני רחוק מלהכיר אפילו מקצת משימושיה, לא אכנס לכך כעת. תחת זאת אתמקד בבעיה שעדיין נותרה פתוחה - מציאת נוסחה סגורה לאברי הסדרה.

מה הבעיה כרגע? נניח שאני רוצה מסיבה כלשהי לחשב את {::nomarkdown}\( F_{137}\){:/nomarkdown}. איך אני עושה זאת? אם כל מה שיש לי הוא הנוסחה הרקורסיבית, עלי לחשב את {::nomarkdown}\( F_{136}\){:/nomarkdown} ואת {::nomarkdown}\( F_{135}\){:/nomarkdown}, כלומר הצטצמתי לבעיה יותר פשוטה, ועדיין גם היא דורשת עבודה - כדי לחשב את {::nomarkdown}\( F_{136}\){:/nomarkdown} אני צריך את {::nomarkdown}\( F_{135}\){:/nomarkdown} (שאמנם, אני ממילא צריך) אבל גם את {::nomarkdown}\( F_{134}\){:/nomarkdown} וכן הלאה וכן הלאה - כלומר, כדי לחשב את {::nomarkdown}\( F_{137}\){:/nomarkdown} אצטרך לחשב את כל {::nomarkdown}\( F_{n}\){:/nomarkdown} עבור {::nomarkdown}\( n&lt;137\){:/nomarkdown}. חייבים להודות שזה לא נשמע יעיל במיוחד. האם אין דרך לחשב את {::nomarkdown}\( F_{n}\){:/nomarkdown} בלי לחשב את כל האיברים הקודמים בסדרה?

התשובה חיובית, וכדי להבהיל אתכם גם אתן אותה במפורש עכשיו - מתקיים ש-{::nomarkdown}\( F_{n}=\frac{1}{\sqrt{5}}\left[\left(\frac{1+\sqrt{5}}{2}\right)^{n}-\left(\frac{1-\sqrt{5}}{2}\right)^{n}\right]\){:/nomarkdown}. הנוסחה הזו נראית מבעיתה לגמרי - משום מקום צץ לו שורש 5, שהוא בכלל לא מספר רציונלי, ומעלים דברים בחזקת {::nomarkdown}\( n\){:/nomarkdown} ולך תחשב את זה בכלל והצילו. ובכן, אתם מוזמנים לבדוק עבור ערכים קטנים של {::nomarkdown}\( n\){:/nomarkdown} שהנוסחה עובדת, וכל השורשים של חמש מצטמצמים והכל טוב ויפה; ומחשב מסוגל להשתמש בנוסחה הזו כדי לחשב את {::nomarkdown}\( F_{n}\){:/nomarkdown} בקלות רבה יחסית, הרבה יותר מאשר שימוש בנוסחה הרקורסיבית וחישוב כל הערכים הקודמים בסדרה (למעשה, לא חייבים לחשב את הנוסחה שמוצגת בנוסחה כמות שהיא ואפשר לבצע כל מני שיפורים אך לא אכנס לכך).

אם כן, איך מגיעים לנוסחה הזו? מה ההגיון שבה? מאיפה צץ השורש? והאם הפתרון הוא אד-הוקי ומתאים רק לפיבונאצ'י? אענה על הכל, ואתחיל מהשאלה האחרונה - לגמרי לא. השיטה שאציג עובדת לכל נוסחה רקורסיבית שהיא לינארית במקדמים קבועים והומוגנית - ובמילים המפוצצות הללו אני מתכוון לכך שנוסחת הנסיגה היא באופן כללי מהצורה {::nomarkdown}\( a_{n}=c_{1}a_{n-1}+c_{2}a_{n-2}+\dots+c_{k}a_{n-k}\){:/nomarkdown}, כלומר שהאיבר ה-{::nomarkdown}\( n\){:/nomarkdown} בסדרה הוא סכום של {::nomarkdown}\( k\){:/nomarkdown} האיברים הקודמים בסדרה, כשהם מוכפלים במספרים קבועים {::nomarkdown}\( c_{1},\dots,c_{k}\){:/nomarkdown}. למשל, {::nomarkdown}\( a_{n}=3a_{n-1}+5a_{n-4}\){:/nomarkdown} היא דוגמה נוספת לסדרה שמתאימה לנוסחה הזו. השיטה שאציג תקפה לכל המשוואות הללו, אך אציג אותה עבור הדוגמה הספציפית של פיבונאצ'י כדי לא להסתבך יותר מדי עם הסימונים.

לאלו מכם שמכירים <a href="http://he.wikipedia.org/wiki/%D7%9E%D7%A9%D7%95%D7%95%D7%90%D7%94_%D7%93%D7%99%D7%A4%D7%A8%D7%A0%D7%A6%D7%99%D7%90%D7%9C%D7%99%D7%AA">משוואות דיפרנציאליות</a>, המילים "משוואה לינארית במקדמים קבועים והומוגנית" עשויה להיות מוכרת מאוד - בעיות דומות יש גם במשוואות דיפרנציאליות. גם "תנאי ההתחלה" של הנוסחה הרקורסיבית (במקרה של פיבונאצ'י, {::nomarkdown}\( F_{0}=0,F_{1}=1\){:/nomarkdown}; במקרה של סדרה שבה איבר תלוי ב-{::nomarkdown}\( k\){:/nomarkdown} הקודמים, תנאי ההתחלה צריך להיות {::nomarkdown}\( k\){:/nomarkdown} האיברים הראשונים בסדרה) מזכירים את המושג המקביל ממשוואות דיפרנציאליות, וגם שיטת הפתרון היא דומה - מתחילים מ"ניחוש מוצלח" של איך בערך הפתרון <strong>אמור להיראות</strong>, מציבים אותו במשוואה, ומקבלים מההצבה הזו את הפתרון המדוייק. זה לא מוכיח מיידית שהפתרון נכון, אלא צריך להוכיח זאת - אלא שההוכחה אינה קשה ומספיק לבצע אותה פעם אחת, עבור נוסחת הנסיגה ה"כללית" (הלינארית-מקדמים קבועים-הומוגנית), ואז מספיק יהיה להשתמש בשיטה כדי <strong>למצוא</strong> את הפתרון (שהוא הדבר שמעניין אותנו, בסופו של דבר).

כבר אגלה מראש שהניחוש הבסיסי שלנו הוא שפתרון נוסחת נסיגה "כללית" הוא מהצורה {::nomarkdown}\( a_{n}=\lambda^{n}\){:/nomarkdown} עבור מספר ממשי כלשהו {::nomarkdown}\( \lambda\){:/nomarkdown}. כלומר, שהאיבר ה-{::nomarkdown}\( n\){:/nomarkdown}-י בסדרה הוא העלאה בחזקה {::nomarkdown}\( n\){:/nomarkdown}-ית של מספר קבוע כלשהו, שתלוי רק בנוסחת הנסיגה הספציפית ולא ב-{::nomarkdown}\( n\){:/nomarkdown}. בוודאי תצעקו כעת שהפתרון של פיבונאצ'י אינו בדיוק כזה - אני יודע, ונגיע לכך. לפני כן צריך להבין איך בכלל הגענו לניחוש הזה - למה שזה יהיה משהו בחזקת {::nomarkdown}\( n\){:/nomarkdown}? למה לא {::nomarkdown}\( n^{t}\){:/nomarkdown}, למשל? (שימו לב להבדל - כעת {::nomarkdown}\( n\){:/nomarkdown} הוא בסיס החזקה ולא המעריך שלה, כמקודם). התשובה לכך היא שניתן להעריך את קצב הגידול של הפונקציה לא רע. אדגים זאת על פיבונאצ'י. מכיוון ש-{::nomarkdown}\( F_{n}=F_{n-1}+F_{n-2}\){:/nomarkdown} וכל האיברים (פרט ל-{::nomarkdown}\( F_{0}\){:/nomarkdown}) הם חיוביים, אז {::nomarkdown}\( F_{n}&gt;F_{n-1}\){:/nomarkdown} לכל {::nomarkdown}\( n&gt;1\){:/nomarkdown}. מכאן בפרט שמתקיים {::nomarkdown}\( F_{n}=F_{n-1}+F_{n-2}&lt;2F_{n-1}\){:/nomarkdown}, כלומר {::nomarkdown}\( F_{n}\){:/nomarkdown} לא גדול יותר מאשר פי 2 האיבר שקדם לו, {::nomarkdown}\( F_{n-1}\){:/nomarkdown}, ולכן קצב הגידול שלו אינו גדול <strong>מדי</strong>: מתקיים ש-{::nomarkdown}\( F_{n}&lt;2^{n}\){:/nomarkdown} (כי אם האיבר {::nomarkdown}\( F_{1}\){:/nomarkdown} הוא 1, השני הוא לא יותר מאשר 2, והשלישי לא יותר מאשר 4, והרביעי לא יותר מאשר 8, וכן הלאה).

מצד שני, {::nomarkdown}\( F_{n}=F_{n-1}+F_{n-2}&gt;2F_{n-2}\){:/nomarkdown}. כלומר, {::nomarkdown}\( F_{n}\){:/nomarkdown} הוא <strong>לפחות</strong> גדול פי 2 מאשר {::nomarkdown}\( F_{n-2}\){:/nomarkdown}, ולכן קצב הגידול שלו אינו יכול להיות קטן <strong>מדי</strong>: מתקיים ש-{::nomarkdown}\( F_{n}&gt;2^{\left\lfloor \frac{n}{2}\right\rfloor }\){:/nomarkdown}. שוב, לדוגמה - אם {::nomarkdown}\( F_{1}=1\){:/nomarkdown} אז האיבר השלישי בסדרה הוא לפחות 2, והאיבר החמישי הוא לפחות 4, והשביעי הוא לפחות 8 וכן הלאה. כלומר, קיבלנו שקצב הגידול של {::nomarkdown}\( F_{n}\){:/nomarkdown} הוא אקספוננציאלי - הוא חסום הן מלמעלה והן מלמטה על ידי חזקה {::nomarkdown}\( n\){:/nomarkdown}-ית של מספר כלשהו (שימו לב ש-{::nomarkdown}\( 2^{\frac{n}{2}}=\left(\sqrt{2}\right)^{n}\){:/nomarkdown} ומכאן שזה ש-{::nomarkdown}\( n\){:/nomarkdown} מופיע במעריך כשהוא מוכפל במשהו לא באמת משנה עבורו, אלא רק עבור הבסיס של החזקה). מכאן שבדיקת מועמד לפתרון שהוא מהצורה {::nomarkdown}\( \lambda^{n}\){:/nomarkdown} היא מתבקשת; הוא מסדר הגודל הנכון. מי שלא עלה בידו לעקוב אחרי כל האסימפטוטיקה הזו - לא נורא. מטרתה לתת מוטיבציה לפתרון ולהמחיש שלא מדובר בניחוש ממוזל בלבד אלא בבחירה מושכלת, אך אין זה הכרחי להמשך הפתרון.

כעת אנו מגיעים לשאלה המרכזית. נניח כי {::nomarkdown}\( F_{n}=\lambda^{n}\){:/nomarkdown} הוא אכן פתרון לנוסחת הנסיגה; מהו {::nomarkdown}\( \lambda\){:/nomarkdown}? לצורך כך ניתן להציב את הפתרון בנוסחה {::nomarkdown}\( F_{n}=F_{n-1}+F_{n-2}\){:/nomarkdown} ולקבל את המשוואה {::nomarkdown}\( \lambda^{n}=\lambda^{n-1}+\lambda^{n-2}\){:/nomarkdown}. ברור כי {::nomarkdown}\( \lambda=0\){:/nomarkdown} פותר את נוסחת הנסיגה (פתרון כזה פותר גם את הנוסחה ה"כללית" שלעיל) אבל זה אינו פתרון מעניין, אז נניח כי {::nomarkdown}\( \lambda\ne0\){:/nomarkdown}, ולכן אפשר לחלק את המשוואה שקיבלנו ב-{::nomarkdown}\( \lambda^{n-2}\){:/nomarkdown} ולקבל {::nomarkdown}\( \lambda^{2}=\lambda+1\){:/nomarkdown}, או, אחרי העברת אגפים, {::nomarkdown}\( \lambda^{2}-\lambda-1=0\){:/nomarkdown}. זוהי משוואה ריבועית פשוטה ואנו יודעים לפתור אותה בעזרת הנוסחה הכללית. נקבל {::nomarkdown}\( \lambda=\frac{1\pm\sqrt{1+4}}{2}=\frac{1\pm\sqrt{5}}{2}\){:/nomarkdown}. כלומר, קיבלנו שני פתרונות, ובשניהם צץ לו ה-{::nomarkdown}\( \sqrt{5}\){:/nomarkdown} המבהיל. מכאן זה מגיע.

כדי לעשות לעצמי את החיים פשוטים יותר מעתה והלאה, אשתמש בסימון סטנדרטי: {::nomarkdown}\( \phi_{+}=\frac{1+\sqrt{5}}{2}\){:/nomarkdown}, ו-{::nomarkdown}\( \phi_{-}=\frac{1-\sqrt{5}}{2}\){:/nomarkdown}. המספר {::nomarkdown}\( \phi_{+}\){:/nomarkdown} הוא "יחס הזהב" המפורסם. אם כן, הגענו למסקנה ש-{::nomarkdown}\( F_{n}=\phi_{+}^{n}\){:/nomarkdown} ו-{::nomarkdown}\( F_{n}=\phi_{-}^{n}\){:/nomarkdown} הם פתרונות של נוסחת הנסיגה {::nomarkdown}\( F_{n}=F_{n-1}+F_{n-2}\){:/nomarkdown}. מדוע זה לא הפתרון שהצגתי לעיל ומה עוד לא עשינו?

הבעיה בשני הפתרונות שמצאנו היא שהם אינם עונים ל"תנאי ההתחלה". צריך, למשל, שיתקיים {::nomarkdown}\( F_{0}=0\){:/nomarkdown}. מיידית ברור שהייתי אידיוט גמור אם חשבתי שפתרון מהצורה {::nomarkdown}\( \lambda^{n}\){:/nomarkdown} יקיים זאת - חזקה של מספר שאינו 0, אינה 0. כמו כן צריך שיתקיים {::nomarkdown}\( F_{1}=1\){:/nomarkdown}, ולכן הפתרון העלוב {::nomarkdown}\( \lambda=0\){:/nomarkdown} גם כן לא טוב לנו. בקיצור, האם צריך לזרוק לזבל את כל הרעיון שהפתרון הוא מהצורה {::nomarkdown}\( \lambda^{n}\){:/nomarkdown}? לא, צריך רק להרחיב מעט את אוסף הפתרונות שלנו - משני פתרונות, לאינסוף.

באופן כללי, אם {::nomarkdown}\( f\left(n\right)\){:/nomarkdown} הוא פתרון של נוסחת הנסיגה של פיבונאצ'י (ושוב, מה שאני אומר תקף גם לנוסחה ה"כללית"), כלומר אם {::nomarkdown}\( f\left(n\right)=f\left(n-1\right)+f\left(n-2\right)\){:/nomarkdown} אז גם {::nomarkdown}\( h\left(n\right)=\alpha\cdot f\left(n\right)\){:/nomarkdown}, כאשר {::nomarkdown}\( \alpha\){:/nomarkdown} הוא מספר ממשי, הוא פתרון, כי הרי {::nomarkdown}\( h\left(n\right) = \alpha f\left(n\right)=\alpha\left(f\left(n-1\right)+f\left(n-2\right)\right)=\alpha f\left(n-1\right)+\alpha f\left(n-2\right) = h\left(n-1\right)+h\left(n-2\right)\){:/nomarkdown} באופן דומה, אם {::nomarkdown}\( f\left(n\right),g\left(n\right)\){:/nomarkdown} שניהם פתרונות, אז גם {::nomarkdown}\( h\left(n\right)=f\left(n\right)+g\left(n\right)\){:/nomarkdown} הוא פתרון, כי

{::nomarkdown}\( h\left(n\right) = f\left(n\right)+g\left(n\right)=\left(f\left(n-1\right)+f\left(n-2\right)\right)+\left(g\left(n-1\right)+g\left(n-2\right)\right) = \left(f\left(n-1\right)+g\left(n-1\right)\right)+\left(f\left(n-2\right)+g\left(n-2\right)\right)=h\left(n-1\right)+h\left(n-2\right)\){:/nomarkdown}

אם כן, אוסף הפתרונות של המשוואה סגור לפעולות של "כפל בסקלר" (כפל במספר ממשי, במקרה שלנו) ושל חיבור שני פתרונות. אלו מכם שמכירים אלגברה לינארית ודאי רואים כעת כי אוסף הפתרונות של נוסחת הנסיגה (אם לא דורשים את קיום תנאי ההתחלה) מהווה <strong><a href="http://he.wikipedia.org/wiki/%D7%9E%D7%A8%D7%97%D7%91_%D7%95%D7%A7%D7%98%D7%95%D7%A8%D7%99">מרחב וקטורי</a></strong>. הבסיס של המרחב הזה הם בדיוק שני הפתרונות שמצאנו בהתחלה - {::nomarkdown}\( \phi_{+}^{n},\phi_{-}^{n}\){:/nomarkdown}. מי שאינו מכיר אלגברה לינארית עדיין יכול לראות, משתי התכונות שהדגמתי לעיל, שאם {::nomarkdown}\( f\left(n\right),g\left(n\right)\){:/nomarkdown} הם שני פתרונות לנוסחת הנסיגה, אז גם {::nomarkdown}\( \alpha f\left(n\right)+\beta g\left(n\right)\){:/nomarkdown} הוא פתרון, עבור כל {::nomarkdown}\( \alpha,\beta\){:/nomarkdown} ממשיים שנבחר. לכן הגדלנו בצורה משמעותית את אוסף הפתרונות האפשריים שלנו - אולי אחד מהם כן עונה לתנאי ההתחלה?

אם כן, נכתוב פתרון "כללי" לנוסחת הנסיגה בתור {::nomarkdown}\( F_{n}=\alpha\phi_{+}^{n}+\beta\phi_{-}^{n}\){:/nomarkdown}. אנו רוצים לגלות מהם {::nomarkdown}\( \alpha,\beta\){:/nomarkdown} שעבורם יתקיימו תנאי ההתחלה, אז נשתמש בכך שידוע ש-{::nomarkdown}\( F_{0}=0\){:/nomarkdown} ונקבל את הנוסחה {::nomarkdown}\( 0=\alpha\phi_{+}^{0}+\beta\phi_{-}^{0}=\alpha+\beta\){:/nomarkdown}, כלומר אנחנו כבר יודעים שבהכרח מתקיים {::nomarkdown}\( \alpha=-\beta\){:/nomarkdown}. לכן נכתוב את הפתרון בתור {::nomarkdown}\( F_{n}=\alpha\left(\phi_{+}^{n}-\phi_{-}^{n}\right)\){:/nomarkdown}. כעת נשתמש במשוואה הנוספת שנותרה לנו - {::nomarkdown}\( F_{1}=1\){:/nomarkdown}. נקבל ממנה כי {::nomarkdown}\( 1=\alpha\left(\phi_{+}-\phi_{-}\right)\){:/nomarkdown}, אבל את {::nomarkdown}\( \phi_{+}-\phi_{-}\){:/nomarkdown} קל לנו לחשב: {::nomarkdown}\( \phi_{+}-\phi_{-}=\frac{1+\sqrt{5}}{2}-\frac{1-\sqrt{5}}{2}=\sqrt{5}\){:/nomarkdown}. מכאן נקבל ש-{::nomarkdown}\( 1=\alpha\sqrt{5}\){:/nomarkdown}, ובמילים אחרות - {::nomarkdown}\( \alpha=\frac{1}{\sqrt{5}}\){:/nomarkdown}. לכן הפתרון הנכון לנוסחת פיבונאצ'י, זה שמתאים גם לתנאי ההתחלה, הוא {::nomarkdown}\( F_{n}=\frac{1}{\sqrt{5}}\left(\phi_{+}^{n}-\phi_{-}^{n}\right)\){:/nomarkdown} (וזו גם המפלצת שהצגתי לעיל, עם סימונים מעט יותר ידידותיים). ושוב, מה שעשיתי כאן, עם המרחב הלינארי והכל, זהה למה שעושים כאשר פותרים משוואות דיפרנציאליות לינאריות.

מה שעשיתי נראה אולי מעט אד-הוקי בשל הצורה שבה מצאתי את {::nomarkdown}\( \alpha,\beta\){:/nomarkdown}, אבל זה רק כי נמנעתי מלהשתמש בשיטת הפתרון הכללית למשוואות לינאריות, שהייתה נותנת את אותה התוצאה. באופן כללי, כשיש לנו משוואה מהצורה {::nomarkdown}\( a_{n}=c_{1}a_{n-1}+c_{2}a_{n-2}+\dots+c_{k}a_{n-k}\){:/nomarkdown}, הצבה של {::nomarkdown}\( \lambda^{n}\){:/nomarkdown} מניבה את המשוואה {::nomarkdown}\( \lambda^{k}-c_{1}\lambda^{k-1}-\dots c_{k-1}\lambda-c_{k}=0\){:/nomarkdown}. עבור {::nomarkdown}\( k\ge5\){:/nomarkdown} כבר אין נוסחה סגורה פשוטה עבור פתרונות המשוואה (ניתן להראות זאת באמצעות <a href="http://he.wikipedia.org/wiki/%D7%AA%D7%95%D7%A8%D7%AA_%D7%92%D7%9C%D7%95%D7%90%D7%94">תורת גלואה</a>, וזה עניין לסדרת פוסטים בפני עצמה), ויכולות להיות בעיות נוספות עם הפתרונות (הם יהיו מרוכבים, או שאותו פתרון יופיע מספר פעמים, בדומה לכך שהפתרון היחיד של {::nomarkdown}\( x^{2}-2x+1\){:/nomarkdown} הוא {::nomarkdown}\( x=1\){:/nomarkdown}) אבל למרות כל הבעיות הללו ניתן לבנות {::nomarkdown}\( k\){:/nomarkdown} פתרונות שונים למשוואה שיהוו בסיס למרחב הפתרונות שלה, וניתן להראות שלכל בחירה של תנאי ההתחלה נקבל פתרון יחיד. כל זה דורש אלגברה לינארית שלא אוכל להיכנס אליה כעת, אבל בעתיד אולי ארחיב על כך (בפוסט שיהיה בהכרח טכני יותר מזה הנוכחי). ושוב - גם במשוואות דיפרנציאליות כל הסיפור הזה מתרחש באופן זהה.

הפתרון שהצגתי אולי נראה ארוך למדי כי הכברתי הסברים, אך מבחינה מעשית הוא פשוט בצורה יוצאת דופן - פותרים משוואה ריבועית, ואז פותרים עוד מערכת של שתי משוואות בשני נעלמים. הכל חומר של תיכון, ודורש שלוש שורות חישוב - והנוסחה לפיבונאצ'י בהישג יד. קשה לי להסביר עד כמה מצער אותי שנמנעים מלהציג את הנוסחה הזו בתיכון - לשם מה בכלל לדעת איך פותרים משוואות, אם לא בשביל דברים כאלו?
