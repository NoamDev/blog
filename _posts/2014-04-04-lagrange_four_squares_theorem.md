---
id: 3090
title: "משפט ארבעת הריבועים של לגראנז'"
date: 2014-04-04 11:29:36
layout: post
categories: 
  - תורת המספרים
tags: 
  - גם טכני זה כיף!
  - הוכחות
  - משפט ארבעת הריבועים של לגראנז'
  - סכומי ריבועים
  - קווטרניונים
---
אני רוצה לדבר על אחת מהתוצאות הנחמדות ביותר (לטעמי) בתורת המספרים האלמנטרית - משפט ארבעת הריבועים של לגראנז'. בפשטות, המשפט אומר שאפשר להציג כל מספר טבעי בתור סכום של ארבעה ריבועים של מספרים טבעיים (כש-0 נחשב למספר טבעי). הנה דוגמאות עבור המספרים הטבעיים מ-1 עד 7:

{::nomarkdown}\( 1=1^{2}+0^{2}+0^{2}+0^{2}\){:/nomarkdown}

{::nomarkdown}\( 2=1^{2}+1^{2}+0^{2}+0^{2}\){:/nomarkdown}

{::nomarkdown}\( 3=1^{2}+1^{2}+1^{2}+0^{2}\){:/nomarkdown}

{::nomarkdown}\( 4=2^{2}+0^{2}+0^{2}+0^{2}\){:/nomarkdown}

{::nomarkdown}\( 5=2^{2}+1^{2}+0^{2}+0^{2}\){:/nomarkdown}

{::nomarkdown}\( 6=2^{2}+1^{2}+1^{2}+0^{2}\){:/nomarkdown}

{::nomarkdown}\( 7=2^{2}+1^{2}+1^{2}+1^{2}\){:/nomarkdown}

הפסקתי ב-7 בכוונה - הוא הדוגמה הראשונה שיש לנו למספר שאנחנו <strong>חייבים</strong> ארבעה ריבועים כדי לקבל אותו (תוכיחו! זה בסך הכל כולל בדיקה של כמה מקרים). מה שמפתיע כאן הוא ש-4 זה <strong>כל מה שצריך</strong> - ואפשר לייצג כל מספר, גדול ומורכב ככל שיהיה, כסכום של ארבעה ריבועים.

כשאני אומר שזה משפט בתורת המספרים "האלמנטרית" הכוונה היא לכך שלא משתמשים בכלים מתמטיים כבדים שנדרשת היכרות מוקדמת איתם - ההוכחה מסתמכת על <a href="http://www.gadial.net/2013/05/13/modular_arithmetic/">חשבון מודולורי</a> ותו לא (וחשבון מודולורי הוא לגמרי הלחם והחמאה של תורת המספרים). זה לא אומר שההוכחה היא אלמנטרית, למרות שהיא לא מסובכת במיוחד; הפוסט הזה כן יהיה טכני, וקשה יהיה להבין את ההוכחה בלי להתעמק קצת בפרטים הטכניים הללו. וזה בסדר גמור ואין עם זה בעיה - בלי להתעסק בפרטים הטכניים מפספסים לא מעט מהכיף שבמתמטיקה, לטעמי.

את ההוכחה עצמה אפשר לחלק לשני חלקים: ראשית, מראים שאפשר לצמצם את הבעיה כך שמספיק להוכיח שכל מספר <strong>ראשוני</strong> ניתן להצגה כסכום של ארבעה ראשונים; ואז מראים את זה עבור ראשוניים. הרדוקציה הזו ל"מספיק להוכיח על ראשוניים" היא לכשעצמה טכניקה נפוצה בתורת המספרים והיא עובדת יפה גם כאן (כי יותר קל להוכיח עבור ראשוני שהוא סכום של ארבעה ריבועים מאשר עבור מספר כללי). אז בואו נתחיל קודם כל מהחלק הראשון - לשכנע אתכם שמספיק להוכיח שכל ראשוני הוא סכום של ארבעה ריבועים.

הטענה שאני רוצה להוכיח היא זו: אם {::nomarkdown}\( a\){:/nomarkdown} ניתן להצגה כסכום של ארבעה ריבועים, ו-{::nomarkdown}\( b\){:/nomarkdown} ניתן להצגה כסכום של ארבעה ריבועים, אז גם {::nomarkdown}\( ab\){:/nomarkdown} (המכפלה שלהם) ניתן להצגה כסכום של ארבעה ריבועים. נשמע לכם טריוויאלי או מובן מאליו? אין בעיה - קחו דקה בצד ונסו להוכיח את זה. כנראה שתגלו שזה לא פשוט כמו שזה נראה.

אם הוכחתי את הטענה הזו, אז נובע מייד שמספיק להוכיח את המשפט עבור ראשוניים. למה? ובכן, ראשית, טריוויאלי להכליל את הטענה עבור מכפלה של מספר סופי של מספרים (כלומר, המכפלה של כל מספר סופי של מספרים, שכולם סכום של ארבעה ריבועים, גם היא סכום של ארבעה ריבועים). שנית, כל מספר גדול מ-1 הוא מכפלה של מספר סופי של ראשוניים, ולכן אם כל הראשוניים הם סכום של ארבעה ריבועים, כל מספר הוא כזה (למעט 0 ו-1 אבל כבר ראינו מה קורה איתם). הנה דוגמה קלאסית לאופן שבו היות הראשוניים "אבני הבניין" של כל המספרים עוזר לנו.

ובכן, נניח ש-{::nomarkdown}\( a,b\){:/nomarkdown} הם סכום של ארבעה ריבועים. למה גם {::nomarkdown}\( ab\){:/nomarkdown} כזה? התשובה: זה כואב. מה כואב? לראות את הנוסחה המתאימה. מה שעושים הוא לכתוב הצגה של {::nomarkdown}\( a\){:/nomarkdown} כסכום של ארבעה ריבועים, ואת {::nomarkdown}\( b\){:/nomarkdown} כסכום של ארבעה ריבועים, ואז לכתוב את הביטוי המדויק שמתאר את {::nomarkdown}\( ab\){:/nomarkdown} בתור סכום של ארבעה ריבועים. אפשר לפתוח סוגריים ולראות שהכל יוצא כמו שצריך, אבל זה כואב. כמו כן, מי זוכר איך בכלל הנוסחה הזו נראית? האם אני צריך לזכור את הנוסחה בעל פה? ממתי צריך לזכור דברים במתמטיקה בעל פה? האם אני יכול לכתוב את החלק הזה של הפוסט מהראש בלי להעתיק מספר? ובכן, יש תעלול אחד שיקל עלי את החיים, ויתן לי תירוץ להציג מושג חדש ומעניין בפני עצמו: קווטרניונים.

לקווטרניונים היסטוריה מרתקת משל עצמם אבל לא אכנס אליה כרגע. הרעיון הבסיסי בהם הוא להרחיב בצורה מסויימת את המספרים המרוכבים. אם המספרים המרוכבים הם מספרים מהצורה {::nomarkdown}\( a+bi\){:/nomarkdown} כאשר {::nomarkdown}\( a,b\in\mathbb{R}\){:/nomarkdown} ו-{::nomarkdown}\( i\){:/nomarkdown} מקיים ש-{::nomarkdown}\( i^{2}=-1\){:/nomarkdown}, אז הקווטרניונים (מעל הממשיים; יש מושג כללי יותר של אלגברת קווטרניונים שלא אכנס אליו כאן) הם מספרים מהצורה {::nomarkdown}\( a+bi+cj+dk\){:/nomarkdown} כאשר {::nomarkdown}\( a,b,c,d\in\mathbb{R}\){:/nomarkdown} ו-{::nomarkdown}\( i^{2}=j^{2}=k^{2}=-1\){:/nomarkdown}, והמכפלות של {::nomarkdown}\( i,j,k\){:/nomarkdown} מתוארות על ידי הכלל "כפל על פי הסדר נותן את הבא בתור, וכפל בסדר הפוך נותן את המינוס שלו". מה זאת אומרת? הנה המשוואות:

{::nomarkdown}\( ij=k\){:/nomarkdown} ו-{::nomarkdown}\( ji=-k\){:/nomarkdown}

{::nomarkdown}\( jk=i\){:/nomarkdown} ו-{::nomarkdown}\( kj=-i\){:/nomarkdown}

{::nomarkdown}\( ki=j\){:/nomarkdown} ו-{::nomarkdown}\( ik=-j\){:/nomarkdown}

(למעשה, מספיקות רק המשוואות {::nomarkdown}\( ij=k,jk=i,ki=j\){:/nomarkdown} והמשוואה {::nomarkdown}\( i^{2}=j^{2}=k^{2}=-1\){:/nomarkdown} כדי שניתן יהיה להסיק את היתר).

הנה דוגמה פשוטה למכפלה של שני קווטרניונים:

{::nomarkdown}\( \left(4+3i\right)\left(2+5k\right)=8+6i+20k+15ik=8+6i-15j+20k\){:/nomarkdown}

עכשיו, למספרים מרוכבים יש <strong>נורמה</strong>, שהיא מדד ל"גודל" שלהם (פורמלית - המרחק של המספר המרוכב מראשית הצירים). הנורמה מסומנת בסימן של ערך מוחלט, ומוגדרת בתור {::nomarkdown}\( \left\|a+bi\right\|=\sqrt{a^{2}+b^{2}}\){:/nomarkdown}, או {::nomarkdown}\( \left\|a+bi\right\|^{2}=a^{2}+b^{2}\){:/nomarkdown}. תכונה חשובה של הנורמה הזו היא שהיא <strong>כפלית</strong>, כלומר {::nomarkdown}\( \left\|a+bi\right\|\left\|x+yi\right\|=\left\|\left(a+bi\right)\left(x+yi\right)\right\|\){:/nomarkdown}. הרעיון הוא שעם קווטרניונים זה אותו הדבר בדיוק.

איך זה קשור לענייננו? ובכן, אם {::nomarkdown}\( a+bi+cj+dk\){:/nomarkdown} הוא קווטרניון, אז הנורמה שלו בריבוע היא בדיוק {::nomarkdown}\( a^{2}+b^{2}+c^{2}+d^{2}\){:/nomarkdown}, כלומר סכום של ארבעה ריבועים. ולהפך: לכל ארבעה מספרים שנרצה, אפשר לבנות קווטרניון שהנורמה שלו בריבוע היא סכום הריבועים של המספרים (פשוט לוקחים את המספרים להיות מקדמי הקווטרניון). כעת, אם {::nomarkdown}\( p,q\){:/nomarkdown} הם קווטרניונים, אז המשוואה {::nomarkdown}\( \left\|p\right\|^{2}\left\|q\right\|^{2}=\left\|pq\right\|^{2}\){:/nomarkdown} אומרת לנו בדיוק שמכפלת שני סכומים ארבעה ריבועים ({::nomarkdown}\( \left\|p\right\|^{2}\){:/nomarkdown} ו-{::nomarkdown}\( \left\|q\right\|^{2}\){:/nomarkdown}) היא בעצמה סכום של ארבעה ריבועים ({::nomarkdown}\( \left\|pq\right\|^{2}\){:/nomarkdown}).

כעת ברור גם איך אפשר למצוא את הנוסחה במפורש: ניקח את {::nomarkdown}\( \left(a+bi+cj+dk\right)\){:/nomarkdown} ונכפול אותו ב-{::nomarkdown}\( \left(x+yi+zj+uk\right)\){:/nomarkdown}, ונבדוק את הנורמה של מה שנקבל. זה לא יהיה נעים. זה יהיה כואב. אבל לפחות לא אצטרך להעתיק נוסחה משום מקום ואוכל לפתח את הכל בעצמי - ותאמינו לי, זה מרגיש יותר טוב.

ובכן:

{::nomarkdown}\( \left(a+bi+cj+dk\right)\left(x+yi+zj+uk\right)=\left(ax-by-cz-du\right)+\){:/nomarkdown}

{::nomarkdown}\( \left(ay+bx+cu-dz\right)i+\left(az-bu+cx+dy\right)j+\left(au+bz-cy+dx\right)k\){:/nomarkdown}

ולכן קיבלתי את הנוסחה הבאה להצגה של מכפלת שני סכומי ארבעה ריבועים כסכום של ארבעה ריבועים:

{::nomarkdown}\( \left(a^{2}+b^{2}+c^{2}+d^{2}\right)\left(x^{2}+y^{2}+z^{2}+u^{2}\right)=\){:/nomarkdown}

{::nomarkdown}\( \left(ax-by-cz-du\right){}^{2}+\left(ay+bx+cu-dz\right)^{2}+\left(az-bu+cx+dy\right)^{2}+\left(au+bz-cy+dx\right)^{2}\){:/nomarkdown}

עדיין לא הוכחתי שהנוסחה נכונה, כי הסתמכתי על ההנחה שהנורמה של הקווטרניונים כפלית - אבל כאמור, מרגע שיש לנו את הנוסחה מול העיניים אפשר סתם לפתוח את הסוגריים ולראות שהיא עובדת. למי שבכל זאת רוצה דרך עקיפה, אפשר להסתמך על כך שקווטרניונים ניתנים לייצוג על ידי מטריצות מסדר {::nomarkdown}\( 2\times2\){:/nomarkdown} מעל המרוכבים, באופן הבא: המספר {::nomarkdown}\( a+bi+cj+dk\){:/nomarkdown} מיוצג על ידי המטריצה {::nomarkdown}\( \left[\begin{array}{cc}a+bi &amp; c+di\\-c+di &amp; a-bi\end{array}\right]\){:/nomarkdown}. כמובן, עכשיו צריך לבדוק שהייצוג הזה באמת נכון (כלומר, לכפול שתי מטריצות ולראות שמתקבלת המכפלה שציפינו לה), אבל מרגע שבדקנו את זה, סיימנו: הנורמה של הקווטרניון היא פשוט הדטרמיננטה של המטריצה (לראות את זה - זה מיידיי לחלוטין) ודטרמיננטה של מטריצות היא כפלית.

איבדתם אותי? גם אם כן, לא נורא - זה לא פוסט על קווטרניונים ולא חייבים להבין את מה שעשיתי פה בשביל ההמשך - כל מה שחשוב הוא שמכאן והלאה מספיק לנו להוכיח את משפט לגראנז' עבור ראשוניים בלבד. וכאן אנחנו מתחילים להשתמש בטיעוני תורת המספרים.

המתווה של ההוכחה מעתה והלאה הוא זה: יהא {::nomarkdown}\( p\){:/nomarkdown} מספר ראשוני אי זוגי כלשהו (ב-2 כבר טיפלנו במפורש קודם, ובהמשך הוא יעשה בעיות כפי שהוא בדרך כלל עושה אז נניח ש-{::nomarkdown}\( p\){:/nomarkdown} שונה ממנו). בשלב ראשון אני אמצא מספר {::nomarkdown}\( 1\le m&lt;p\){:/nomarkdown} כלשהו כך ש-{::nomarkdown}\( mp\){:/nomarkdown}הוא סכום של ארבעה ריבועים - זה יהיה די קל, באופן אולי מפתיע. לדוגמה, נניח שאני רוצה להוכיח ש-13 הוא סכום של 4 ריבועים, אני אתחיל מלהוכיח ש-65 (ששווה ל-{::nomarkdown}\( 13\cdot5\){:/nomarkdown}) הוא סכום של ארבעה ריבועים כי קל לי לראות את זה: {::nomarkdown}\( 65=8^{2}+1^{2}+0^{2}+0^{2}\){:/nomarkdown}. עכשיו, אחרי שמצאתי {::nomarkdown}\( m\){:/nomarkdown} כזה, אני רוצה להתחיל "להצטמצם". אני אוכיח שאם יש {::nomarkdown}\( 1&lt;m&lt;p\){:/nomarkdown} כך ש-{::nomarkdown}\( mp\){:/nomarkdown} הוא סכום של ארבעה ריבועים, אז קיים {::nomarkdown}\( 1\le n&lt;m\){:/nomarkdown} כך ש-{::nomarkdown}\( np\){:/nomarkdown} הוא עדיין סכום של ארבעה ריבועים - כלומר, הקטנתי את מי שמוכפל ב-{::nomarkdown}\( p\){:/nomarkdown}. ואז אני יכול לחזור על ההוכחה הזו גם עבורו, ושוב ושוב עד שלבסוף בהכרח אגיע ל-{::nomarkdown}\( p\){:/nomarkdown} עצמו (כלומר, כשהוא מוכפל ב-1). ההוכחה של השלב הזה - הנסיגה הזו כלפי מטה - היא החלק הקשה והטכני ביותר בהוכחה (אבל לא לדאוג, גם הוא לא כל כך נורא).

כדי להוכיח שקיים {::nomarkdown}\( m&lt;p\){:/nomarkdown} כך ש-{::nomarkdown}\( mp\){:/nomarkdown} הוא סכום של ארבעה ריבועים, אני אסתכל על {::nomarkdown}\( \mathbb{Z}_{p}\){:/nomarkdown} - שדה המספרים מודולו {::nomarkdown}\( p\){:/nomarkdown}, ואוכיח שיש בו פתרון למשוואה {::nomarkdown}\( x^{2}+y^{2}+1=0\){:/nomarkdown}, כלומר ש-{::nomarkdown}\( p\|x^{2}+y^{2}+1\){:/nomarkdown}, כלומר שקיים {::nomarkdown}\( m\){:/nomarkdown} כך ש-{::nomarkdown}\( mp=x^{2}+y^{2}+1=x^{2}+y^{2}+1^{2}+0^{2}\){:/nomarkdown}, ואם יהיה לי חסם טוב כלשהו על הגודל של {::nomarkdown}\( x,y\){:/nomarkdown} אז גם אוכל לחסום את הגודל של {::nomarkdown}\( m\){:/nomarkdown}. זה המקום הראשון שבו העובדה שהצטמצמנו לדיבור על ראשוני {::nomarkdown}\( p\){:/nomarkdown} עוזרת; למשל, ב-{::nomarkdown}\( \mathbb{Z}_{8}\){:/nomarkdown} אין פתרון למשוואה הזו, כי {::nomarkdown}\( x^{2}\){:/nomarkdown} מודולו 8 יכול להיות רק 0 או 1 או 4. אז מה ההבדל בין ראשוני ולא ראשוני? ב-{::nomarkdown}\( \mathbb{Z}_{8}\){:/nomarkdown} מה שקורה הוא שיש ארבעה מספרים שבריבוע נותנים 1 - 1,3,5,7, כלומר ל-1 יש ארבעה שורשים; לעומת זאת, עבור {::nomarkdown}\( p\){:/nomarkdown} ראשוני לכל מספר יש לכל היותר שני שורשים - זה נובע מכך ש-{::nomarkdown}\( \mathbb{Z}_{p}\){:/nomarkdown} הוא שדה ולכן לפולינום ממעלה {::nomarkdown}\( n\){:/nomarkdown} מעל {::nomarkdown}\( \mathbb{Z}_{p}\){:/nomarkdown} יש לכל היותר {::nomarkdown}\( n\){:/nomarkdown} שורשים (ולכן לפולינום {::nomarkdown}\( x^{2}-a\){:/nomarkdown} יש לכל היותר שני שורשים, כלומר ל-{::nomarkdown}\( a\){:/nomarkdown} יש לכל היותר שני שורשים).

ספציפית ב-{::nomarkdown}\( \mathbb{Z}_{p}\){:/nomarkdown}, ל-0 יש רק שורש אחד (0) ולכל מספר אחר שהוא ריבוע יש בדיוק שני שורשים (אם {::nomarkdown}\( a=x^{2}\){:/nomarkdown} אז {::nomarkdown}\( y=-x\){:/nomarkdown} גם הוא שורש כי {::nomarkdown}\( y^{2}=\left(-x\right)^{2}=x^{2}=a\){:/nomarkdown}, ולא ייתכן ש-{::nomarkdown}\( x=y\){:/nomarkdown} כי אם {::nomarkdown}\( x=-x\){:/nomarkdown} אז {::nomarkdown}\( 2x=0\){:/nomarkdown} מודולו {::nomarkdown}\( p\){:/nomarkdown} ולכן {::nomarkdown}\( p\){:/nomarkdown} מחלק את 2). זה אומר שאם נגדיר את הקבוצה {::nomarkdown}\( S=\left\{ a^{2}\ \|\ a\in\mathbb{Z}_{p}\right\} \){:/nomarkdown}, גודלה יהיה בדיוק {::nomarkdown}\( \frac{p+1}{2}\){:/nomarkdown}. למה? כי בואו ניקח את כל המספרים ב-{::nomarkdown}\( \mathbb{Z}_{p}\){:/nomarkdown} ונעלה אותם בריבוע. 0 הוא מקרה מיוחד, ופרט אליו נשארים {::nomarkdown}\( p-1\){:/nomarkdown} איברים שאפשר לסדר בזוגות שנותנים את אותו ריבוע, כלומר נקבל {::nomarkdown}\( \frac{p-1}{2}+1\){:/nomarkdown} ריבועים בסך הכל, וזה שווה ל-{::nomarkdown}\( \frac{p+1}{2}\){:/nomarkdown}.

עכשיו בואו נביט שוב על המשוואה שאנו רוצים לפתור: {::nomarkdown}\( x^{2}+y^{2}+1=0\){:/nomarkdown}, כלומר {::nomarkdown}\( x^{2}=-1-y^{2}\){:/nomarkdown}. אם נצליח למצוא ריבוע שהוא גם מהצורה {::nomarkdown}\( -1-y^{2}\){:/nomarkdown} ניצחנו; נגדיר {::nomarkdown}\( S^{\prime}=\left\{ -1-a\ \|\ a\in S\right\} \){:/nomarkdown}. אם {::nomarkdown}\( a\ne b\){:/nomarkdown} אז {::nomarkdown}\( -1-a\ne-1-b\){:/nomarkdown} ולכן גם הגודל של {::nomarkdown}\( S^{\prime}\){:/nomarkdown} הוא {::nomarkdown}\( \frac{p+1}{2}\){:/nomarkdown}. אז מה קיבלנו? שתי קבוצות: {::nomarkdown}\( S,S^{\prime}\){:/nomarkdown}, שמספר האיברים הכולל בשתיהן הוא {::nomarkdown}\( p+1\){:/nomarkdown}, אבל ב-{::nomarkdown}\( \mathbb{Z}_{p}\){:/nomarkdown} יש בדיוק {::nomarkdown}\( p\){:/nomarkdown} איברים. מסקנה: יש ל-{::nomarkdown}\( S,S^{\prime}\){:/nomarkdown} איבר משותף - איבר שניתן להציג גם כ-{::nomarkdown}\( x^{2}\){:/nomarkdown} וגם כ-{::nomarkdown}\( -1-y^{2}\){:/nomarkdown}. לכן מצאנו שמתקיים {::nomarkdown}\( x^{2}=-1-y^{2}\){:/nomarkdown}, כלומר {::nomarkdown}\( x^{2}+y^{2}+1=0\){:/nomarkdown}, ומכאן שקיים {::nomarkdown}\( m\){:/nomarkdown} כך ש-{::nomarkdown}\( mp=x^{2}+y^{2}+1\){:/nomarkdown}. לכן בפרט {::nomarkdown}\( mp\){:/nomarkdown} הוא סכום של ארבעה ריבועים: {::nomarkdown}\( mp=x^{2}+y^{2}+1^{2}+0^{2}\){:/nomarkdown}.

אנחנו עדיין רוצים להגביל את הגודל של ה-{::nomarkdown}\( m\){:/nomarkdown} הזה, ונעשה את זה עם תעלול סטנדרטי. אם {::nomarkdown}\( p\|x^{2}+y^{2}+1\){:/nomarkdown}, אז אפשר להוסיף או להחסיר {::nomarkdown}\( p\){:/nomarkdown} בחופשיות ל-{::nomarkdown}\( x,y\){:/nomarkdown} והמשוואה עדיין תתקיים ("להחליף את {::nomarkdown}\( x\){:/nomarkdown} באיבר ששקול לו מודולו {::nomarkdown}\( p\){:/nomarkdown}"). למשל, אם {::nomarkdown}\( 7\|2^{2}+4^{2}+1\){:/nomarkdown}, אנחנו יכולים להחליף את {::nomarkdown}\( 4\){:/nomarkdown} ב-{::nomarkdown}\( -3\){:/nomarkdown} ולקבל את אותו דבר: {::nomarkdown}\( 7\|2^{2}+\left(-3\right)^{2}+1\){:/nomarkdown}. הסכום הראשון נותן לנו {::nomarkdown}\( 4+16+1=21\){:/nomarkdown} והסכום השני נותן לנו {::nomarkdown}\( 4+9+1=14\){:/nomarkdown} - שניהם מתחלקים ב-7, אבל שימו לב שהסכום השני קטן יותר. אז מה שנעשה עם המשוואה {::nomarkdown}\( p\|x^{2}+y^{2}+1\){:/nomarkdown} הכללית הוא לבחור את {::nomarkdown}\( x\){:/nomarkdown} כך שיקיים {::nomarkdown}\( \left\|x\right\|&lt;\frac{p}{2}\){:/nomarkdown} וכך גם עבור {::nomarkdown}\( y\){:/nomarkdown}. אם אתם לא משוכנעים שאפשר, נסו להוכיח זאת לעצמכם. המסקנה? אם {::nomarkdown}\( mp=x^{2}+y^{2}+1\){:/nomarkdown} אז {::nomarkdown}\( mp&lt;\left(\frac{p}{2}\right)^{2}+\left(\frac{p}{2}\right)^{2}+1=\frac{p^{2}}{2}+1\le p^{2}\){:/nomarkdown} ועל ידי כך שנחלק ב-{::nomarkdown}\( p\){:/nomarkdown} את שני האגפים נקבל {::nomarkdown}\( m&lt;p\){:/nomarkdown}, כפי שרצינו.

בשעה טובה הגענו אל החלק האחרון של ההוכחה: להוכיח שאם {::nomarkdown}\( mp\){:/nomarkdown} הוא סכום של ארבעה ריבועים ו-{::nomarkdown}\( 1&lt;m\){:/nomarkdown} אז קיים {::nomarkdown}\( 1\le n&lt;m\){:/nomarkdown} כך שגם {::nomarkdown}\( np\){:/nomarkdown} הוא סכום של ארבעה ריבועים. אז ראשית כל נכתוב:

{::nomarkdown}\( mp=x_{1}^{2}+x_{2}^{2}+x_{3}^{2}+x_{4}^{4}\){:/nomarkdown}

במילים אחרות, {::nomarkdown}\( m\){:/nomarkdown} מחלק את הסכום הזה, כלומר {::nomarkdown}\( x_{1}^{2}+x_{2}^{2}+x_{3}^{2}+x_{4}^{4}\equiv_{m}0\){:/nomarkdown}. כמו קודם, נרצה לבחור איברים ששקולים ל-{::nomarkdown}\( x\){:/nomarkdown}-ים בצורה כזו שהם יהיו קטנים יחסית, אבל הפעם ביחס לגודל של {::nomarkdown}\( m\){:/nomarkdown} ולא של {::nomarkdown}\( p\){:/nomarkdown}. אז לכל {::nomarkdown}\( 1\le i\le4\){:/nomarkdown} נמצא {::nomarkdown}\( y_{i}\){:/nomarkdown} כך ש-{::nomarkdown}\( x_{i}\equiv_{m}y_{i}\){:/nomarkdown} ומתקיים ש-{::nomarkdown}\( -\frac{m}{2}&lt;y_{i}\le\frac{m}{2}\){:/nomarkdown} (בכוונה לא כתבתי {::nomarkdown}\( \left\|y_{i}\right\|\le\frac{m}{2}\){:/nomarkdown} כי עוד מעט אסתמך על כך שאפשר לבחור את ה-{::nomarkdown}\( y_{i}\){:/nomarkdown}-ים כך שיהיו שונים מ-{::nomarkdown}\( -\frac{m}{2}\){:/nomarkdown}). נקבל שיש {::nomarkdown}\( n\){:/nomarkdown} כך ש-{::nomarkdown}\( nm=y_{1}^{2}+y_{2}^{2}+y_{3}^{2}+y_{4}^{4}\le\frac{m^{2}}{4}+\frac{m^{2}}{4}+\frac{m^{2}}{4}+\frac{m^{2}}{4}=m^{2}\){:/nomarkdown}, כלומר {::nomarkdown}\( 0\le n\le m\){:/nomarkdown}. מצאנו את ה-{::nomarkdown}\( n\){:/nomarkdown} שלנו. מה שנשאר לעשות: להוכיח ש-{::nomarkdown}\( n&gt;0\){:/nomarkdown}, להוכיח ש-{::nomarkdown}\( n&lt;m\){:/nomarkdown}, ולהוכיח ש-{::nomarkdown}\( np\){:/nomarkdown} הוא סכום של ארבעה ריבועים.

נניח ש-{::nomarkdown}\( n=0\){:/nomarkdown}. זה אומר שבהכרח כל ה-{::nomarkdown}\( y_{i}\){:/nomarkdown}-ים הם 0, ומכיוון ש-{::nomarkdown}\( x_{i}\equiv_{m}y_{i}\){:/nomarkdown} נובע מכך ש-{::nomarkdown}\( m\){:/nomarkdown} מחלק את כל ה-{::nomarkdown}\( x_{i}\){:/nomarkdown}-ים. לכן {::nomarkdown}\( m^{2}\){:/nomarkdown} מחלק את {::nomarkdown}\( x_{1}^{2}+x_{2}^{2}+x_{3}^{2}+x_{4}^{4}=mp\){:/nomarkdown}. אם {::nomarkdown}\( m^{2}\|mp\){:/nomarkdown} נובע מכך ש-{::nomarkdown}\( m\|p\){:/nomarkdown}, וזו סתירה לכך ש-{::nomarkdown}\( p\){:/nomarkdown} ראשוני (הנה, השתמשנו בזה שוב!). אז {::nomarkdown}\( n\ne0\){:/nomarkdown}.

נניח ש-{::nomarkdown}\( n=m\){:/nomarkdown}. מתי זה יכול לקרות? רק אם {::nomarkdown}\( y_{i}=\frac{m}{2}\){:/nomarkdown} לכל {::nomarkdown}\( 1\le i\le4\){:/nomarkdown}, כלומר {::nomarkdown}\( x_{i}\equiv_{m}\frac{m}{2}\){:/nomarkdown} לכל {::nomarkdown}\( 1\le i\le4\){:/nomarkdown}, ועל ידי העלאה בריבוע של האגפים ושל המודולוס נקבל {::nomarkdown}\( x_{i}^{2}\equiv_{m^{2}}\frac{m^{2}}{4}\){:/nomarkdown}, כלומר {::nomarkdown}\( mp\equiv_{m^{2}}m^{2}\){:/nomarkdown}, כלומר {::nomarkdown}\( m^{2}\|m\left(p-m\right)\){:/nomarkdown} ולכן שוב נקבל {::nomarkdown}\( m\|p\){:/nomarkdown} - סתירה. אז {::nomarkdown}\( n\ne m\){:/nomarkdown}.

כדי להראות ש-{::nomarkdown}\( np\){:/nomarkdown} הוא סכום של ארבעה ריבועים, נסתכל קודם כל על שני הסכומים שכבר ראינו:

{::nomarkdown}\( mp=x_{1}^{2}+x_{2}^{2}+x_{3}^{2}+x_{4}^{4}\){:/nomarkdown}

{::nomarkdown}\( nm=y_{1}^{2}+y_{2}^{2}+y_{3}^{2}+y_{4}^{4}\){:/nomarkdown}

אנחנו כבר יודעים שמכפלה של שני סכומי ארבעה ריבועים היא בעצמה סכום של ארבעה ריבועים, אז על ידי כפל שתי המשוואות אני אקבל ש-{::nomarkdown}\( npm^{2}\){:/nomarkdown} הוא סכום של ארבעה ריבועים. הבעיה היא ה-{::nomarkdown}\( m^{2}\){:/nomarkdown} שתקוע בקצה המכפלה. כדי להיפטר ממנו, אני צריך להראות ש-{::nomarkdown}\( npm^{2}=z_{1}^{2}+z_{2}^{2}+z_{3}^{2}+z_{4}^{2}\){:/nomarkdown} כך שלכל {::nomarkdown}\( 1\le i\le4\){:/nomarkdown} מתקיים {::nomarkdown}\( m\|z_{i}\){:/nomarkdown} - זה יסיים את זה סופית. כדי לראות את זה, אני חושש שאין מנוס מלשלוף שוב את הנוסחה שמציגה את מכפלת שני סכומי הריבועים כסכום ריבועים בעצמה:

{::nomarkdown}\( \left(x_{1}^{2}+x_{2}^{2}+x_{3}^{2}+x_{4}^{2}\right)\left(y_{1}^{2}+y_{2}^{2}+y_{3}^{2}+y_{4}^{2}\right)=\){:/nomarkdown}

{::nomarkdown}\( \left(x_{1}y_{1}-x_{2}y_{2}-x_{3}y_{3}-x_{4}y_{4}\right){}^{2}+\left(x_{1}y_{2}+x_{2}y_{1}+x_{3}y_{4}-x_{4}y_{3}\right)^{2}+\){:/nomarkdown}

{::nomarkdown}\( \left(x_{1}y_{3}-x_{2}y_{4}+x_{3}y_{1}+x_{4}y_{2}\right)^{2}+\left(x_{1}y_{4}+x_{2}y_{3}-x_{3}y_{2}+x_{4}y_{1}\right)^{2}\){:/nomarkdown}

בנוסחה הזו אני הולך לעשות מניפולציה קטנה: אני יכול להחליף את {::nomarkdown}\( y_{2},y_{3},y_{4}\){:/nomarkdown} במינוס שלהם - זה לא משפיע בכלל על אגף שמאל (כי אנחנו מעלים את המספרים הללו בריבוע) ובאגף ימין זה רק יגרום לביטויים שבתוך הסוגריים להיות יותר נוחים עבורי. עכשיו, אני צריך להוכיח שכל אחד מהביטויים הללו מתחלק ב-{::nomarkdown}\( m\){:/nomarkdown}, ולכן אני אסתכל עליו מודולו {::nomarkdown}\( m\){:/nomarkdown} ואשתמש בכך ש-{::nomarkdown}\( x_{i}\equiv_{m}y_{i}\){:/nomarkdown}.

נקבל שהביטוי בסוגריים הראשונים, אחרי החלפת ה-{::nomarkdown}\( y\){:/nomarkdown}-ים במינוסים שלהם ואחרי החלפת ה-{::nomarkdown}\( y\){:/nomarkdown}-ים ב-{::nomarkdown}\( x\){:/nomarkdown}-ים, הוא {::nomarkdown}\( x_{1}^{2}+x_{2}^{2}+x_{3}^{2}+x_{4}^{2}\){:/nomarkdown}, והביטוי הזה שווה ממש ל-{::nomarkdown}\( mp\){:/nomarkdown} ולכן בוודאי ששקול ל-0 מודולו {::nomarkdown}\( m\){:/nomarkdown}.

נותרו שלושת הסוגריים האחרים ובכולם המבנה דומה. נסתכל על הסוגר הראשון מביניהם: הביטוי בו בהתחלה היה {::nomarkdown}\( x_{1}y_{2}+x_{2}y_{1}+x_{3}y_{4}-x_{4}y_{3}\){:/nomarkdown}. אחרי החלפת {::nomarkdown}\( y_{2},y_{3},y_{4}\){:/nomarkdown} במינוסים שלהם קיבלנו את {::nomarkdown}\( x_{2}y_{1}-x_{1}y_{2}+x_{4}y_{3}-x_{3}y_{4}\){:/nomarkdown}. שימו לב לסימטריה! עכשיו, אחרי החלפת ה-{::nomarkdown}\( y\){:/nomarkdown}-ים ב-{::nomarkdown}\( x\){:/nomarkdown}-ים נקבל {::nomarkdown}\( x_{2}x_{1}-x_{1}x_{2}+x_{4}x_{3}-x_{3}x_{4}=0\){:/nomarkdown}, כלומר קיבלנו שהביטוי שקול ל-0 מודולו {::nomarkdown}\( m\){:/nomarkdown} ולכן מתחלק ב-{::nomarkdown}\( m\){:/nomarkdown}. אותו דבר מטפל בכל יתר הביטויים שבסוגריים, אז ניצחנו!

המסקנה הסופית שלנו היא שכל מספר ניתן לייצוג כסכום של ארבעה ריבועים, אבל יש עוד שתי הערות צדדיות שאני רוצה לדבר עליהן כאן. ראשית, יש תוצאה חזקה אפילו יותר עבור ראשוניים ששקולים ל-1 מודולו {::nomarkdown}\( 4\){:/nomarkdown}: כל ראשוני כזה ניתן להצגה כסכום של <strong>שני</strong> ריבועים. זו אבחנה שהייתה קיימת כבר אצל פרמה ואוילר הוכיח; את ההוכחה <a href="http://www.gadial.net/2009/06/26/sums_of_squares_and_quadratic_reciprocity/">כבר הצגתי בבלוג</a> בעבר. אוילר הוא גם זה שמצא את הנוסחה שמציגה מכפלה של סכום של ארבעה ריבועים בתור סכום של ארבעה ריבועים בעצמו, אבל לא עלה בידיו למצוא את יתר ההוכחה - את זה עשה, כאמור, לגראנז', ב-1770. לא מעט שנים לאחר מכן, ב-1834, יעקובי הצליח להוכיח תוצאה חזקה בהרבה - נוסחה שנותנת, לכל מספר טבעי, את <strong>מספר</strong> הדרכים השונות לכתוב אותו כסכום של ארבעה ריבועים; במילים אחרות, נוסחה שמתארת את מספר הפתרונות השונים למשוואה הדיופנטית {::nomarkdown}\( x_{1}^{2}+x_{2}^{2}+x_{3}^{2}+x_{4}^{2}=n\){:/nomarkdown}. בפרט המספר הזה גדול תמיד מ-0 ולכן משפט לגראנז' נובע. רק מה, ההוכחות לטענה הזו מסובכות יותר; הפשוטה ביותר שאני מכיר היא של דיריכלה ומסתמכת על קרקטרי דיריכלה, שגם אותם <a href="http://www.gadial.net/2009/05/25/dirichlet_theorem_on_arithmetic_progressions/">כבר הצגתי בבלוג בעבר</a>. יהיה נחמד מאוד להציג את ההוכחה הזו מתישהו בבלוג, אבל לעת עתה אסתפק בלתת את הנוסחה: אם {::nomarkdown}\( n\){:/nomarkdown} הוא מספר טבעי חיובי <strong>אי זוגי</strong> אז מספר הפתרונות בשלמים (כולל שליליים! ועם חשיבות לסדר!) למשוואה {::nomarkdown}\( x_{1}^{2}+x_{2}^{2}+x_{3}^{2}+x_{4}^{2}=n\){:/nomarkdown} הוא {::nomarkdown}\( 8\cdot\sum_{d\|n}d\){:/nomarkdown} (שמונה כפול סכום המחלקים הטבעיים של {::nomarkdown}\( n\){:/nomarkdown}), ואם {::nomarkdown}\( n\){:/nomarkdown} הוא <strong>זוגי</strong> אז מספר הפתרונות הוא {::nomarkdown}\( 24\cdot\sum_{d\|n}d\){:/nomarkdown} כאשר כאן ה-{::nomarkdown}\( d\){:/nomarkdown}-ים הם רק המחלקים האי-זוגיים.

הנוסחה מגניבה לגמרי, אבל כשאני רואה אותה הדבר הראשון שאני תוהה לגביו הוא למה, לכל הרוחות, היא בכלל עובדת. לכן הוכחות הן דבר מעניין. לצערי, נצטרך לוותר עליה לבינתיים כי שולי הפוסט הזה צרים מלהכילה (מתי, מתי יימאס לי מהבדיחה הזו בסוף פוסטים של תורת המספרים?)
