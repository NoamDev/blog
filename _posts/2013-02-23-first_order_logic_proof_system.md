---
id: 2357
title: מערכת הוכחה ללוגיקה מסדר ראשון
date: 2013-02-23T16:54:04+00:00
author: gadial
layout: post
guid: http://www.gadial.net/?p=2357
permalink: /2013/02/23/first_order_logic_proof_system/
categories:
  - לוגיקה
tags:
  - לוגיקה מסדר ראשון
  - לוגיקה מתמטית
  - מערכות הוכחה
---
סדרת הפוסטים שלי על לוגיקה הגיעה עד לתיאור של הסינטקס והסמנטיקה של [לוגיקה מסדר ראשון](http://www.gadial.net/2012/06/17/first_order_logic/) ושם עצרתי, כי השלב הבא, שעליו אני רוצה לדבר עכשיו, הוא לא פשוט. בתחשיב הפסוקים, שהצגתי בתור "חימום" ללוגיקה מסדר ראשון, היעד שלנו היה הצגת **מערכת הוכחה:** אוסף של אקסיומות וכללי גזירה שמאפשרים, בהינתן קבוצת פסוקים כלשהי ("הנחות"), לגזור את כל המסקנות הסמנטיות מאותה קבוצת פסוקים באופן סינטקטי לגמרי: לכל מסקנה שכזו תהיה הוכחה, שהיא בסך הכל סדרה סופית של פסוקים שכל אחד מהם הוא אקסיומה, הנחה או נובעת מפסוקים קודמים על ידי כללי הגזירה. אחרי ש[הצגתי](http://www.gadial.net/2012/04/04/propositional_caclulus_proofs/) את מערכת ההוכחה [הראיתי](http://www.gadial.net/2012/04/08/propositional_calculus_completeness/) שהיא **נאותה** ו**שלמה**, כאשר נאותות פירושה היה "כל מה שיכיח, נכון" ואילו שלמות הייתה "כל מה שנכון, יכיח". ההוכחה של משפט השלמות הייתה מורכבת יחסית; בלוגיקה מסדר ראשון יש לנו רמת סיבוך נוספת.

נתחיל עם הצגה של מערכת ההוכחה שלי עבור לוגיקה מסדר ראשון. כדאי להעיר שאין קונצנזוס בנקודה הזו: יש מערכות הוכחה רבות ושונות בספרות, למרות שבשורה התחתונה ההוכחות של משפט השלמות והנאותות שלהן דומות באופיין. אני בוחר להציג כאן את זו שבעיני אישית היא הפשוטה ביותר. אני מניח שהקוראים זוכרים בערך איך מוגדרים הסינטקס והסמנטיקה של לוגיקה מסדר ראשון, כמו גם מה בערך הולך במערכת ההוכחה של תחשיב הפסוקים; לא אחזור על זה שוב כאן.

מכיוון שלוגיקה מסדר ראשון היא מעין הכללה של תחשיב הפסוקים, די ברור שמערכת ההוכחה שלנו תהיה הכללה של זו של תחשיב הפסוקים. כזכור, במערכת ההוכחה הזו השתמשתי בשלוש "תבניות אקסיומה":

  1. $latex \alpha\to\left(\beta\to\alpha\right)$
  2. $latex \left[\alpha\to\left(\gamma\to\beta\right)\right]\to\left[\left(\alpha\to\gamma\right)\to\left(\alpha\to\beta\right)\right]$
  3. $latex \left(\neg\alpha\to\neg\beta\right)\to\left(\beta\to\alpha\right)$

אלו "תבניות" כי במקום $latex \alpha,\beta,\gamma$ אפשר להציב פסוקים כלשהם. באותו האופן התבניות הללו יהיו שייכות גם למערכת ההוכחה של לוגיקה מסדר ראשון, כאשר במקום $latex \alpha,\beta,\gamma$ מציבים נוסחאות כלשהן בלוגיקה מסדר ראשון. תבנית כזו היא בעלת התכונה הסמנטית שלא חשוב מה נציב בה - בכל מבנה ובכל השמה, הפסוק שמתקבל מההצבות הללו יהיה בעל ערך אמת, ואפילו אם הנוסחאות שמציבים הן מורכבות וכללות כמתים ופונקציות ואקשן. הסיבה פשוטה: אם מחשבים את ערך האמת של הפסוק שמתקבל מההשמות, בסופו של דבר נקבל שכל מה שהצבנו במקום $latex \alpha$ מתורגם לאחד משניים: או $latex \mbox{T}$ או $latex \mbox{F}$, וכך גם עבור $latex \beta,\gamma$, מה שאומר שלא משנה איזו נוסחה מורכבת אפשר להציב במקום $latex \alpha,\beta,\gamma$, עדיין תחת מבנה והשמה נתונים הם מתנהגים כמו משתנים בתחשיב הפסוקים, ולכן תבנית אקסיומה שהייתה טאוטולוגיה בתחשיב הפסוקים נותרת כזו גם כעת.

כלל ההיסק שלנו בתחשיב הפסוקים היה מודוס פוננס, $latex \mbox{MP}$, שמתוך $latex \alpha$ ו-$latex \alpha\to\beta$ גזר את $latex \beta$. נשתמש בו גם כעת. כפי שראינו, זה מספיק כדי לגזור כל טאוטולוגיה בתחשיב הפסוקים. הבעיה היא שבלוגיקה מסדר ראשון יש עוד דברים. מן הסתם יהיו אלה דברים שקשורים לכמתי ה"קיים" ו"לכל" שאין משהו דומה להם בתחשיב הפסוקים. בואו ניתן דוגמה:

$latex \forall x\left(R\left(x\right)\right)\to R\left(y\right)$

זו נוסחה שמשתמשת בסימן יחס חד-מקומי $latex R$, ויש בה משתנה קשור אחד $latex x$ ומשתנה חופשי אחד $latex y$. בכל מבנה $latex \mathcal{M}$ ערך האמת של הרישא של הפסוק - $latex \forall x\left(R\left(x\right)\right)$ - נקבע באופן יחיד, והוא יהיה $latex \mbox{T}$ אם ורק אם $latex R^{\mathcal{M}}=D^{\mathcal{M}}$, כלומר אם היחס $latex R$ מתפרש ב-$latex \mathcal{M}$ בתור "כל העולם". כעת, אם הערך של $latex \forall x\left(R\left(x\right)\right)$ הוא $latex \mbox{F}$ אז הנוסחה כולה היא תמיד בעל ערך אמת $latex \mbox{T}$; ואילו אם ערך האמת שלו הוא $latex \mbox{T}$ אז $latex R^{\mathcal{M}}=D^{\mathcal{M}}$ ולכן לכל השמה אפשרית, לא משנה איזה ערך היא נותנת ל-$latex y$, יתקיים ש-$latex R\left(y\right)$ הוא $latex \mbox{T}$ ולכן שוב הנוסחה כולה תהיה $latex \mbox{T}$. במילים אחרות, הנוסחה $latex \forall x\left(R\left(x\right)\right)\to R\left(y\right)$היא בעלת ערך האמת $latex \mbox{T}$ בכל מבנה ובכל השמה אפשריים. לנוסחה בעלת התכונה הזו אני קורא **אמת לוגית**, ובכוונה אני לא קורא לה "טאוטולוגיה" כמו בתחשיב הפסוקים. במילה "טאוטולוגיה" בלוגיקה מסדר ראשון אני משתמש כדי לתאר את מה שמתקבל מלקיחת טאוטולוגיה בתחשיב הפסוקים ואז הצבת נוסחאות בתור המשתנים, ואילו $latex \forall x\left(R\left(x\right)\right)\to R\left(y\right)$ בבירור לא יכול להתקבל בצורה הזו. הדרך היחידה שבה הוא יכול להתקבל היא על ידי הצבה בפסוק $latex X\to Y$, אבל הפסוק הזה כלל אינו טאוטולוגיה.

זה מראה לנו שהסיבות לכך ש-$latex \forall x\left(R\left(x\right)\right)\to R\left(y\right)$ היא אמת לוגית הן עמוקות יותר מאשר הסיבות לכך שנוסחה כמו $latex \forall x\left(R\left(x\right)\right)\to\left(R\left(y\right)\to\forall x\left(R\left(x\right)\right)\right)$ היא אמת לוגית; השניה מתקבלת מהצבה בפסוק $latex X\to\left(Y\to X\right)$ שהוא כן טאוטולוגיה של תחשיב הפסוקים, ולכן ערך האמת שלה נובע במובן מסויים רק מתכונות ה**קשרים** ($latex \to$ במקרה הזה), בעוד שערך האמת הלוגית של $latex \forall x\left(R\left(x\right)\right)\to R\left(y\right)$ נובע גם מתכונות ה**כמתים** (שימו לב: אם נחליף את $latex \forall$ ב-$latex \exists$ נקבל משהו שאינו אמת לוגית). אני מקווה שזה עוזר להבין למה מה שעשינו בתחשיב הפסוקים רחוק מלהיות מספיק גם בתחשיב היחסים.

הנוסחה שלעיל מרמזת על סוג חדש של תבנית אקסיומה שנזדקק לו. אבל איך אפשר לפרמל אותה? בואו נראה עוד כמה דוגמאות לפני שנציג את המקרה הכללי. ראשית, הביטו בנוסחה הזו:

$latex \forall x\left(\exists y\left(x+y>c\right)\right)\to \left(\exists y\left(z+y>c\right)\right)$

כאן המשתנים $latex x,y$ הם קשורים ואילו $latex z$ הוא המשתנה החופשי; $latex c$ הוא סימן קבוע, $latex +$הוא סימן פונקציה ו-$latex >$ הוא סימן יחס. לא קשה לראות שגם הנוסחה הזו היא אמת לוגית. מה הדמיון בינה ובין הנוסחה הקודמת שהצגתי? בשתיהן יש "לכל $latex x$ **משהו** עבור **$latex x$** גורר **משהו** עבור $latex y$". שם ה"משהו" היה $latex R\left(x\right)$ וכאן ה"משהו" הוא $latex \exists y\left(x+y>c\right)$ . באופן כללי "משהו" כזה יכול להיות כל נוסחה, אפילו נוסחאות שבהן $latex x$ בכלל לא מופיע. אז לכאורה הצורה של האקסיומה צריכה להיות $latex \forall x\varphi\to\varphi$, אבל הצורה הזו **לא כללית מספיק**. היא מסוגלת ליצור משהו כמו $latex \forall x\left(R\left(x\right)\right)\to R\left(x\right)$, אבל הוא לא מסוגלת ליצור משהו כמו $latex \forall x\left(R\left(x\right)\right)\to R\left(y\right)$.

אם כן, אולי אפשר לומר שהצורה של האקסיומה תהיה $latex \forall x\varphi\to\psi$, כאשר $latex \psi$ מתקבל מ-$latex \varphi$ על ידי **שינוי השם** של המשתנה $latex x$. זה כבר יותר בכיוון, אבל הנה נוסחה שהיא אמת לוגית ולא יכולה להתקבל כך:

$latex \forall x\left(x\ge0\right)\to\left(1\ge0\right)$

כאן $latex 0,1$ הם סימני קבועים של השפה ו-$latex \ge$ הוא סימן יחס. כאן כבר לא סתם שינינו את השם של $latex x$ אלא ממש החלפנו אותו בקבוע. ואפשר היה לעשות גם משהו כזה:

$latex \forall x\left(x\ge0\right)\to\left(\left(1+z\right)^{2}\ge0\right)$

כאשר כאן העלאה בריבוע היא סימן פונקציה, וגם חיבור הוא סימן פונקציה. מה שקרה הוא שהחלפנו את $latex x$ ב**שם עצם**: $latex \left(1+z\right)^{2}$. אם כן, אפשר לומר שהצורה של האקסיומה תהיה $latex \forall x\varphi\to\psi$ כאשר $latex \psi$ מתקבל מ-$latex \varphi$ על ידי החלפת כל מופע של $latex x$ בשם עצם ספציפי כלשהו $latex t$. זה בהחלט בכיוון, אבל זה כבר **כללי יותר מדי**. אם נעשה את זה, אנחנו עלולים לקבל נוסחאות שאינן אמיתות לוגיות. הנה דוגמה. ניקח את $latex \varphi$ להיות $latex \exists y\left(y>x\right)$ ואת $latex t$ להיות $latex y$ ונקבל:

$latex \forall x\left(\exists y\left(y>x\right)\right)\to\exists y\left(y>y\right)$

וזה בבירור לא פסוק שהוא אמת לוגית, כי קחו בתור מודל את המספרים הטבעיים - לכל מספר טבעי $latex x$ קיים מספר גדול ממנו $latex y$, אבל אין אף מספר טבעי שגדול מעצמו. מה השתבש? הבעיה היא שאנחנו משתמשים ב-$latex y$ בתפקיד כפול: בתוך $latex \varphi$ הוא משתנה **מכומת**, בעוד ש-$latex x$ הוא משתנה **חופשי** בתוך $latex \varphi$. בכך שאנחנו מציבים את $latex y$ במקום $latex x$ אנחנו הופכים משהו שלפני שניה היה חופשי (ולכן לא מושפע מהכמת $latex \exists y$) למשהו קשור (שכן מושפע מהכמת הזה). זה סוג שינוי שאנחנו חייבים למנוע. זה מוביל אותנו להגדרה שהיא קצת קשה לעיכול אם לא רואים לה קודם מוטיבציה: שם עצם $latex t$ הוא **חופשי להצבה** במקום $latex x$ בפסוק $latex \varphi$ אם $latex t$ לא מכיל אף משתנה $latex y$ כך שיש מופע חופשי של $latex x$ ב-$latex \varphi$ שנופל תחת כמת עבור $latex y$. זו הגדרה מסובכת מבחינה מילולית, אבל העיקרון ברור - אנחנו לא רוצים להחליף את $latex x$ במשהו, ואז לגלות שבתוך המשהו היה משתנה שפתאום הופך להיות מכומת.

עוד נקודה שצריך לשים לב אליה היא ש-$latex \varphi$ עשוי להכיל גם מופעים לא חופשיים של $latex x$, ובהם אסור להציב. זה מקרה קצה מוזר למדי אבל עדיין יש להתחשב בו. הנה דוגמה: ניקח בתור $latex \varphi$ את $latex \exists x\left(x>0\right)$ ובתור $latex t$ את הקבוע $latex 0$, ונקבל:

$latex \forall x\left(\exists x\left(x>0\right)\right)\to\left(\exists x\left(0>0\right)\right)$

שהוא כמובן לא נכון. הבעיה כאן היא הפוכה ביחס לבעיה הקודמת: קודם הפכנו מישהו לא מכומת למכומת, ואילו כאן אנחנו משתמשים בהצבה לתוך $latex x$ כדי "להימלט" מהכמת $latex \exists x$. הפתרון הוא פשוט למדי: לא מציבים את $latex t$ בתוך מופעים מכומתים של $latex x$ ב-$latex \varphi$ אלא רק במופעים החופשיים שלו.

עכשיו אפשר סוף סוף לנסח את תבנית האקסיומה במפורש. התבנית היא:

<ol start="4">
  <li>
    $latex \forall x\varphi\to\psi$
  </li>
</ol>

כאשר $latex \psi$ מתקבל מ-$latex \varphi$ על ידי הצבה בכל מופע חופשי של $latex x$ ב-$latex \varphi$ שם עצם $latex t$ כלשהו שהוא חופשי להצבה במקום $latex x$ ב-$latex \varphi$.

צריך כמובן להוכיח שכל נוסחה כזו היא אכן אמת לוגית, מה שניתן לעשות באופן ישיר למדי הישר מהגדרות הסמנטיקה של לוגיקה מסדר ראשון ואוותר על כך כאן (ההוכחה דומה למה שעשיתי לעיל עבור $latex \varphi=R\left(x\right)$).

בואו נעבור להתבונן על נוסחה אחרת שעדיין אין לנו יכולת להוכיח במערכת שלנו:

$latex \forall x\left(R\left(y\right)\to S\left(x\right)\right)\to\left(R\left(y\right)\to\forall xS\left(x\right)\right)$

כאן $latex R,S$ הם סימני יחס כלשהם שנמצאים פה בעיקר לצורך הדוגמה. מה הולך פה? הנוסחה הזו היא פשוט דרך אחרת להגיד שאם יש לנו כמת על שני דברים (במקרה שלנו $latex R,S$) כך שהכמת בכלל לא רלוונטי לראשון מביניהם, אפשר להעביר אותו אל השני בלבד וחסל. נסו להוכיח שהנוסחה הזו היא אמת לוגית; אין כאן הרבה יותר ממשחק בהגדרות.

הפורמליזציה של תבנית האקסיומה הזו פשוטה:

<ol start="5">
  <li>
    $latex \forall x\left(\varphi\to\psi\right)\to\left(\varphi\to\forall x\psi\right)$
  </li>
</ol>

כאשר הדרישה היא ש-$latex x$ איננו משתנה חופשי ב-$latex \varphi$. קל לראות שהדרישה הזו הכרחית כדי שהתבנית תגדיר נוסחאות אמיתיות לוגיות; בואו נביט על $latex \forall x\left(x>0\to x>0\right)\to\left(x>0\to\forall x\left(x>0\right)\right)$ שהוא בבירור לא אמת לוגית - אגף ימין שלו בבירור מתקיים אבל אגף שמאל אומר שאם $latex x$ **ספציפי** הוא גדול מאפס אז נובע מכך ש**כל $latex x$** הוא גדול מאפס וזה בוודאי לא נכון.

האם באמת היה צריך להוסיף את תבנית האקסיומה החדשה הזו? האם אי אפשר לקבל אותה מהדברים הקיימים? לא ממש. התבנית הקודמת שהצגתי יודעת **להסיר** $latex \forall$; היא לא יודעת **להזיז** אותו. זה מרמז גם על מה שעדיין חסר לנו - דרך **לייצר** $latex \forall$. לצורך כך אוסיף **כלל היסק** חדש שנקרא $latex \mbox{Gen}$ (מלשון Generalization - הכללה). הכלל מקבל פסוק $latex \varphi$ ומייצר ממנו את $latex \forall x\varphi$ עבור משתנה כלשהו $latex x$, וניתן להשתמש בו גם כאשר $latex x$ כן מופיע חופשי ב-$latex \alpha$. עם זאת, יש עליו סייג קטן: אם $latex \Phi$ היא קבוצת ההנחות שבה אנחנו משתמשים בהוכחה שלנו, אסור להשתש ב-Gen עבור אף משתנה $latex x$ שמופיע חופשי בהנחה כלשהי ב-$latex \Phi$. אצלנו ממילא אנחנו הולכים לדבר רק על קבוצת הנחות שהן **פסוקים**, כלומר נוסחאות בלי משתנים חופשיים, כך שהסייג הזה לא יהיה רלוונטי לנו ונוכל להשתמש ב-Gen בחופשיות.

תחת הסייג הזה פשוט למדי להוכיח ש-Gen עובד: נניח ש-$latex \Phi\models\varphi$, כלומר כל מבנה $latex \mathcal{M}$ והשמה $latex z$ מקיימים שאם $latex \mathcal{M}\models\_{z}\Phi$ אז $latex \mathcal{M}\models\_{z}\varphi$. כדי להראות ש-$latex \mathcal{M}\models\_{z}\forall x\varphi$ צריך להראות שמתקיים $latex \mathcal{M}\models\_{z\left[x\leftarrow a\right]}\varphi$ לכל $latex a\in D^{\mathcal{M}}$. כעת, מכיוון ש-$latex x$ לא מופיע חופשי באף הנחה ב-$latex \Phi$ הרי ש-$latex \mathcal{M}\models\_{z\left[x\leftarrow a\right]}\Phi$ (השינוי של הערך ש-$latex x$ מקבל בהשמה $latex z$ לא משפיע על ערך האמת ש-$latex z$ נתנה לפסוקי $latex \Phi$) ולכן $latex \mathcal{M}\models\_{z\left[x\leftarrow a\right]}\varphi$.

האם סיימנו להציג את מערכת ההוכחה? תלוי. בהגדרות מסויימות של לוגיקה מסדר ראשון, כן; אבל אני הגדרתי לוגיקה מסדר ראשון כשהיא כוללת את סימן השוויון, והוא זקוק לטיפול מיוחד, מכיוון שהסמנטיקה שלו מיוחדת. הדרך הפשוטה ביותר להבין זאת היא להיות מודעים לכך שכרגע אין למערכת ההוכחה שלנו שום דרך להוכיח את הנוסחה הבאה:

$latex x=x$

די ברור שאפשר להוסיף אותה כתבנית אקסיומה, אבל זה עדיין לא מספיק. צריך עוד תבנית אקסיומה שתגיד לנו שאם שני משתנים הם שווים בערכם, אז כל שני שמות עצם שזהים פרט לאותם משתנים גם כן שווים בערכם, וכל שתי נוסחאות שזהות פרט לאותם משתנים הן שקולות. פורמלית, אז אלו האקסיומות שקשורות לשוויון ($latex x,y$ מייצגים משתנים, $latex t,s$ מייצגים שמות עצם, $latex \varphi,\psi$ מייצגים נוסחאות):

  1. $latex x=x$
  2. $latex x=y\to t=s$ כאשר $latex s$ מתקבל מ-$latex t$ על ידי החלפת מופע אחד או יותר של $latex x$ ב-$latex y$.
  3. $latex x=y\to\left[\varphi\to\psi\right]$ כאשר $latex \psi$ מתקבל מ-$latex \varphi$ על ידי החלפת מופע אחד או יותר של $latex x$ ב-$latex y$.

האם סיימנו? באופן מפתיע למדי, התשובה היא כן! מסתבר שדי באקסיומות וכללי ההיסק שהראיתי כדי להוכיח כל פסוק בלוגיקה מסדר ראשון שנובע לוגית מקבוצת פסוקים של הנחות. כלומר, כעת אני יכול להוכיח את משפט השלמות והנאותות הבא: אם $latex \Phi$ היא קבוצת פסוקים בלוגיקה מסדר ראשון ו-$latex \varphi$ הוא פסוק כלשהו, אז $latex \Phi\vdash\varphi\iff\Phi\models\varphi$. את ההוכחה אתחיל להציג בפוסט הבא.