---
id: 344
title: "בעיית וויל האנטינג"
date: 2010-02-18 21:36:04
layout: post
categories: 
  - אלגברה לינארית
  - מתמטיקה בראי התקשורת
  - קומבינטוריקה
  - תורת הגרפים
tags: 
  - דטרמיננטות
  - מטריצות
  - מתמטיקה קולנועית
  - פונקציות יוצרות
  - תורת הגרפים האלגברית
---
נקודת המוצא העלילתית של הסרט "<a href="http://en.wikipedia.org/wiki/Good_Will_Hunting">סיפורו של וויל האנטינג</a>" (וכאן אני עומד לגלות טיפה מפרטי העלילה - אבל לא משהו שלא מתגלה ממילא בעשר הדקות הראשונות של הסרט, ואיננו מהותי כל כך) היא חידה מתמטית שפרופסור ב-MIT נותן לסטודנטים בקורס מתקדם שלו, בתקווה שמישהו מהם יצליח לפתור אותה עד סוף הסמסטר ובכך יכנס להיכל התהילה. את החידה פותר כבדרך אגב דווקא השרת של הבניין, מה שחושף אותו כגאון מתמטי חבוי, וכל השאר היסטוריה. אולם מהי החידה שבחרו יוצרי הסרט לתת? מסיבות השמורות עמם, הם החליטו לאפשר לקהל לראות את החידה כתובה במלואה על הלוח, כמו גם את הפתרון. אציג את החידה, ולאחר מכן אסביר כיצד פותרים אותה.

ובכן, נתון גרף (ראו תמונה) ונשאלות עליו השאלות הבאות:
<ol>
	<li>מצאו את מטריצת השכנויות {::nomarkdown}\( A\){:/nomarkdown} של הגרף {::nomarkdown}\( G\){:/nomarkdown}.</li>
	<li>מצאו את המטריצה שנותנת את מספר המסלולים מאורך 3 ב-{::nomarkdown}\( G\){:/nomarkdown}.</li>
	<li>מצאו את הפונקציה היוצרת של המסלולים מ-{::nomarkdown}\( i\){:/nomarkdown} אל {::nomarkdown}\( j\){:/nomarkdown}.</li>
	<li>מצאו את הפונקציה היוצרת של המסלולים מ-{::nomarkdown}\( 1\){:/nomarkdown} אל {::nomarkdown}\( 3\){:/nomarkdown}.</li>
</ol>
<strong><a href="http://www.gadial.net/wp-content/uploads/2010/02/will-hunting-one.png"><img class="alignnone size-full wp-image-360" title="Will Hunting Question" alt="חידת וויל האנטינג" src="http://www.gadial.net/wp-content/uploads/2010/02/will-hunting-one.png" width="640" height="309" /></a>
</strong>

כבר בניסוח שלה, השאלה מרגישה יותר כמו תרגיל סטנדרטי ולא כמו אתגר מתמטי כביר. ואכן, כפי שאראה בקרוב, מדובר בשאלה פשוטה למדי ב<a href="http://en.wikipedia.org/wiki/Algebraic_graph_theory">תורת הגרפים האלגברית</a> - מה שקצת מוזר, בהתחשב בכך שהמרצה מציג את החידה בסרט בתור "Advanced Fourier System", בסוף שיעור שעוסק באנליזת פורייה (דהיינו, המרצה ממלמל משהו על משפט פרסבל, ששייך לאנליזת פורייה). אני סקרן לדעת איך התגלגלה השאלה הספציפית הזו לתסריט הסרט ואשמח אם מישהו שיודע זאת יספר.

הבה ונבהיר מה בעצם רוצים בשאלה הזו. ראשית, נותנים גרף {::nomarkdown}\( G\){:/nomarkdown} על ידי ציור. גרף מורכב (כפי שניתן לראות בציור) מאוסף של עיגולים - "הצמתים" - וקווים שמחברים חלק מהם - "הקשתות". כך למשל בין הצומת 1 לצומת יש קשת אחת, בין 2 ו-3 יש שתי קשתות, בין 1 ו-3 אין אף קשת וכו'. מסלול בגרף מתחיל מצומת א', ואז מבצע סדרת "צעדים", כשכל צעד הוא מעבר מהצומת הנוכחי לצומת שמחובר לצומת הנוכחי בקשת. אם יש כמה קשתות בין שני צמתים, לרוב זה נחשב כאילו יש מספר דרכים לעבור בין שני הצמתים. כך למשל אפשר לקבל את המסלולים הבאים מצומת 1 לצומת 3 מאורך 2: ראשית הולכים מצומת 1 לצומת 2, ולאחר מכן הולכים מ-2 ל-3, אלא שיש שתי דרכים לעשות זאת כי יש שתי קשתות בין 2 ו-3. לכן יש שני מסלולים מאורך 2 מ-1 אל 3.

יש עוד שני מושגים להסביר - "מטריצה" ו"פונקציה יוצרת", שניהם מושגים בסיסיים יחסית במתמטיקה. <a href="http://he.wikipedia.org/wiki/%D7%9E%D7%98%D7%A8%D7%99%D7%A6%D7%94">מטריצה</a>, בהקשר של השאלה הזו, ניתנת לתיאור בתור טבלה של מספרים. כשמדובר על מטריצת השכנויות של גרף מדובר על מטריצה ספציפית, שמקודדת בתוכה את מספר הקשתות בין כל שני צמתים בגרף. הכלל הוא פשוט: בשורה ה-{::nomarkdown}\( i\){:/nomarkdown} והעמודה ה-{::nomarkdown}\( j\){:/nomarkdown} כתוב מספר הקשתות שמחברות את הצמתים {::nomarkdown}\( i\){:/nomarkdown} ו-{::nomarkdown}\( j\){:/nomarkdown}. לכן, מבט מהיר בגרף נותן לנו את המטריצה המבוקשת:

{::nomarkdown}\( A=\left(\begin{array}{cccc}0 &amp; 1 &amp; 0 &amp; 1\\1 &amp; 0 &amp; 2 &amp; 1\\0 &amp; 2 &amp; 0 &amp; 0\\1 &amp; 1 &amp; 0 &amp; 0\end{array}\right)\){:/nomarkdown}

עד כאן, שום דבר מורכב. התחכום מתחיל בשאלה הבאה - מי שלא בקיא בתורת הגרפים האלגברית (או בתחומים אחרים שבהם אותם רעיונות מופיעים, כמו למשל <a href="http://he.wikipedia.org/wiki/%D7%A9%D7%A8%D7%A9%D7%A8%D7%AA_%D7%9E%D7%A8%D7%A7%D7%95%D7%91">הילוכים מקריים בדידים</a>) יכול לתהות מה הקשר בין מטריצה ובין מספר המסלולים ומה הולך כאן. כאן נכנסת לתמונה הפעולה של <a href="http://he.wikipedia.org/wiki/%D7%9B%D7%A4%D7%9C_%D7%9E%D7%98%D7%A8%D7%99%D7%A6%D7%95%D7%AA">כפל מטריצות</a>. מכיוון שמושג המטריצה, והמוטיבציה להגדרת כפל המטריצות באופן שבו הוא מוגדר, ראויים שניהם לפוסט שלם, לא אכנס לכך בינתיים אלא אניח כי ההגדרות מוכרות כבר לקורא (ועם מי שטרם יודעים הסליחה). כדי לראות כיצד כפל מטריצות עוזר לנו ניאלץ לשלוף את ההגדרה הפורמלית-טכנית של הכפל. אם נכפול את {::nomarkdown}\( A\){:/nomarkdown} בעצמה, אז בקוארדינטה ה-{::nomarkdown}\( i,j\){:/nomarkdown} של המכפלה נקבל את {::nomarkdown}\( \sum_{k=1}^{n}a_{ik}a_{kj}\){:/nomarkdown}. מה המספר הזה אומר? לכל {::nomarkdown}\( k\){:/nomarkdown}, {::nomarkdown}\( a_{ik}\cdot a_{kj}\){:/nomarkdown} הוא מכפלה של מספר המסלולים מאורך 1 מ-{::nomarkdown}\( i\){:/nomarkdown} ל-{::nomarkdown}\( k\){:/nomarkdown}, במספר המסלולים מאורך 1 מ-{::nomarkdown}\( k\){:/nomarkdown} אל {::nomarkdown}\( j\){:/nomarkdown}. כלומר, זה מייצג את מספר הדרכים להגיע בשני צעדים מ-{::nomarkdown}\( i\){:/nomarkdown} אל {::nomarkdown}\( j\){:/nomarkdown} תוך מעבר בצומת הביניים {::nomarkdown}\( k\){:/nomarkdown}. כשסוכמים זאת על כל הערכים האפשריים של {::nomarkdown}\( k\){:/nomarkdown} מקבלים את <strong>כל</strong> הדרכים לעבור מ-{::nomarkdown}\( i\){:/nomarkdown} אל {::nomarkdown}\( j\){:/nomarkdown} ב-2 צעדים.

באופן דומה אם נכפול את {::nomarkdown}\( A^{2}\){:/nomarkdown} ב-{::nomarkdown}\( A\){:/nomarkdown}, הקוארדינטה ה-{::nomarkdown}\( i,j\){:/nomarkdown} תהיה סכום של מכפלות, כשכל מכפלה היא של מספר הדרכים להגיע מ-{::nomarkdown}\( i\){:/nomarkdown} אל {::nomarkdown}\( k\){:/nomarkdown} ב<strong>שני צעדים</strong>, ומ-{::nomarkdown}\( k\){:/nomarkdown} אל {::nomarkdown}\( j\){:/nomarkdown} בצעד אחד. אני מקווה שהרעיון ברור: לכל {::nomarkdown}\( m\){:/nomarkdown} טבעי, הקוארדינטה ה-{::nomarkdown}\( i,j\){:/nomarkdown}-ית במטריצה {::nomarkdown}\( A^{m}\){:/nomarkdown} מייצגת את מספר המסלולים מאורך {::nomarkdown}\( m\){:/nomarkdown} מ-{::nomarkdown}\( i\){:/nomarkdown} אל {::nomarkdown}\( j\){:/nomarkdown} (אפילו עבור {::nomarkdown}\( m=0\){:/nomarkdown} זה עובד: {::nomarkdown}\( A^{0}\){:/nomarkdown} היא על פי הגדרה המטריצה שבה הכניסה ה-{::nomarkdown}\( i,i\){:/nomarkdown} היא 1 לכל {::nomarkdown}\( i\){:/nomarkdown}, וה-{::nomarkdown}\( i,j\){:/nomarkdown} היא 0 אם {::nomarkdown}\( i\ne j\){:/nomarkdown}, וזה מתאים ל"מסלול מאורך 0" מ-{::nomarkdown}\( i\){:/nomarkdown} לעצמו שפשוט לא מכיל צעדים). מכאן שכדי לענות על שאלה 2 בסך הכל צריך לחשב את {::nomarkdown}\( A^{3}\){:/nomarkdown}. זה חישוב טכני לא מעניין במיוחד ואפשר לתת לתוכנות מחשב דוגמת מטלאב לבצע אותו. מקבלים:

{::nomarkdown}\( A^{3}=\left(\begin{array}{cccc}2 &amp; 7 &amp; 2 &amp; 3\\7 &amp; 2 &amp; 12 &amp; 7\\2 &amp; 12 &amp; 0 &amp; 2\\3 &amp; 7 &amp; 2 &amp; 2\end{array}\right)\){:/nomarkdown}

אם משעמם לכם תוכלו לקחת את אחת מהכניסות (רצוי כזו עם מספר נמוך יחסית בתוכה) ולספור ידנית את המסלולים ולראות ששני המספרים זהים. מה שכן, שימו לב למידע המעניין יחסית שבולט מייד מהמטריצה: לא קיים מסלול באורך 3 שמתחיל ונגמר בצומת 3.

המשחק היה נהיה משעשע בהרבה אם היינו שואלים שאלות מהסגנון הבא: נניח שאנחנו יוצאים לטיול "אקראי" על הגרף, ובכל צעד אנחנו בוחרים באקראי את אחת מהקשתות שמחוברות לצומת הנוכחי שלנו. איך יראה הטיול? באילו צמתים נשהה זמן רב יחסית? וכן הלאה. זו דוגמה לסוג השאלות שניתן לשאול על <a href="http://he.wikipedia.org/wiki/%D7%A9%D7%A8%D7%A9%D7%A8%D7%AA_%D7%9E%D7%A8%D7%A7%D7%95%D7%91">שרשראות מרקוב בדידות</a>, נושא מעניין לכשעצמו; והניתוח של התכונות הללו מתבצע בדיוק באמצעות ניתוח המטריצה {::nomarkdown}\( A\){:/nomarkdown} שלנו, תוך שימוש בכלים של אלגברה לינארית. אלא שזה לא הכיוון שאליו הולכת שאלת וויל האנטינג ולכן לא אמשיך לדבר על כך כרגע.

שתי השאלות הבאות הן בעצם אותו דבר - בשאלה 3 מבקשים משהו כללי, ובשאלה 4 מבקשים מקרה פרטי של המשהו הכללי שיתקבל אחרי הצבה בו. זו גם השאלה הראשונה שנראית מעט מאתגרת, אולי בעיקר כי פונקציות יוצרות הן משהו שלרוב האנשים שכבר יצא להם ללמוד אותו זכור במעומעם בתור "הדבר ההוא מקומבינטוריקה שלא באמת הבנו בשביל מה הוא טוב". העניין הוא שכל מי שיפתח ספר רציני בקומבינטוריקה יגלה בו את הפתרון הכללי לבעיות מסוג זה.

כתבתי בשעתו <a href="http://www.gadial.net/?p=206">פוסט על פונקציות יוצרות</a> ולכן לא אציג אותן כאן שוב. הפוסט ההוא היה מבוא ל<a href="http://www.gadial.net/?p=207">פוסט</a> שעסק באופן שבו מוצאים את הפונקציה היוצרת של שפה רגולרית, בעזרת האוטומט שלה - רעיון כמעט זהה לרעיון שיש כאן. אוטומט הוא סוג של גרף, וחישוב של אוטומט הוא סוג של מסלול בגרף. מכיוון שבפוסט ההוא נתתי הסברים מפורטים, בפוסט הזה ארשה לעצמי בעיקר לנפנף בידיים.

ובכן, מה שמבקשים מאיתנו הוא הצגה מפורשת לפונקציה {::nomarkdown}\( f\left(x\right)=\sum_{n=0}^{\infty}b_{n}x^{n}\){:/nomarkdown} כאשר {::nomarkdown}\( b_{n}\){:/nomarkdown} הוא מספר המסלולים מ-{::nomarkdown}\( i\){:/nomarkdown} אל {::nomarkdown}\( j\){:/nomarkdown} מאורך {::nomarkdown}\( n\){:/nomarkdown}. אם נסמן ב-{::nomarkdown}\( \left[A\right]_{ij}\){:/nomarkdown} את הכניסה ה-{::nomarkdown}\( i,j\){:/nomarkdown} של המטריצה {::nomarkdown}\( i,j\){:/nomarkdown} וננפנף בידיים ממש מהר, נקבל את החישוב הבא: {::nomarkdown}\( \sum_{n=0}^{\infty}b_{n}x^{n}=\sum_{n=0}^{\infty}\left[A^{n}\right]_{ij}x^{n}=\sum_{n=0}^{\infty}\left[\left(Ax\right)^{n}\right]_{ij}=\left[\sum_{n=0}^{\infty}\left(Ax\right)^{n}\right]_{ij}=\left[\frac{1}{1-Ax}\right]_{ij}\){:/nomarkdown}.

מה שעשיתי כאן היה להשתמש בוריאציה על הנוסחה הישנה והטובה לסכום סדרה הנדסית אינסופית מתכנסת: {::nomarkdown}\( 1+x+x^{2}+\dots=\frac{1}{1-x}\){:/nomarkdown}. כמובן שצריך להצדיק את השימוש בה עבור מטריצות, אבל אמרתי שאנפנף בידיים.

כעת השאלה היא האם באופן כללי בהינתן מטריצה {::nomarkdown}\( B\){:/nomarkdown}, יש נוסחה "יפה"עבור הכניסה ה-{::nomarkdown}\( ij\){:/nomarkdown} בהופכית שלה, כלומר {::nomarkdown}\( \left[B^{-1}\right]_{ij}\){:/nomarkdown}? התשובה היא שכן (אם כי "יפה" זה עניין סובייקטיבי כאן) והיא מכונה "כלל קרמר". הכלל מסתמך על שני מושגים לא פשוטים - <a href="http://he.wikipedia.org/wiki/%D7%9E%D7%98%D7%A8%D7%99%D7%A6%D7%94_%D7%9E%D7%A6%D7%95%D7%A8%D7%A4%D7%AA">מטריצה מצורפת</a> (Adjugate) ו<a href="http://he.wikipedia.org/wiki/%D7%93%D7%98%D7%A8%D7%9E%D7%99%D7%A0%D7%A0%D7%98%D7%94">דטרמיננטה</a> של מטריצה, ולכן עבור מי שאינו מכיר את המושגים הללו הנוסחה תיראה פשוט כמו אוסף של סימנים חסרי משמעות - אבל זה לא חשוב כל כך לבינתיים. הנקודה היא ששני היצורים הללו ניתנים לחישוב יחסית באופן פשוט. כעת, כלל קרמר אומר כי {::nomarkdown}\( B^{-1}=\frac{\mbox{Adj}B}{\det B}\){:/nomarkdown} (כאן אנו מחלקים מטריצה - {::nomarkdown}\( \mbox{Adj}B\){:/nomarkdown} - בסקלר - {::nomarkdown}\( \det B\){:/nomarkdown}). לכן {::nomarkdown}\( \left[B^{-1}\right]_{ij}=\frac{\left[AdjB\right]_{ij}}{\det B}\){:/nomarkdown}. אם רוצים לפשט את הביטוי עוד יותר צריך לחפור בהגדרה של {::nomarkdown}\( \mbox{Adj}B\){:/nomarkdown}: הכניסה ה-{::nomarkdown}\( ij\){:/nomarkdown} של {::nomarkdown}\( \mbox{Adj}B\){:/nomarkdown} מוגדרת בתור {::nomarkdown}\( \left(-1\right)^{i+j}M_{ji}\){:/nomarkdown}, כאשר {::nomarkdown}\( M_{ji}\){:/nomarkdown} הוא המינור ה-{::nomarkdown}\( ji\){:/nomarkdown}-י של {::nomarkdown}\( B\){:/nomarkdown} - הדטרמיננטה של המטריצה שמתקבלת ממחיקת השורה ה-{::nomarkdown}\( j\){:/nomarkdown} והעמודה ה-{::nomarkdown}\( i\){:/nomarkdown} של {::nomarkdown}\( B\){:/nomarkdown}. כאן כנראה וויל משתעמם ומשתמש בסימונים שאיני מכיר, כי הנוסחה הסופית שהוא כותב על הלוח היא {::nomarkdown}\( \frac{\det\left(B_{ij}\right)}{\det B}\){:/nomarkdown} - אני משער שכוונתו זהה לכוונה שלי (למעשה, הוא לא כותב {::nomarkdown}\( B\){:/nomarkdown} אלא {::nomarkdown}\( I-Ax\){:/nomarkdown} כמו שכתבתי קודם - ולמעשה, אפילו לא את זה, אלא {::nomarkdown}\( I-zA\){:/nomarkdown}, שכמובן אומר את אותו הדבר בדיוק).

<strong><a href="http://www.gadial.net/wp-content/uploads/2010/02/will-hunting-one1.png"><img class="alignnone size-full wp-image-362" title="Will Hunting Solution" alt="חידת וויל האנטיג - הפתרון" src="http://www.gadial.net/wp-content/uploads/2010/02/will-hunting-one1.png" width="638" height="315" /></a>
</strong>

לסיכום, מדובר בשאלה חביבה והפתרון שלה נאה ביותר בכך שהוא מצביע על הקשר שבין תורת הגרפים ובין האלגברה הלינארית; אבל זו בהחלט לא שאלה שפרופסור למתמטיקה צריך להשתאות מכך שמישהו הצליח לפתור.

בהמשך הסרט מציב הפרופסור שאלה נוספת לתלמידיו, כזו ש"לקח לנו יותר משנתיים לפתור". לרוע המזל, השאלה הזו לא מוצגת בסרט. כל מה שנשאר לנו הוא מה שוויל צועק על כל מה שהפרופסור זורק עליו - "זו בדיחה מזויינת". אם הכל דומה לחידה הזו, אולי הוא לא כל כך מגזים.
