---
id: 3380
title: "צורת ז'ורדן והצורה הרציונלית - התיאוריה"
date: 2016-10-27 14:39:17
layout: post
categories: 
  - אלגברה לינארית
tags: 
  - הצורה הרציונלית
  - משפט הפירוק הפרימרי
  - משפט הפירוק הציקלי
  - צורת ז'ורדן
---
<strong>הקדמה מרגשת</strong>

הפוסט הזה מיועד לסגור את שרשרת הפוסטים שלי על אלגברה לינארית שעוסקים בנושא של צורות קנוניות - וככזה, כמובן שלא יהיה ניתן להבין ממנו כמעט כלום בלי לקרוא את הפוסטים הקודמים או בלי להכיר אלגברה לינארית. בכל זאת, בואו נתחיל עם מבוא ידידותי שמזכיר לנו מה בעצם אנחנו עושים כאן ולמה. אני עדיין מניח שאתם מכירים אלגברה לינארית ברמת המה-זו-מטריצה ומה-זו-טרנספורמציה-לינארית.

הרעיון הבסיסי הוא שיש לנו מרחב וקטורי {::nomarkdown}\( V\){:/nomarkdown} סוף-ממדי שמוגדרת מעליו טרנספורמציה לינארית {::nomarkdown}\( T:V\to V\){:/nomarkdown} ("מעליו", כלומר מהמרחב לעצמו; כל הנושא של צורות קנוניות לא מתעסק בטרנספורמציות בין שני מרחבים שונים) ואנחנו מחפשים ל-{::nomarkdown}\( V\){:/nomarkdown} בסיס שבו המטריצה שמייצגת את {::nomarkdown}\( T\){:/nomarkdown} היא שני דברים: <strong>פשוטה</strong> ו<strong>קנונית</strong>. ל"פשוטה" אין הגדרה פורמלית כל כך - בפוסט הזה נראה שתי גישות שונות לעניין הזה - אבל "קנונית" זה משהו יותר ברור: זה אומר <strong>קיום ויחידות</strong>. מרגע שהחלטנו על סוג מסויים של צורה קנונית (למשל, צורת ז'ורדן), לכל טרנספורמציה {::nomarkdown}\( T\){:/nomarkdown} תהיה <strong>קיימת</strong> מטריצה מייצגת ששייכת לצורה הזו, והמטריצה המייצגת הזו תהיה <strong>יחידה</strong> - לא יהיה לנו חופש בחירה בין כמה מטריצות מייצגות שונות.

הדבר דומה לפירוק היחיד למכפלת ראשוניים שיש למספרים טבעיים: אפשר לכתוב את 30 בתור כל מני מכפלות, למשל {::nomarkdown}\( 30=1\cdot30\){:/nomarkdown} או {::nomarkdown}\( 30=2\cdot15\){:/nomarkdown} או {::nomarkdown}\( 30=15\cdot2\){:/nomarkdown} וכדומה, אבל יש רק דרך אחת לכתוב אותו בתור מכפלה של מספרים שכולם ראשוניים (בפרט, 1 לא משתתף במכפלה כי הוא לא נחשב ראשוני) והראשוניים ממויינים לפי גודלם. כלומר, המכפלה היא {::nomarkdown}\( 30=2\cdot3\cdot5\){:/nomarkdown}. לכל מספר טבעי חיובי קיימת הצגה כזו (עבור 1 אומרים שזו "המכפלה הריקה").

אני מדבר כאן על טרנספורמציות לינאריות, אבל מכיוון שבאלגברה לינארית סוף-ממדית יש קשר הדוק בין טרנספורמציות לינאריות ומטריצות, אפשר לנסח את כל הדיון גם עבור מטריצות. אם {::nomarkdown}\( A,B\){:/nomarkdown} מייצגות את הטרנספורמציה {::nomarkdown}\( T\){:/nomarkdown} בבסיסים שונים אז פירוש הדבר הוא שקיימת מטריצה הפיכה {::nomarkdown}\( P\){:/nomarkdown} כך ש-{::nomarkdown}\( A=P^{-1}BP\){:/nomarkdown} ({::nomarkdown}\( P\){:/nomarkdown} היא מטריצת מעבר בין הבסיסים; הרעיון הוא שבהינתן וקטור בבסיס של {::nomarkdown}\( A\){:/nomarkdown}, {::nomarkdown}\( P\){:/nomarkdown} מעבירה את הוקטור לבסיס של {::nomarkdown}\( B\){:/nomarkdown}, ואז מפעילים את {::nomarkdown}\( B\){:/nomarkdown}, ואז חוזרים עם {::nomarkdown}\( P^{-1}\){:/nomarkdown} לבסיס של {::nomarkdown}\( A\){:/nomarkdown}). על מטריצות {::nomarkdown}\( A,B\){:/nomarkdown} כאלו שקיימת {::nomarkdown}\( P\){:/nomarkdown} הפיכה כך ש-{::nomarkdown}\( A=P^{-1}BP\){:/nomarkdown} אומרים שהן <strong>דומות</strong>. דמיון מטריצות כזה הוא <strong>יחס שקילות</strong> ולכן אפשר לדבר על נציגים קנוניים למחלקות השקילות, וחזרנו שוב לאותו סיפור. מכאן ואילך אני הולך לדבר על מטריצות ועל טרנספורמציות בצורה חופשית לחלוטין, לפי מה שנוח לי באותה שניה.

הדוגמה הבסיסית ביותר לצורה קנונית שרואים באלגברה לינארית היא <strong>מטריצה אלכסונית</strong>. הבעיה כאן היא שלא כל מטריצה דומה למטריצה אלכסונית - אנחנו מצמצמים מראש את הדיון ל<strong>מטריצות לכסינות</strong>. מה שברור מייד הוא שאם טרנספורמציה מיוצגת על ידי מטריצה אלכסונית, אז מה שנמצא על האלכסון של המטריצה ההיא הם <strong>הערכים העצמיים</strong> של הטרנספורמציה. כלומר, כל הסקלרים {::nomarkdown}\( \lambda\){:/nomarkdown} כך שקיים וקטור {::nomarkdown}\( v\ne0\){:/nomarkdown} עבורו {::nomarkdown}\( Tv=\lambda v\){:/nomarkdown}. האבחנה הזו היא גם מה שהנחה את האופן שבו בודקים אם מטריצה היא לכסינה - מוצאים את הערכים העצמיים שלה, שהם השורשים של פולינום מסויים שנקרא <strong>הפולינום האופייני</strong> של המטריצה, ואז בודקים אם יש "מספיק" וקטורים עצמיים עבור הערכים העצמיים הללו - אם אנחנו מוצאים בסיס למרחב כולו שמורכב מוקטורים עצמיים. אם יש, גמרנו. אם אין, אפשר לשכוח מכך שהמטריצה תהיה דומה למטריצה אלכסונית.

ה"פתרון" לבעיה של "אין מספיק וקטורים עצמיים" הוא צורת ז'ורדן. צורת ז'ורדן היא מטריצה "כמעט-אלכסונית" - הערכים העצמיים עדיין יושבים על האלכסון הראשי, אבל באלכסון שמעליו יכולים להופיע פה ושם 1-ים. אם להיות יותר מדויקים, צורת ז'ורדן היא מטריצה <strong>בלוקים</strong>, כשכל בלוק הוא תת-מטריצה בעצמו שאנחנו "שותלים" על האלכסון הראשי. בלוק ז'ורדן שכזה בנוי ממטריצה סקלרית (כלומר, כזו שיש על האלכסון הראשי שלה ערך קבוע יחיד) ו-1-ים בכל האלכסון שמעל האלכסון הראשי. משהו כזה:

{::nomarkdown}\( \left(\begin{array}{ccc}\lambda &amp; 1 &amp; 0\\0 &amp; \lambda &amp; 1\\0 &amp; 0 &amp; \lambda\end{array}\right)\){:/nomarkdown}

זו דוגמה לבלוק ז'ורדן מגודל 3. על מטריצה אלכסונית אפשר לחשוב כאילו היא מורכבת כולה מבלוקי ז'ורדן מגודל 1, כך שצורת ז'ורדן מכלילה את הלכסון הרגיל. אם כן, האם הגענו אל המנוחה ואל הנחלה? כמעט. בשביל שלמטריצה כלשהי תהיה צורת ז'ורדן, צריך שכל הערכים העצמיים שלה <strong>יהיו בשדה שמעליו עובדים</strong>. מה זה אומר? קחו את הפולינום {::nomarkdown}\( x^{2}+1\){:/nomarkdown} בתור דוגמה. השורשים של הפולינום הזה הם מספרים מדומים: {::nomarkdown}\( i\){:/nomarkdown} ו-{::nomarkdown}\( -i\){:/nomarkdown}. הם שייכים לשדה {::nomarkdown}\( \mathbb{C}\){:/nomarkdown} אבל לא לשדה {::nomarkdown}\( \mathbb{R}\){:/nomarkdown}. זה אומר שאם יש מטריצה שהפולינום האופייני שלה הוא {::nomarkdown}\( x^{2}+1\){:/nomarkdown}, היא תהיה לכסינה מעל {::nomarkdown}\( \mathbb{C}\){:/nomarkdown} אבל לא מעל {::nomarkdown}\( \mathbb{R}\){:/nomarkdown}. למה? כי ה-{::nomarkdown}\( P\){:/nomarkdown} המלכסנת תהיה חייבת להיות עם מקדמים שהם לא ממשיים (או באופן שקול, הבסיס שבו הטרנספורמציה הרלוונטית תיוצג על ידי מטריצה אלכסונית יהיה עם וקטורים שהכניסות שלהם לא כולן ממשיות).

זה מביא אותנו אל <strong>הצורה הרציונלית</strong> שחומקת גם מהבעיה הזו. כל מטריצה דומה למטריצה בצורה הרציונלית. בלי תלות בשאלות כמו לכסינה/לא לכסינה. בלי תלות בשאלות כמו האם כל השורשים בשדה או לא. תמיד. המחיר שאנחנו משלמים? זו לא צורה עד כדי כך פשוטה; היא בוודאי פחות אינפורמטיבית מאשר צורת ז'ורדן.

בואו נטפל קודם כל בצורה הרציונלית, ואז בצורת ז'ורדן.

<strong>הצורה הרציונלית</strong>

מטריצה בצורה הרציונלית היא גם כן מטריצת בלוקים, כאשר כל בלוק הוא <strong>מטריצה מלווה</strong> של פולינום מסויים. מה זו מטריצה מלווה? בהינתן פולינום מתוקן {::nomarkdown}\( x^{d}+a_{d-1}x^{d-1}+\dots+a_{1}x+a_{0}\){:/nomarkdown}, המטריצה המלווה שלו היא המטריצה

{::nomarkdown}\( \left(\begin{array}{ccccc}0 &amp; 0 &amp; 0 &amp; \cdots &amp; -a_{0}\\1 &amp; 0 &amp; 0 &amp; \cdots &amp; -a_{1}\\0 &amp; 1 &amp; 0 &amp; \cdots &amp; -a_{2}\\\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots\\0 &amp; 0 &amp; 0 &amp; \cdots &amp; -a_{d-1}\end{array}\right)\){:/nomarkdown}

כלומר, מטריצה שכולה אפסים למעט האלכסון <strong>מתחת</strong> לאלכסון הראשי שכולו 1-ים, ולמעט הטור האחרון במטריצה שכולל את המקדמים של הפולינום, עם סימן מינוס עליהם. זה... זה לא נראה נחמד במיוחד, אני יודע. בטח נראה פחות נחמד מצורת ז'ורדן. עדיין, אני מקווה שנתיידד קצת עם היצור המוזר הזה בקרוב, אחרי שנבין מאיפה הצורה ה"מוזרה" שלו מגיעה.

מכיוון שכל בלוק שהוא מטריצה מלווה של פולינום נקבע באופן יחיד על פי הפולינום הזה, מה שמאפיין את הצורה הרציונלית הוא סדרת הפולינומים שמכתיבה את סדרת הבלוקים. כלומר, יש לנו סדרת פולינומים {::nomarkdown}\( p_{1},p_{2},\dots,p_{k}\){:/nomarkdown} שמגדירה באופן יחיד את מטריצת הבלוקים הרלוונטית. הדרישה שלנו מהצורה הרציונלית היא שבסדרת הפולינומים הזו, כל פולינום יחלק את קודמו. כלומר, {::nomarkdown}\( p_{i+1}\){:/nomarkdown} מחלק את {::nomarkdown}\( p_{i}\){:/nomarkdown} לכל {::nomarkdown}\( 1\le i&lt;k\){:/nomarkdown}.

אחדד את זה על ידי כך שאצטט במפורש את המשפט הרלוונטי: לכל מטריצה ריבועית {::nomarkdown}\( A\){:/nomarkdown}, מעל כל שדה, קיימת מטריצה יחידה {::nomarkdown}\( B\){:/nomarkdown} כך ש-{::nomarkdown}\( B=P^{-1}AP\){:/nomarkdown} עבור {::nomarkdown}\( P\){:/nomarkdown} הפיכה כלשהי, ו-{::nomarkdown}\( B\){:/nomarkdown} היא בצורה רציונלית, דהיינו היא מטריצת בלוקים שבה הבלוקים הם מטריצות מלווות של סדרת פולינומים {::nomarkdown}\( p_{1},p_{2},\dots,p_{k}\){:/nomarkdown} שבה כל פולינום מחלק את קודמו:

{::nomarkdown}\( B=\left(\begin{array}{cccc}B_{1}\\ &amp; B_{2}\\ &amp; &amp; \ddots\\ &amp; &amp; &amp; B_{k}\end{array}\right)\){:/nomarkdown}

כך ש-{::nomarkdown}\( B_{i}\){:/nomarkdown} היא המטריצה המלווה של הפולינום {::nomarkdown}\( p_{i}\){:/nomarkdown}.

אני רוצה לחדד עוד קצת את המשמעות של ה<strong>יחידה</strong> הזה: זה אומר שאם קיימת מטריצה {::nomarkdown}\( C\){:/nomarkdown} כך ש-{::nomarkdown}\( C=Q^{-1}AQ\){:/nomarkdown} עבור {::nomarkdown}\( Q\){:/nomarkdown} הפיכה כלשהי, ו-{::nomarkdown}\( C\){:/nomarkdown} היא בצורה רציונלית עם סדרת הפולינומים {::nomarkdown}\( q_{1},\dots,q_{t}\){:/nomarkdown} אז {::nomarkdown}\( t=k\){:/nomarkdown} ו-{::nomarkdown}\( q_{i}=p_{i}\){:/nomarkdown} לכל {::nomarkdown}\( 1\le i\le k\){:/nomarkdown}.

יפה. עכשיו כשאנחנו מבינים מה זה אומר, בואו נבין איך מגיעים לזה. ראשית כל נבין מה הקטע הזה עם מטריצות בלוקים. הצורה הרציונלית זו מטריצת בלוקים. גם צורת ז'ורדן זו מטריצת בלוקים. בלוקים בלוקים בלוקים. למה זה? ובכן, זו תוצאה ישירה של כך שאנחנו מחלקים את המרחב הוקטור {::nomarkdown}\( V\){:/nomarkdown} שלנו לתתי-מרחבים <strong>אינווריאנטיים</strong> ביחס לטרנספורמציה {::nomarkdown}\( T\){:/nomarkdown} שאנחנו מוצאים לה את הצורה הקנונית. תת-מרחב {::nomarkdown}\( W\subseteq V\){:/nomarkdown} הוא אינוריאנטי ביחס ל-{::nomarkdown}\( T\){:/nomarkdown} אם {::nomarkdown}\( T\left(W\right)\subseteq W\){:/nomarkdown}. כלומר, אם מפעילים את {::nomarkdown}\( T\){:/nomarkdown} על משהו ב-{::nomarkdown}\( W\){:/nomarkdown} מקבלים משהו ב-{::nomarkdown}\( W\){:/nomarkdown}. עכשיו, אם {::nomarkdown}\( V=W_{1}\oplus W_{2}\oplus\dots\oplus W_{k}\){:/nomarkdown} כאשר כל ה-{::nomarkdown}\( W\){:/nomarkdown}-ים הם אינוריאנטיים ביחס ל-{::nomarkdown}\( T\){:/nomarkdown}, אז אפשר לקחת בסיס לכל אחד מה-{::nomarkdown}\( W\){:/nomarkdown}-ים בנפרד ואז איחוד כל הבסיסים הללו יהיה בסיס ל-{::nomarkdown}\( V\){:/nomarkdown} (כאן חשוב שהסכום יהיה סכום ישר אחרת לאו דווקא נקבל בסיס). בבסיס הזה המטריצה המייצגת של {::nomarkdown}\( T\){:/nomarkdown} תהיה מטריצת בלוקים כאשר כל בלוק מתאים לאחד מתתי-המרחבים {::nomarkdown}\( W\){:/nomarkdown}. למה? כי בואו נזכור מה זו מטריצה מייצגת: אם הבסיס שלנו הוא {::nomarkdown}\( B=\left\{ b_{1},\dots,b_{n}\right\} \){:/nomarkdown} אז העמודה ה-{::nomarkdown}\( i\){:/nomarkdown} בה היא וקטור הקואורדינטות של {::nomarkdown}\( T\left(b_{i}\right)\){:/nomarkdown} על פי הבסיס {::nomarkdown}\( B\){:/nomarkdown}. כעת, אצלנו כל איבר בסיס {::nomarkdown}\( b_{i}\){:/nomarkdown} שכזה שייך לאחד מה-{::nomarkdown}\( W\){:/nomarkdown}-ים, ולכן הקואורדינטות היחידות שאולי לא יהיו 0 ב-{::nomarkdown}\( T\left(b_{i}\right)\){:/nomarkdown} יהיו שייכות לאברי הבסיס של אותו {::nomarkdown}\( W\){:/nomarkdown}. למשל, אם {::nomarkdown}\( W\){:/nomarkdown} הראשון נפרש על ידי {::nomarkdown}\( b_{1},b_{2},b_{3},b_{4}\){:/nomarkdown}, אז {::nomarkdown}\( T\left(b_{1}\right)\){:/nomarkdown} יתן לנו עמודה שהיא כולה אפסים חוץ אולי מ-4 הכניסות הראשונות, וכך גם {::nomarkdown}\( T\left(b_{2}\right),T\left(b_{3}\right),T\left(b_{4}\right)\){:/nomarkdown}. קיבלנו שבארבע העמודות הראשונות הכל יהיה אפסים חוץ אולי מהבלוק מגודל 4 שיושב על האלכסון הראשי. וכך זה נמשך.

אם כן, זה הרעיון הן בצורה הרציונלית והן בצורת ז'ורדן - מחלקים איכשהו את {::nomarkdown}\( V\){:/nomarkdown} לתתי-מרחבים אינוריאנטיים, שכאשר <strong>מצמצמים</strong> את {::nomarkdown}\( T\){:/nomarkdown} אליהם, המטריצה המייצגת שלה יוצאת פשוטה יחסית - בלוק ז'ורדן במקרה של צורת ז'ורדן, ומטריצה מלווה במקרה של הצורה הרציונלית. ההבדל בין שתי הצורות הוא באופן שבו מחלקים את המרחב. בסדרת הפוסטים שלי על אלגברה לינארית הראיתי שני משפטים שמפרקים את {::nomarkdown}\( V\){:/nomarkdown} לסכום ישר של תתי-מרחבים אינוריאנטיים "מעניינים": <a href="http://www.gadial.net/2012/01/09/primary_decomposition_theorem/">משפט הפירוק הפרימרי </a>ו<a href="http://www.gadial.net/2016/09/29/cyclic_decomposition_theorem/">משפט הפירוק הציקלי</a>. הצורה הרציונלית היא מה שמתקבל כמעט מייד ממשפט הפירוק הציקלי; כפי שתכף נראה, הצורה הרציונלית היא פשוט דרך אחרת לנסח את משפט הפירוק הציקלי. צורת ז'ורדן מתקבלת מהפירוק הפרימרי, כשאחריו מטפלים בכל תת-מרחב לחוד ומפעילים על אותו תת מרחב את משפט הפירוק הציקלי, אבל עבור טרנספורמציה לינארית אחרת. כלומר, זה שילוב לא לגמרי טריוויאלי של משפטי הפירוק הפרימרי והציקלי, ולכן זה נחמד במיוחד.

נתחיל עם הצורה הרציונלית. מה שצריך לזכור הוא מה הולך במשפט הפירוק הציקלי. אני לא אניח שאתם הולכים לקרוא את הפוסט המפלצתי בנושא, אז בואו נזכיר את זה בקצרה: המשפט אומר שבהינתן {::nomarkdown}\( V\){:/nomarkdown} ובהינתן טרנספורמציה לינארית {::nomarkdown}\( T\){:/nomarkdown} קיים למרחב פירוק {::nomarkdown}\( V=W_{1}\oplus\dots\oplus W_{k}\){:/nomarkdown} שבו כל ה-{::nomarkdown}\( W\){:/nomarkdown}-ים הם מרחבים {::nomarkdown}\( T\){:/nomarkdown}-ציקליים. מה זה מרחב {::nomarkdown}\( T\){:/nomarkdown}-ציקלי? מרחב שמורכב בדיוק מכל הוקטורים שמתקבלים מוקטור מסויים {::nomarkdown}\( w\){:/nomarkdown} ("היוצר") על ידי הפעלות חוזרות ונשנות של {::nomarkdown}\( T\){:/nomarkdown}. כתבתי את זה במקור בתור {::nomarkdown}\( Z\left(w;T\right)\triangleq\mbox{span}\left\{ T^{0}\left(w\right),T^{1}\left(w\right),T^{2}\left(w\right),\dots\right\} \){:/nomarkdown} ומהר מאוד התברר שהמרחב הזה שווה בדיוק לקבוצה {::nomarkdown}\( \left\{ fw\ \|\ f\in\mathbb{F}\left[x\right]\right\} \){:/nomarkdown} כאשר {::nomarkdown}\( fw\){:/nomarkdown} זה סימון מקוצר ל{::nomarkdown}\( f\left(T\right)\left(w\right)\){:/nomarkdown}, כלומר ללקיחת פולינום כלשהו {::nomarkdown}\( f\){:/nomarkdown}, הצבת {::nomarkdown}\( T\){:/nomarkdown} בתוך הפולינום וקבלת טרנספורמציה לינארית, ואז הפעלה שלה על {::nomarkdown}\( w\){:/nomarkdown}.

מה שנחמד במרחבים הללו הוא שהבסיס שלהם הוא פשוט במיוחד ביחס ל-{::nomarkdown}\( T\){:/nomarkdown}: הוא בסך הכל מהצורה {::nomarkdown}\( \left\{ T^{0}\left(w\right),T^{1}\left(w\right),\dots,T^{n-1}\left(w\right)\right\} \){:/nomarkdown}. מהו {::nomarkdown}\( n\){:/nomarkdown}? ובכן, בואו נזכור שקיימים פולינומים שמתאפסים כאשר מציבים בהם את {::nomarkdown}\( T\){:/nomarkdown}, ולפולינום המתוקן מהמעלה החיובית הקטנה ביותר שמאפס את {::nomarkdown}\( T\){:/nomarkdown} קוראים <strong>הפולינום המינימלי</strong> של {::nomarkdown}\( T\){:/nomarkdown}. אם נסמן אותו ב-{::nomarkdown}\( m_{T}\){:/nomarkdown}, אז אנחנו יודעים ש-{::nomarkdown}\( m_{T}w=0\){:/nomarkdown}. זה מראה שקיים פולינום <strong>כלשהו</strong> שמאפס את {::nomarkdown}\( w\){:/nomarkdown}, אבל ייתכן שיש כאלו שקטנים אפילו יותר מ-{::nomarkdown}\( m_{T}\){:/nomarkdown}. את הפולינום המתוקן המינימלי <strong>מביניהם</strong> אסמן ב-{::nomarkdown}\( p\){:/nomarkdown} ואקרא לו <strong>המאפס</strong> של {::nomarkdown}\( w\){:/nomarkdown}. כעת, {::nomarkdown}\( n\){:/nomarkdown} היא בסך הכל הדרגה של {::nomarkdown}\( p\){:/nomarkdown}. בואו נכתוב את {::nomarkdown}\( p\){:/nomarkdown} באופן מפורש:

{::nomarkdown}\( p\left(x\right)=x^{n}+a_{n-1}x^{n-1}+\dots+a_{1}x+a_{0}\){:/nomarkdown}

כאן המקדם של {::nomarkdown}\( x^{n}\){:/nomarkdown} הוא 1 כי אמרנו ש-{::nomarkdown}\( p\){:/nomarkdown} הוא פולינום מתוקן. על שאר המקדמים אני לא מניח כלום. כעת, אם נציב בפולינום הזה את {::nomarkdown}\( T\){:/nomarkdown} ונפעיל את כל זה על {::nomarkdown}\( w\){:/nomarkdown}, נקבל:

{::nomarkdown}\( \left(T^{n}+a_{n-1}T^{n-1}+\dots+a_{1}T+a_{0}\right)w=0\){:/nomarkdown}

ואחרי העברת אגפים נקבל

{::nomarkdown}\( T^{n}w=-a_{n-1}T^{n-1}w-\dots-a_{1}Tw-a_{0}w\){:/nomarkdown}

זה מסביר למה לא "צריך" את הוקטור {::nomarkdown}\( T^{n}w\){:/nomarkdown} או חזקות נוספות של {::nomarkdown}\( T\){:/nomarkdown} בבסיס עבור {::nomarkdown}\( W\){:/nomarkdown}: אנחנו מתחילים לקבל צירופים לינאריים של וקטורים שכבר יש לנו. אבל המשוואה שלמעלה מעניינת לא רק בגלל זה; אתם כבר רואים איך מקבלים מפה את המבנה המוזר של המטריצה המלווה?

בואו נסמן את הבסיס {::nomarkdown}\( \left\{ T^{0}\left(w\right),T^{1}\left(w\right),\dots,T^{n-1}\left(w\right)\right\} \){:/nomarkdown} בתור {::nomarkdown}\( \mathcal{B}=\left\{ b_{0},b_{1},\dots,b_{n-1}\right\} \){:/nomarkdown}. כלומר, {::nomarkdown}\( b_{i}=T^{i}\left(w\right)\){:/nomarkdown}. כדי לדעת איך נראית המטריצה המייצגת של {::nomarkdown}\( T\){:/nomarkdown} בבסיס {::nomarkdown}\( \mathcal{B}\){:/nomarkdown} אנחנו צריכים להפעיל את {::nomarkdown}\( T\){:/nomarkdown} על כל איבר בסיס ולראות את וקטור הקואורדינטות המתקבל. עבור רובם זה קל: {::nomarkdown}\( T\left(b_{0}\right)=T\left(T^{0}\left(w\right)\right)=T^{1}\left(w\right)=b_{1}\){:/nomarkdown}, ובאופן דומה {::nomarkdown}\( T\left(b_{1}\right)=b_{2}\){:/nomarkdown} וכן הלאה. זה אומר שוקטור העמודה שמתאים לעמודה של {::nomarkdown}\( b_{i}\){:/nomarkdown} יכיל 1 בודד, בשורה ה-{::nomarkdown}\( i+1\){:/nomarkdown} - כלומר, בדיוק מתחת לאלכסון הראשי. כל זה נכון עד לעמודה האחרונה, כלומר עד ל-{::nomarkdown}\( T\left(b_{n}\right)\){:/nomarkdown}. כאן אנחנו משתמשים במשוואה שכתבתי למעלה ומקבלים

{::nomarkdown}\( T\left(b_{n}\right)=-a_{n-1}b_{n-1}-\dots-a_{1}b_{1}-a_{0}b_{0}\){:/nomarkdown}

וזה נותן לנו בדיוק את העמודה הימנית ביותר של המטריצה המלווה של {::nomarkdown}\( p\){:/nomarkdown}. קיבלנו, אם כן, שהמטריצה המייצגת של {::nomarkdown}\( T\){:/nomarkdown} (כאשר {::nomarkdown}\( T\){:/nomarkdown} מצומצמת ל-{::nomarkdown}\( W\){:/nomarkdown}) בבסיס {::nomarkdown}\( \mathcal{B}\){:/nomarkdown} היא בדיוק המטריצה המלווה של {::nomarkdown}\( p\){:/nomarkdown}, כאשר {::nomarkdown}\( p\){:/nomarkdown} הוא המאפס של {::nomarkdown}\( w\){:/nomarkdown}, שהוא היוצר של {::nomarkdown}\( W\){:/nomarkdown}.

החתיכה האחרונה בפאזל הזה הוא הדבר הנוסף שמשפט הפירוק הציקלי נותן לנו: הוא אומר שאם {::nomarkdown}\( V=W_{1}\oplus\dots\oplus W_{k}\){:/nomarkdown} כאשר {::nomarkdown}\( W_{i}=Z\left(w_{i};T\right)\){:/nomarkdown} , ואם נסמן את המאפס של {::nomarkdown}\( w_{i}\){:/nomarkdown} ב-{::nomarkdown}\( p_{i}\){:/nomarkdown}, אז המאפסים הללו מקיימים את יחס החלוקה שבו כל מאפס מחלק את קודמו: {::nomarkdown}\( p_{i+1}\){:/nomarkdown} מחלק את {::nomarkdown}\( p_{i}\){:/nomarkdown}, והוא אומר שסדרת הפולינומים הללו היא <strong>יחידה</strong>. שימו לב: הוא לא אומר "יש פירוק יחיד לתת-מרחבים ציקליים" כי זה לא נכון; כל מה שהוא אומר הוא שסדרת המאפסים שלהם, עם תנאי החלוקה הזה, היא יחידה. זה בדיוק מה שהיה חסר לנו. סדרת הפולינומים {::nomarkdown}\( p_{1},\dots,p_{k}\){:/nomarkdown} הזו מגדירה לנו את הצורה הרציונלית בצורה מלאה. הצורה הרציונלית הרי לא תלויה ב-{::nomarkdown}\( w\){:/nomarkdown}-ים או אפילו ב-{::nomarkdown}\( W\){:/nomarkdown}-ים; מה שקובע את המטריצה בסופו של דבר הוא רק סדרת הפולינומים (וכן, יכולים להיות בסיסים שונים שבכולם {::nomarkdown}\( T\){:/nomarkdown} מיוצגת על ידי אותה מטריצה שהיא בצורה רציונלית, אין עם זה בעיה).

הפולינומים {::nomarkdown}\( p_{1},\dots,p_{k}\){:/nomarkdown} הללו נקראים <strong>הגורמים האינוריאנטיים</strong> של {::nomarkdown}\( T\){:/nomarkdown}. כעת, משראינו שהם תמיד קיימים, נשאלת השאלה הפשוטה - בהינתן מטריצה {::nomarkdown}\( A\){:/nomarkdown}, איך מוצאים את הגורמים האינוריאנטיים שלה? למשפט הפירוק הציקלי אין הוכחה קונסטרוקטיבית במיוחד - שלב מרכזי שם הוא "ניקח וקטור שממקסם כך וכך ונעשה איתו ניסים ונפלאות" בלי ממש להסביר איך מוצאים את הוקטור הזה. האם יש אלגוריתם פשוט יחסית למציאת הגורמים האינוריאנטיים? באופן מפתיע (עבורי) יש כזה, והוא מאוד דומה לדירוג מטריצות. רק שבמקום לדרג את {::nomarkdown}\( A\){:/nomarkdown} מדרגים את המטריצה {::nomarkdown}\( xI-A\){:/nomarkdown} (שהיא מטריצה שחיה מעל החוג {::nomarkdown}\( \mathbb{F}\left[x\right]\){:/nomarkdown} ולא מעל השדה {::nomarkdown}\( \mathbb{F}\){:/nomarkdown}), ופעולות הדירוג שלנו הן:
<ol>
	<li>החלפת שתי שורות או עמודות.</li>
	<li>הוספה לשורה אחת של שורה אחת שמוכפלת בסקלר מתוך {::nomarkdown}\( \mathbb{F}\left[x\right]\){:/nomarkdown} (דהיינו, מוכפלת בפולינום כלשהו מעל {::nomarkdown}\( \mathbb{F}\){:/nomarkdown}), ואותו הדבר עם עמודות.</li>
	<li>הכפלה של שורה או עמודה אחת ב<strong>איבר הפיך</strong> מתוך {::nomarkdown}\( \mathbb{F}\left[x\right]\){:/nomarkdown}, כלומר באיבר של {::nomarkdown}\( \mathbb{F}\){:/nomarkdown}.</li>
</ol>
אלמלא התנאי המעט שונה ב-3 והעובדה שאפשר לפעול גם על עמודות, זה היה בדיוק דירוג מטריצות כמו שרואים כשרק מתחילים להתעסק עם אלגברה לינארית. אבל מה היעד שלו? בדירוג מטריצות "רגיל" היעד הוא להגיע למטריצה שבה כל הכניסות הן 0 למעט כניסות שהן 1 ש"אי אפשר לוותר עליהן", ובמקרה שבו {::nomarkdown}\( A\){:/nomarkdown} הפיכה נקבל שיש 1-ים בדיוק על האלכסון הראשי. במקרה שלנו מובטח שנוכל לאפס את כל מה שאינו על האלכסון הראשי, אבל על האלכסון הראשי עשויים להישאר פולינומים, ועל ידי החלפות מתאימות אפשר להביא את המטריצה לצורה הבאה:

{::nomarkdown}\( \left(\begin{array}{ccccccc}1\\ &amp; \ddots\\ &amp; &amp; 1\\ &amp; &amp; &amp; a_{1}\left(x\right)\\ &amp; &amp; &amp; &amp; a_{2}\left(x\right)\\ &amp; &amp; &amp; &amp; &amp; \ddots\\ &amp; &amp; &amp; &amp; &amp; &amp; a_{k}\left(x\right)\end{array}\right)\){:/nomarkdown}

כאשר הפולינומים {::nomarkdown}\( a\left(x\right)\){:/nomarkdown} על האלכסון מקיימים את יחסי החלוקה שלנו (כל אחד מחלק את קודמו). הצורה הזו נקראת <strong>הצורה הנורמלית של סמית</strong> (לפעמים מגדירים הפוך, שכל פולינום מחלק את הבא אחריו, אבל מה זה משנה). להוכיח שכל זה באמת עובד? זה עניין לפוסט נפרד.

והנה הערה מעניינת לסיום, שתהיה מעניינת עוד יותר עוד רגע, כשנגיע לצורת ז'ורדן: הגורמים האינוריאנטים הם לא סתם פולינומים אקראיים. הם קשורים בקשר הדוק מאוד לפולינומים המינימלי והאופייני של {::nomarkdown}\( T\){:/nomarkdown}. ליתר דיוק: {::nomarkdown}\( p_{1}\){:/nomarkdown} (הגורם האינוריאנטי הראשון, הגדול ביותר, זה שמתחלק על ידי היתר) הוא בדיוק הפולינום המינימלי, ואילו המכפלה {::nomarkdown}\( p_{1}\cdots p_{k}\){:/nomarkdown} היא בדיוק הפולינום האופייני של {::nomarkdown}\( T\){:/nomarkdown}. למה? ובכן, זה לא טריוויאלי. את זה ש-{::nomarkdown}\( p_{1}\){:/nomarkdown} הוא הפולינום המינימלי של {::nomarkdown}\( T\){:/nomarkdown} הראיתי במובלע בהוכחת שלב ה"יחידות" של משפט הפירוק הציקלי; הרעיון הוא שאם {::nomarkdown}\( V\){:/nomarkdown} הוא סכום ישר של מרחבים ציקליים, והמאפסים של <strong>כל</strong> המרחבים הציקליים הללו מחלקים את {::nomarkdown}\( p_{1}\){:/nomarkdown}, אז הפעלת {::nomarkdown}\( p_{1}\){:/nomarkdown} על איבר כלשהו של המרחב מאפסת את כל הרכיבים שלו ולכן מאפסת אותו. לכן הפולינום המינימלי מחלק את המאפס {::nomarkdown}\( p_{1}\){:/nomarkdown}. מצד שני, המאפסים תמיד מחלקים את הפולינום המינימלי.

דרך פשוטה לראות שמכפלת כל הגורמים האינוריאנטיים היא הפולינום האופייני היא לזכור שהפולינום האופייני הוא הדטרמיננטה, מעל {::nomarkdown}\( \mathbb{F}\left[x\right]\){:/nomarkdown}, של המטריצה {::nomarkdown}\( xI-A\){:/nomarkdown}, ולזכור שדטרמיננטה <strong>לא משתנה</strong> על ידי פעולות אלמנטריות, פרט לכך שכפל בסקלר כלשהו של שורה כופל גם את הדטרמיננטה בסקלר הזה (זאת להבדיל מהוספה של כפולה בסקלר של שורה לשורה אחרת, ש<strong>אינה</strong> משנה את הדטרמיננטה). אצלנו, התנאי לכפל בסקלר הוא שהסקלר יהיה שייך ל-{::nomarkdown}\( \mathbb{F}\){:/nomarkdown}, כלומר הפיך; כלומר, הפולינום שהוא הדטרמיננטה שנקבל בסופו של דבר יהיה זהה לפולינום האופייני עד כדי כפל באיבר של {::nomarkdown}\( \mathbb{F}\){:/nomarkdown}; אבל הפולינום האופייני הוא מתוקן, וגם הדטרמיננטה של צורת סמית היא פולינום מתוקן (מכפלה של פולינומים מתוקנים) כך שהם יהיו שווים.

עכשיו אפשר לעבור אל צורת ז'ורדן סוף סוף.

<strong>צורת ז'ורדן</strong>

הנה דרך ציורית לחשוב על ההבדל בין הצורה הרציונלית וצורת ז'ורדן של {::nomarkdown}\( T\){:/nomarkdown}: בצורה הרציונלית, אנחנו לוקחים את הפולינום המינימלי של {::nomarkdown}\( T\){:/nomarkdown} ומתחילים לקחת סדרת מחלקים שלו - <strong>הגורמים האינוריאנטיים</strong> שלו. בצורת ז'ורדן, אנחנו לוקחים את אותו פולינום מינימלי ו<strong>מפרקים אותו לגורמים אי פריקים</strong> - זה נקרא "<strong>המחלקים האלמנטריים</strong>" שלו. חלוקה כזו לגורמים אי-פריקים היא מה שמשפט הפירוק הפרימרי עושה; הרעיון בצורת ז'ורדן הוא לקחת את התוצאה של משפט הפירוק הפרימרי ולהראות שבמקרה שבו הפולינום התפרק לגורמים לינאריים, אפשר לתת ניתוח יפה של כל גורם כזה בנפרד.

בואו ניזכר מה אומר משפט הפירוק הפרימרי. ניקח את הפולינום המינימלי {::nomarkdown}\( m_{T}\){:/nomarkdown} של {::nomarkdown}\( T\){:/nomarkdown}, ונפרק אותו לגורמים אי-פריקים (כלומר, למכפלה של פולינומים שהם בעצמם לא מכפלות של פולינומים ששניהם ממעלה גדולה מ-0). נסמן את זה {::nomarkdown}\( m_{T}=p_{1}^{r_{1}}\cdots p_{k}^{r_{k}}\){:/nomarkdown}. אז אפשר לפרק את {::nomarkdown}\( V\){:/nomarkdown} לסכום ישר של תתי-מרחבים {::nomarkdown}\( T\){:/nomarkdown}-אינוריאנטיים {::nomarkdown}\( V=W_{1}\oplus\dots\oplus W_{k}\){:/nomarkdown} שמוגדרים כך: {::nomarkdown}\( W_{i}=\ker\left(p_{i}^{r_{i}}\left(T\right)\right)\){:/nomarkdown}.

הדיון הזה הוא קצת באוויר מבחינתנו אז בואו נרד לקרקע ונדבר על מה קורה במקרה שמתאים לצורת ז'ורדן, כלומר שבו {::nomarkdown}\( m_{T}\){:/nomarkdown} מתפרק לגורמים לינאריים: במקרה הזה אפשר לכתוב {::nomarkdown}\( m_{T}=\left(x-\lambda_{1}\right)^{r_{1}}\cdots\left(x-\lambda_{k}\right)^{r_{k}}\){:/nomarkdown} כאשר {::nomarkdown}\( \lambda_{1},\dots,\lambda_{k}\){:/nomarkdown} הם השורשים של הפולינום המינימלי. במקרה הזה, המרחב {::nomarkdown}\( W_{i}\){:/nomarkdown} הוא בדיוק {::nomarkdown}\( \ker\left(\left(T-\lambda_{i}I\right)^{r_{i}}\right)\){:/nomarkdown}. מה שנותר לנו להבין, אם כן, הוא איך נראית המטריצה המייצגת של {::nomarkdown}\( T\){:/nomarkdown} כשהיא מצומצמת לתת-מרחב מהצורה {::nomarkdown}\( W=\ker\left(\left(T-\lambda I\right)^{r}\right)\){:/nomarkdown}. מה שנראה הוא שהמטריצה הזו תהיה מטריצת בלוקים, שכולם בלוקי ז'ורדן שמתאימים לערך העצמי {::nomarkdown}\( \lambda\){:/nomarkdown}. כלומר, יש לנו עכשיו הרבה פחות עבודה - במקום להבין את {::nomarkdown}\( T\){:/nomarkdown} באופן כללי, מספיק להבין אותה על תת-מרחב שבו היא תהיה פשוטה יחסית. מכאן ואילך אני אמשיך לדבר על {::nomarkdown}\( T\){:/nomarkdown}, אבל מה שאני אתכוון אליו בתכל'ס יהיה {::nomarkdown}\( T\|_{W}\){:/nomarkdown}, כלומר {::nomarkdown}\( T\){:/nomarkdown} שמצומצמת לתת-המרחב {::nomarkdown}\( W\){:/nomarkdown}.

הפאנץ' המרכזי כאן הוא שעל תת-המרחב {::nomarkdown}\( W\){:/nomarkdown}, {::nomarkdown}\( T\){:/nomarkdown} היא סכום של שתי טרנספורמציות לינאריות פשוטות במיוחד: אחת שהיא <strong>סקלרית</strong> ואחת שהיא <strong>נילפוטנטית</strong>. אני יכול לכתוב {::nomarkdown}\( T=D+N\){:/nomarkdown} כאשר {::nomarkdown}\( D\){:/nomarkdown} היא הטרנספורמציה {::nomarkdown}\( D=\lambda I\){:/nomarkdown} שפשוט כופלת הכל ב-{::nomarkdown}\( \lambda\){:/nomarkdown} ({::nomarkdown}\( D\left(v\right)=\lambda v\){:/nomarkdown}) והמטריצה המייצגת שלה <strong>בכל בסיס</strong> היא בסך הכל המטריצה הסקלרית שכולה אפסים למעט האלכסון הראשי שכולו {::nomarkdown}\( \lambda\){:/nomarkdown}. נשאר להבין את {::nomarkdown}\( N\){:/nomarkdown} ולמצוא בסיס שבו המטריצה המייצגת שלה תהיה נחמדה.

אני, כאמור, טוען ש-{::nomarkdown}\( N\){:/nomarkdown} היא נילפוטנטית. מה זו טרנספורמציה נילפוטנטית? כזו שאם מעלים אותה בחזקה מספיק פעמים, מקבלים את טרנספורמציית האפס. הנה דוגמה למטריצה נילפוטנטית:

{::nomarkdown}\( \left(\begin{array}{ccccc}0 &amp; 1 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 1 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 1\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\end{array}\right)\){:/nomarkdown}

תעלו אותה בחזקה מספיק פעמים ותקבלו את מטריצת האפס. כעת, לא בחרתי את המטריצה הזו באקראי - בחרתי מטריצה שבה יש 1-ים רק במקום אחד: על האלכסון שמעל האלכסון הראשי. בדיוק כמו שקורה בצורת ז'ורדן. למעשה, המטריצה הזו היא-היא צורת ז'ורדן של טרנספורמציה כלשהי שכל הערכים העצמיים שלה הם 0.

מכיוון שהגדרתי {::nomarkdown}\( D=\lambda I\){:/nomarkdown} הרי שאם אני מגדיר {::nomarkdown}\( N=T-\lambda I\){:/nomarkdown} אני מקבל בדיוק ש-{::nomarkdown}\( T=D+N\){:/nomarkdown} כפי שכתבתי למעלה. את {::nomarkdown}\( T-\lambda I\){:/nomarkdown} אנחנו מכירים: המרחב {::nomarkdown}\( W\){:/nomarkdown} <strong>הוגדר</strong> בתור הגרעין של {::nomarkdown}\( \left(T-\lambda I\right)^{r}\){:/nomarkdown}, דהיינו כל אברי {::nomarkdown}\( W\){:/nomarkdown} שייכים לגרעין של {::nomarkdown}\( N^{r}\){:/nomarkdown}, דהיינו {::nomarkdown}\( N^{r}\){:/nomarkdown} היא טרנספורמציית האפס על <strong>כל</strong> המרחב {::nomarkdown}\( W\){:/nomarkdown}, ולכן {::nomarkdown}\( N\){:/nomarkdown} נילפונטנטית כפי שהבטחתי.

אבל למה זה מעניין?

זה מעניין כי עכשיו אני הולך להשתמש <strong>במשפט הפירוק הציקלי</strong> על המרחב {::nomarkdown}\( W\){:/nomarkdown} והטרנספורמציה {::nomarkdown}\( N\){:/nomarkdown}. במילים אחרות, אני הולך למצוא את <strong>הצורה הרציונלית</strong> של {::nomarkdown}\( N\){:/nomarkdown} על {::nomarkdown}\( W\){:/nomarkdown}, ומכיוון ש-{::nomarkdown}\( N\){:/nomarkdown} נילפוטנטית הצורה הרציונלית הזו תהיה פשוטה במיוחד. המשמעות של נילפוטנטיות היא שהפולינום המינימלי של {::nomarkdown}\( N\){:/nomarkdown} הוא פשוט במיוחד: הוא חייב לחלק את {::nomarkdown}\( x^{r}\){:/nomarkdown} (כי {::nomarkdown}\( N\){:/nomarkdown} מאפסת את הפולינום {::nomarkdown}\( x^{r}\){:/nomarkdown}) ולכן הוא בעצמו מהצורה {::nomarkdown}\( x^{t}\){:/nomarkdown} עבור {::nomarkdown}\( t\){:/nomarkdown} כלשהו. מכיוון שכל הגורמים האינוריאנטיים של {::nomarkdown}\( N\){:/nomarkdown} מחלקים את הפולינום המינימלי, נובע שכל הגורמים האינוריאנטיים של {::nomarkdown}\( N\){:/nomarkdown} הם מהצורה {::nomarkdown}\( x^{t}\){:/nomarkdown} עבור {::nomarkdown}\( t\){:/nomarkdown} כלשהו.

ולמה זה כל כך טוב? כי תחשבו שניה מהי המטריצה המלווה של הפולינום {::nomarkdown}\( x^{t}\){:/nomarkdown}: כל העמודה האחרונה, שבדרך כלל מלאה מקדמים מכוערים עם מינוסים מכוערים, תהיה פשוט אפסים! זאת מכיוון שכל המקדמים של {::nomarkdown}\( x^{t}\){:/nomarkdown} למעט המקדם המוביל (שלא מופיע במטריצה המלווה) הם אפס. זה אומר שהמטריצה המלווה תהיה מהצורה הבאה:

{::nomarkdown}\( \left(\begin{array}{ccccc}0 &amp; 0 &amp; 0 &amp; \cdots &amp; 0\\1 &amp; 0 &amp; 0 &amp; \cdots &amp; 0\\0 &amp; 1 &amp; 0 &amp; \cdots &amp; 0\\\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots\\0 &amp; 0 &amp; 0 &amp; \cdots &amp; 0\end{array}\right)\){:/nomarkdown}

זה כמעט בלוק ז'ורדן - רק עם 1-ים מתחת לאלכסון במקום מעל לאלכסון. זה לא קורה בגלל שהבסיס שאנחנו עובדים איתו שונה, אלא רק שה<strong>סדר</strong> של האיברים בבסיס צריך להיות הפוך. אם אנחנו מגדירים בסיס {::nomarkdown}\( \mathcal{B}=\left\{ b_{0},b_{1},\dots,b_{n-1}\right\} \){:/nomarkdown} על ידי {::nomarkdown}\( b_{i}=N^{i}u\){:/nomarkdown} עבור {::nomarkdown}\( u\){:/nomarkdown} שהוא הוקטור הציקלי שלנו, אז המטריצה המייצגת של {::nomarkdown}\( N\){:/nomarkdown} בבסיס הזה תהיה מה שלמעלה. אבל אם נהפוך את הסדר של האיברים בבסיס, כלומר נגדיר {::nomarkdown}\( b_{i}=N^{\left(n-1\right)-i}u\){:/nomarkdown}, אז יתקיים {::nomarkdown}\( N\left(b_{i}\right)=b_{i-1}\){:/nomarkdown} לכל {::nomarkdown}\( 1\le i&lt;n\){:/nomarkdown}, ואילו עבור {::nomarkdown}\( b_{0}\){:/nomarkdown} יתקיים {::nomarkdown}\( N\left(b_{0}\right)=N\left(N^{n-1}\right)u=N^{n}u=0\){:/nomarkdown}. לכן המטריצה המייצגת בבסיס ההפוך הזה תהיה

{::nomarkdown}\( \left(\begin{array}{ccccc}0 &amp; 1 &amp; 0 &amp; \cdots &amp; 0\\0 &amp; 0 &amp; 1 &amp; \cdots &amp; 0\\0 &amp; 0 &amp; 0 &amp; \cdots &amp; 0\\\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots\\0 &amp; 0 &amp; 0 &amp; \cdots &amp; 1\\0 &amp; 0 &amp; 0 &amp; \cdots &amp; 0\end{array}\right)\){:/nomarkdown}

וזה בדיוק בלוק ז'ורדן.

נסכם: התחלנו עם {::nomarkdown}\( T\){:/nomarkdown}. אמרנו שנמצא מטריצה מייצגת עבור {::nomarkdown}\( T\){:/nomarkdown} שבה לכל ערך עצמי {::nomarkdown}\( \lambda\){:/nomarkdown} של {::nomarkdown}\( T\){:/nomarkdown} יהיה לנו בלוק אחד במטריצה שהוא המטריצה המייצגת של {::nomarkdown}\( T\){:/nomarkdown} המצומצמת למרחב {::nomarkdown}\( W=\ker\left(\left(T-\lambda I\right)^{r}\right)\){:/nomarkdown} - זה משפט הפירוק הפרימרי. ב-{::nomarkdown}\( W\){:/nomarkdown} אמרנו שנפרק את {::nomarkdown}\( T\){:/nomarkdown} לסכום {::nomarkdown}\( T=D+N\){:/nomarkdown} כאשר {::nomarkdown}\( D\){:/nomarkdown} סקלרית ואילו {::nomarkdown}\( N\){:/nomarkdown} נילפוטנטית, ואז השתמשנו במשפט הפירוק הציקלי כדי להראות שהמטריצה המייצגת של {::nomarkdown}\( N\){:/nomarkdown} היא מטריצת בלוקים שבה כל בלוק הוא בלוק ז'ורדן שמתאים לערך העצמי 0, כלומר עם 0 על האלכסון הראשי. המטריצה המייצגת של {::nomarkdown}\( T\){:/nomarkdown} על {::nomarkdown}\( W\){:/nomarkdown}, אם כן, היא סכום של שתי מטריצות שאחת מהן היא {::nomarkdown}\( \left(\begin{array}{cccc}\lambda\\ &amp; \lambda\\ &amp; &amp; \ddots\\ &amp; &amp; &amp; \lambda\end{array}\right)\){:/nomarkdown} והשניה היא 0 בכל מקום חוץ אולי מכמה 1-ים באלכסון שמעל האלכסון הראשי.

הראינו קיום, אבל מה עם יחידות? ובכן, הפירוק הפרימרי הוא בוודאי יחיד, כי קיים רק פירוק אחד לגורמים אי פריקים של הפולינום המינימלי (זה מתקשר לדוגמה שנתתי בתחילת הפוסט, של פירוק יחיד לאי פריקים במספרים הטבעיים; עם פולינומים זה אותו סיפור בדיוק). לכל בלוק שנותן הפירוק הפרימרי היחידות שלו נובעת מהיחידות של הצורה הרציונלית. זה מסיים גם את זה.

נשאלת כמובן גם השאלה איך מוצאים את צורת ז'ורדן בפועל. אנחנו רואים שיש פה שני שלבים: ראשית צריך לפרק את הפולינום המינימלי לגורמים בשביל לקבל את הפירוק הפרימרי. שנית, צריך למצוא את בלוקי ז'ורדן שמתאימים לכל ערך עצמי, וזה בעצם שקול למציאת הצורה הרציונלית של {::nomarkdown}\( N\){:/nomarkdown} עבור כל מרחב של הפירוק הפרימרי. אפשר לעשות את זה עם צורת סמית כמו שתיארתי כאן, אבל כבר קל יותר פשוט למצוא את הוקטורים הציקליים באופן מפורש. זה בדיוק מה שתיארתי <a href="http://www.gadial.net/2016/08/30/jordan_form_basics/">בפוסט על התכל'ס של מציאת צורת ז'ורדן</a>.

עכשיו אפשר גם לדבר על שלוש תכונות של הבלוקים בצורת ז'ורדן שהזכרתי בפוסט ההוא, ולראות למה הן נכונות. אזכיר אותן:
<ul>
	<li>לכל ערך עצמי {::nomarkdown}\( \lambda\){:/nomarkdown}, הריבוי האלגברי של {::nomarkdown}\( \lambda\){:/nomarkdown} (הדרגה של {::nomarkdown}\( \left(x-\lambda\right)\){:/nomarkdown} בפולינום האופייני) שווה ל<strong>סכום גדלי</strong> בלוקי ז'ורדן המתאימים ל-{::nomarkdown}\( \lambda\){:/nomarkdown}.</li>
	<li>לכל ערך עצמי {::nomarkdown}\( \lambda\){:/nomarkdown}, הריבוי הגאומטרי של {::nomarkdown}\( \lambda\){:/nomarkdown} שווה ל<strong>מספר</strong> בלוקי ז'ורדן המתאימים ל-{::nomarkdown}\( \lambda\){:/nomarkdown}.</li>
	<li>לכל ערך עצמי {::nomarkdown}\( \lambda\){:/nomarkdown}, הריבוי של {::nomarkdown}\( \lambda\){:/nomarkdown} <strong>בפולינום המינימלי</strong> שווה לגודל בלוק הז'ורדן הגדול ביותר המתאים ל-{::nomarkdown}\( \lambda\){:/nomarkdown}.</li>
</ul>
התכונה הראשונה קלה למדי: אם {::nomarkdown}\( J\){:/nomarkdown} היא מטריצה בצורת ז'ורדן, טריוויאלי לחשב את הפולינום האופייני שלה - מכיוון ש-{::nomarkdown}\( xI-J\){:/nomarkdown} היא מטריצה משולשית עליונה, הדטרמיננטה שלה היא מכפלת אברי האלכסון. לכן הריבוי האלגברי של {::nomarkdown}\( \lambda\){:/nomarkdown} זהה למספר הפעמים ש-{::nomarkdown}\( \lambda\){:/nomarkdown} מופיע על האלכסון של {::nomarkdown}\( J\){:/nomarkdown}, שהוא סכום הגדלים של הבלוקים שבהם {::nomarkdown}\( \lambda\){:/nomarkdown} מופיע. את זה יכולנו לדעת גם בלי להבין מאיפה צורת ז'ורדן מגיעה בכלל.

התכונה השלישית נובעת ממה שאמרנו על הגורמים האינוריאנטיים בצורה הרציונלית: הגורם האינוריאנטי הגדול ביותר שווה לפולינום המינימלי. התכונה השניה טיפה יותר מסובכת: הריבוי הגאומטרי של {::nomarkdown}\( \lambda\){:/nomarkdown} הוא בדיוק {::nomarkdown}\( \dim\ker N\){:/nomarkdown}. לכן השאלה היא מה הגרעין של {::nomarkdown}\( N\){:/nomarkdown} ב-{::nomarkdown}\( W\){:/nomarkdown}. בואו ניזכר מה הוא הבסיס של {::nomarkdown}\( W\){:/nomarkdown} שאנחנו מוצאים בסוף - הוא איחוד של בסיסים לתתי-המרחבים הציקליים שפירקנו את {::nomarkdown}\( W\){:/nomarkdown} אליהם, ובכל תת-מרחב כזה אברי הבסיס הם הפעלות של {::nomarkdown}\( N\){:/nomarkdown} על וקטור ציקלי כלשהו. האיבר האחרון בכל אחד מהבסיסים הללו הוא וקטור שכאשר נפעיל עליו את {::nomarkdown}\( N\){:/nomarkdown} נקבל 0, ולכן הוא שייך ל-{::nomarkdown}\( \ker N\){:/nomarkdown}; שאר הוקטורים בבסיס הם בדיוק כאלו שהפעלה של {::nomarkdown}\( N\){:/nomarkdown} עליהם לא מחזירה 0 (אלא את האיבר הבא בבסיס) ולכן הם לא שייכים ל-{::nomarkdown}\( \ker N\){:/nomarkdown}. כך אנחנו מקבלים שכל וקטור ציקלי תורם בדיוק וקטור בלתי תלוי אחד ל-{::nomarkdown}\( \ker N\){:/nomarkdown}, ולכן המימד של {::nomarkdown}\( \ker N\){:/nomarkdown} שווה למספר בלוקי הז'ורדן (כי כל בלוק ז'ורדן נובע מוקטור ציקלי אחד).

<strong>דברי סיכום ופרידה</strong>

היה הרבה מלל בפוסט הזה, אבל מבחינה מתמטית לא היה כאן שום דבר מסובך, רק הסברים טריוויאליים למדי. הסיבה לכך היא שאת כל העבודה כבר עשינו קודם, עם משפט הפירוק הפרימרי ומשפט הפירוק הציקלי, שההוכחות של שניהם היו טכניות יחסית וכללו רעיונות לא טריוויאליים. אחרי שהשגנו את המשפטים הללו, הכל היה פשוט: הצורה הרציונלית נבעה מיידית ממשפט הפירוק הציקלי, וצורת ז'ורדן נבעה ממשפט הפירוק הפרימרי שאחרי השתמשנו בצורה קצת חכמה במשפט הפירוק הציקלי כדי "לפרק עוד קצת" את מה שקיבלנו ממשפט הפירוק הפרימרי.

אני חושב שהיישומים הללו של המשפטים הם אלגנטיים מאוד. אחרי שמבינים "מאיפה זה מגיע", הן הצורה הרציונלית והן צורת ז'ורדן נראות לי - עד כמה שאפשר לומר את זה על מושג מתמטי, כמובן - יפות. זה מאפיין כללי של אלגברה לינארית, לדעתי; זה תחום שיש בו כמה משפטים ספציפיים שהם טכניים מאוד בהוכחתם, אבל מסביב להם רוב התורה שנבנית היא מאוד פשוטה ואינטואיטיבית והכל בה "פשוט מסתדר מעצמו". אני מקווה שהצלחתי להעביר את התחושה הזו בפוסט הזה.

ועוד דבר אחד לפרידה: הפוסט הזה פחות או יותר סוגר את אחד מהכיוונים בסדרת הפוסטים שלי על אלגברה לינארית (זה שעוסק בצורות קנוניות; מן הסתם יש כיוונים נוספים), אבל אני לא רוצה לתת אשליה שזה סוף הסיפור. כפי שרמזתי בפוסטים קודמים בנושא, את כל מה שעשינו כאן אפשר לראות בתור מקרה פרטי של משפט כללי יותר שעוסק ב<strong>מודולים</strong>, שהם בתורם הכללה של מרחבים וקטוריים. אני מקווה להציג בפוסט יום אחד גם את נקודת המבט הזו, אבל לבינתיים בואו נסתפק בלדעת שהיא קיימת.
