---
id: 3571
title: "משפט המספרים המחומשים"
date: 2018-03-27 14:51:55
layout: post
categories: 
  - קומבינטוריקה
  - תורת המספרים
tags: 
  - חלוקות
  - משפט המספרים המחומשים
---
בפוסט הזה אני רוצה להוכיח את מה שנקרא <strong>משפט המספרים המחומשים</strong>. במבט ראשון המשפט נראה מוזר ולא ברור למה הוא מעניין במיוחד, ולכן <a href="http://gadial.net/2018/03/11/partition_function_and_pentagonal_numbers/">הפוסט הקודם</a> הוקדש לשימוש מעניין שלו - מציאת נוסחת נסיגה עבור פונקציית החלוקה. עם זאת, המטרה של הפוסט הנוכחי היא לעמוד בפני עצמו, כי המתמטיקה של הפוסט הקודם היא טכנית למדי ולא דומה כל כך למה שנדבר עליו הפעם, כך שחבל לוותר רק בגלל זה.

ראשית, מה זה מספר מחומש? זה מספר מהצורה {::nomarkdown}\(\frac{k\left(3k-1\right)}{2}\){:/nomarkdown} כאשר {::nomarkdown}\(k\){:/nomarkdown} הוא מספר טבעי חיובי. השם "מספר מחומש" מגיע מכך שצורה מוזרה שבה אפשר לקבל את המספרים היא לצייר סדרה של {::nomarkdown}\(k\){:/nomarkdown} מחומשים אחד בתוך השני, כשבמחומש ה-{::nomarkdown}\(k\){:/nomarkdown} יש בדיוק {::nomarkdown}\(k\){:/nomarkdown} נקודות על כל צלע, ואז לספור כמה נקודות יש בסך הכל. המחומש הראשון, זה עם נקודה אחת על כל צלע, הוא "מנוון" ונראה כמו נקודה בודדת:

<img class="alignnone size-medium wp-image-3572" src="http://gadial.net/wp-content/uploads/2018/03/pengaton_numbers-300x138.jpg" alt="" width="300" height="138" />

זו דרך די מוזרה להגדיר סדרת מספרים, ואני אכן לא אחזור אליה בכלל. יותר מכך - אני אדבר גם על המספרים שמתקבלים כשמציבים בתוך {::nomarkdown}\(k\){:/nomarkdown} ערכים <strong>שליליים</strong>; גם במקרה הזה מקבלים מספרים חיוביים. השיטה היא להציב מספר טבעי ואז את המינוס שלו, ואז את המספר הטבעי הבא וכן הלאה. הצבות של {::nomarkdown}\(k=1,-1,2,-2,\dots\){:/nomarkdown} מניבות את סדרת המספרים {::nomarkdown}\(1,2,5,7,12,15,22,26,\dots\){:/nomarkdown}.

הסיבה שהסדרה הזו מעניינת היא הנוסחה הבאה, שנקראת <strong>משפט המספרים המחומשים</strong> ובמבט ראשון ממש לא ברור מה היא אומרת בכלל:

{::nomarkdown}\(\prod_{n=1}^{\infty}\left(1-x^{n}\right)=\sum_{k=-\infty}^{\infty}\left(-1\right)^{k+1}x^{\frac{k\left(3k-1\right)}{2}}\){:/nomarkdown}

כפי שהצהרתי בפוסט הקודם, לטעמי זו אחת מהנוסחאות היפות במתמטיקה, אבל אין שום סיבה להתעמק בפרטים שלה כאן (את זה עשיתי בפוסט הקודם) - במקום זה אפשר לנסח את המשפט בצורה שקולה לגמרי שהרבה יותר קל להבין, ותהיה הרבה יותר רלוונטית לאופן שבו אוכיח את המשפט בפועל. בהינתן מספר טבעי {::nomarkdown}\(n\){:/nomarkdown}, אפשר לדבר על הדרכים השונות להציג אותו בתור סכום של מספרים טבעיים חיוביים כך שאין מספר שמופיע פעמיים. בפוסט הזה אני אקרא בשם <strong>חלוקה</strong> להצגה כזו (באופן כללי "חלוקות" מתייחס גם למקרה שבו מספר יכול להופיע פעמיים). למשל, ל-4 יש שתי חלוקות: {::nomarkdown}\(4\){:/nomarkdown} עצמו, ו-{::nomarkdown}\(1+3\){:/nomarkdown}. ה"חלוקה" {::nomarkdown}\(2+2\){:/nomarkdown} לא נחשבת כי המספר 2 מופיע בה פעמיים.

אפשר לתאר חלוקות בדרך ציורית בעזרת <strong>טבלת יאנג</strong>. טבלת יאנג כוללת בסך הכל כמה שורות של ריבועים, כשכל שורה לא ארוכה יותר מאלו שבאות מתחתיה. סכום הריבועים הכולל בטבלה הוא {::nomarkdown}\(n\){:/nomarkdown}, והאורך של כל שורה מייצג את אחד מהאיברים בפירוק. הנה דוגמא עבור הפירוקים של 4:

<strong><img class="alignnone size-medium wp-image-3573" src="http://gadial.net/wp-content/uploads/2018/03/young1-300x81.png" alt="" width="300" height="81" /></strong>

הכלל הנוסף של "אותו מספר לא מופיע פעמיים בפירוק" מתורגם אצלנו ל"בטבלת יאנג, כל שורה קצרה יותר מזו שמתחתיה". לכן הטבלה הזו לא חוקית מבחינתנו:

<img class="alignnone wp-image-3574 size-thumbnail" src="http://gadial.net/wp-content/uploads/2018/03/young2-150x150.png" alt="" width="150" height="150" />

מספר החלוקות של {::nomarkdown}\(n\){:/nomarkdown} הוא מספר טבלאות היאנג החוקיות שקיימות עבורו. עכשיו בואו נבדיל בין שני סוגי טבלאות: כאלו עם מספר <strong>זוגי</strong> של שורות, מה שאקרא לו "חלוקה זוגית", וכאלו עם מספר <strong>אי-זוגי</strong> של שורות - "חלוקה אי-זוגית". אסמן ב-{::nomarkdown}\(p_{\text{odd}}\left(n\right)\){:/nomarkdown} את מספר החלוקות האי-זוגיות של {::nomarkdown}\(n\){:/nomarkdown} וב-{::nomarkdown}\(p_{\text{even}}\left(n\right)\){:/nomarkdown} את מספר החלוקות הזוגיות. אנחנו יודעים ש-{::nomarkdown}\(p_{\text{odd}}\left(n\right)+p_{\text{even}}\left(n\right)\){:/nomarkdown} שווה למספר החלוקות של {::nomarkdown}\(n\){:/nomarkdown} בסך הכל; אבל למה שווה ההפרש, {::nomarkdown}\(p_{\text{odd}}\left(n\right)-p_{\text{even}}\left(n\right)\){:/nomarkdown}? ובכן, זה בדיוק התוכן של משפט המספרים המחומשים: הוא אומר שכמעט תמיד מספר החלוקות הזוגיות יהיה שווה למספר החלוקות האי-זוגיות, כלומר ההפרש ביניהם יהיה 0; המקרים היחידים שבהם זה לא יהיה כך יהיו עבור {::nomarkdown}\(n\){:/nomarkdown} שהוא מספר מחומש, ובמקרה הזה ההפרש יהיה פלוס-מינוס 1, כשהפלוס-או-מינוס נקבע על פי זוגיות ה-{::nomarkdown}\(k\){:/nomarkdown} שמגדיר את המספר. בכתיבה פורמלית:

{::nomarkdown}\(p_{\text{odd}}\left(n\right)-p_{\text{even}}\left(n\right)=\begin{cases} 1 &amp; n=\frac{k\left(3k-1\right)}{2},k\text{ odd}\\ -1 &amp; n=\frac{k\left(3k-1\right)}{2},k\text{ even}\\ 0 &amp; \text{else} \end{cases}\){:/nomarkdown}

הנה דוגמאות לכל המקרים הללו. ראשית, 2. זה מספר מחומש שמתקבל על ידי {::nomarkdown}\(k=1\){:/nomarkdown} האי-זוגי והפירוק היחיד שלו הוא 2; הפירוק {::nomarkdown}\(1+1\){:/nomarkdown} אינו חוקי כי 1 מופיע פעמיים. לכן מספר הפירוקים האי-זוגיים גדול ב-1 ממספר הפירוקים הזוגיים. כעת אל 7. זה מספר מחומש שמתקבל על ידי {::nomarkdown}\(k=-2\){:/nomarkdown} הזוגי, כך שאנחנו מצפים שמספר הפירוקים הזוגיים שלו יהיה גדול ב-1 ממספר הפירוקים האי-זוגיים שלו. הנה כל הפירוקים:

{::nomarkdown}\(7,1+6,2+5,3+4,1+2+4\){:/nomarkdown}

יש לנו פה שלושה פירוקים זוגיים ושניים אי-זוגיים - כמו שהמשפט מבטיח.

עכשיו אל 8 שאיננו מספר מחומש בכלל ולכן אנחנו מצפים למספר שווה. הנה הפירוקים לכל גודל:

1: {::nomarkdown}\(8\){:/nomarkdown}

{::nomarkdown}\(2\){:/nomarkdown}: {::nomarkdown}\(1+7,2+6,3+5\){:/nomarkdown}

3: {::nomarkdown}\(1+2+5,1+3+4\){:/nomarkdown}

יש לנו פה פירוק אחד מגודל 1 ושניים מגודל 3 - סה"כ שלושה מגודל אי זוגי, מה שמתקזז עם שלושה מגודל 2 הזוגי.

הרעיון ברור, אבל איך מוכיחים את המשפט? ההוכחה שאראה פה תהיה קומבינטורית ותיעזר בטבלאות יאנג; זו לא ההוכחה המקורית של אוילר אלא הוכחה שהתגלתה לקראת סוף המאה ה-19 על ידי פרנקלין האמריקאי (לא, לא פרנקלין הזה). הטריק הוא לסדר פירוקים זוגיים ואי זוגיים בזוגות, כשלכל היותר פירוק אחד נותר בודד. נעשה את זה על ידי הגדרת פונקציה שלוקחת פירוק ובונה ממנו פירוק חדש, עם מספר מחוברים שונה ב-1, כך שהפעלה נוספת של הפונקציה "מתקנת" את ההפעלה הקודמת וחוזרת לאיבר שממנו התחלנו. במילים אחרות, הפונקציה שלנו היא ההופכית של עצמה; מקיימת {::nomarkdown}\(f\left(f\left(x\right)\right)=x\){:/nomarkdown} לכל קלט. לפונקציה כזו קוראים <strong>אינבולוציה</strong>.

האינטואיציה של הבניה קלה להדהים כשמסתכלים עליה ציורית עם טבלאות יאנג. בואו נביט על טבלת היאנג של הפירוק {::nomarkdown}\(4+6+8+9+10\){:/nomarkdown} של {::nomarkdown}\(37\){:/nomarkdown}:

<strong><img class="alignnone wp-image-3576 size-medium" src="http://gadial.net/wp-content/uploads/2018/03/young3-300x150.png" alt="" width="300" height="150" /></strong>

אנחנו רוצים לבנות מהטבלה הזו טבלה שמייצגת מספר שונה ב-1 של מחוברים. כל מחובר מתאים ל<strong>שורה</strong> בטבלת היאנג, כך ששתי דרכי הפעולה הטבעיות ביותר הן: או <strong>להוסיף שורה</strong> מעל השורה העליונה, שתיבנה מקוביות שניקח מהשורות האחרות; או <strong>להסיר</strong> את השורה העליונה ולחלק אותה לשורות האחרות. ואנחנו רוצים שהכלל שמכתיב לנו באיזו משתי הדרכים כדאי לנקוט יהיה כזה ש"הופך את עצמו" אחרי שימוש אחד. אז הנה הטריק: בואו נמספר ב-{::nomarkdown}\(r\){:/nomarkdown} את מספר הקוביות בשורה העליונה ("המחובר הקטן ביותר בסכום") וב-{::nomarkdown}\(s\){:/nomarkdown} נמספר את האורך של <strong>האלכסון</strong> בצד ימין למטה של הטבלה. באיור אצבע את השורה העליונה בירוק ואת האלכסון באדום:

<strong> <img class="alignnone size-medium wp-image-3577" src="http://gadial.net/wp-content/uploads/2018/03/young4-300x150.png" alt="" width="300" height="150" /></strong>

הגדרה פורמלית יותר של {::nomarkdown}\(s\){:/nomarkdown} היא זו: אורך הסדרה של המחוברים בסכום שמתחילה במחובר הגדול ביותר, עוברת עליהם מהגדול לקטן, ומסתיימת לפני האיבר הראשון ששונה מקודמו לפחות ב-2. והנה ניסוח עוד יותר פורמלי: אם נסמן חלוקה {::nomarkdown}\(\lambda\){:/nomarkdown} בתור {::nomarkdown}\(\lambda=\left(\lambda_{1},\lambda_{2},\dots,\lambda_{k}\right)\){:/nomarkdown} כך ש-{::nomarkdown}\(\lambda_{1}&gt;\lambda_{2}&gt;\dots&gt;\lambda_{k}\){:/nomarkdown} אז {::nomarkdown}\(r=\lambda_{k}\){:/nomarkdown} ו-{::nomarkdown}\(s\){:/nomarkdown} הוא המספר הגדול ביותר עבורו מתקיים {::nomarkdown}\(\left(\lambda_{1},\dots,\lambda_{s}\right)=\left(\lambda_{1},\lambda_{1}-1,\dots,\lambda_{1}-\left(s-1\right)\right)\){:/nomarkdown}.

ומה האינבולוציה עושה? אם {::nomarkdown}\(r&gt;s\){:/nomarkdown} אז אנחנו מפרקים את האלכסון ובונים ממנו שורה חדשה מעל השורה העליונה; בגלל ש-{::nomarkdown}\(r&gt;s\){:/nomarkdown} מובטח לנו שהשורה הזו תהיה קצרה מזו שמתחתיה, כדרוש. אם לעומת זאת {::nomarkdown}\(r&lt;s\){:/nomarkdown} אנחנו מפרקים את השורה העליונה ובונים ממנה אלכסון חדש, כלומר מוסיפים קוביה אחת לכל {::nomarkdown}\(r\){:/nomarkdown} השורות הראשונות; מכיוון ש-{::nomarkdown}\(r&lt;s\){:/nomarkdown} אנחנו יודעים שיש מספיק שורות כאלו.

<strong><img class="alignnone size-medium wp-image-3578" src="http://gadial.net/wp-content/uploads/2018/03/young5-300x200.png" alt="" width="300" height="200" /></strong>

מתי <strong>עשויה</strong> להיות בעיה? במקרה שבו {::nomarkdown}\(r=s\){:/nomarkdown}. כאן העסק עלול להתקלקל אבל לא <strong>חייב</strong> להתקלקל. בואו נראה דוגמא, שמתאימה ל-{::nomarkdown}\(3+6+8+9+10\){:/nomarkdown} של {::nomarkdown}\(36\){:/nomarkdown}:

<strong><img class="alignnone size-medium wp-image-3579" src="http://gadial.net/wp-content/uploads/2018/03/young6-300x150.png" alt="" width="300" height="150" /></strong>

ברור שבמקרה הזה אי אפשר לייצר שורה חדשה, כי היא תהיה באותה אורך כמו זו שמתחתיה; חייבים לפרק את השורה הקיימת, ואז מקבלים את הפירוק {::nomarkdown}\(6+9+10+11\){:/nomarkdown}:

<strong><img class="alignnone size-medium wp-image-3580" src="http://gadial.net/wp-content/uploads/2018/03/young7-300x110.png" alt="" width="300" height="110" /></strong>

הפירוק הזה תקין לגמרי, וכשנפעיל עליו את האינבולוציה נחזור לסיטואציה המקורית והכל טוב. מתי כן הייתה עלולה לצוץ בעיה? רק אם לא היו לנו {::nomarkdown}\(r\){:/nomarkdown} שורות לחלק את הקוביות של השורה העליונה אליהן. מתי זה עלול לקרות? אנחנו הרי יודעים שיש לפחות {::nomarkdown}\(s\){:/nomarkdown} שורות, ואת המספר הכולל של השורות סימנתי ב-{::nomarkdown}\(k\){:/nomarkdown}. כלומר {::nomarkdown}\(r=s\le k\){:/nomarkdown}; לכן כדי שתוכל להיווצר בעיה, הכרחי שיתקיים {::nomarkdown}\(s=k\){:/nomarkdown}: במצב הזה מכיוון שאנחנו <strong>מפרקים</strong> את השורה העליונה, אנחנו נשארים בסוף עם קוביה בודדת שאין לנו שורה להכניס אותה אליה.

איך נראית טבלה שבה {::nomarkdown}\(s=k\){:/nomarkdown}? היא תואמת כל חלוקה שבה הפער בין <strong>כל</strong> המחוברים הסמוכים הוא 1. למשל {::nomarkdown}\(1+2+3+4\){:/nomarkdown}:

<strong><img class="alignnone wp-image-3582 size-medium" src="http://gadial.net/wp-content/uploads/2018/03/young8-300x300.png" alt="" width="300" height="300" /></strong>

אבל כאן, כמובן, אין בעיה, כי {::nomarkdown}\(r&lt;s\){:/nomarkdown} ולכן אפשר לפרק את השורה העליונה. לכן המקרה <strong>היחיד</strong> שבו יכולה להיות בעיה הוא זה שבו {::nomarkdown}\(s=r=k\){:/nomarkdown}. למשל, הטבלה הזו:

<strong><img class="alignnone size-medium wp-image-3584" src="http://gadial.net/wp-content/uploads/2018/03/young9-1-300x180.png" alt="" width="300" height="180" /></strong>

וכאן אנחנו אכן מקבלים מספר מחומש, {::nomarkdown}\(12\){:/nomarkdown}. ובאופן כללי?

אם {::nomarkdown}\(s=r=k\){:/nomarkdown} אז החלוקה שלנו היא בהכרח מהצורה הבאה: {::nomarkdown}\(\left(k,k+1,k+2,\dots,k+\left(k-1\right)\right)\){:/nomarkdown}. זה טור חשבוני פשוט במיוחד שאפשר לסכום "בשיטה של גאוס" - לשים לב שהסכום של המחובר הראשון והאחרון הוא {::nomarkdown}\(3k-1\){:/nomarkdown}, וגם הסכום של המחובר השני והלפני אחרון, וכן הלאה, ויש בסך הכל {::nomarkdown}\(k\){:/nomarkdown} מחוברים ולכן {::nomarkdown}\(\frac{k}{2}\){:/nomarkdown} זוגות של מחוברים, ולכן הסכום הכולל הוא {::nomarkdown}\(\frac{k\left(3k-1\right)}{2}\){:/nomarkdown} - והופס, קיבלנו מספר מחומש! אבל שימו לב, רק עבור המקרה שבו {::nomarkdown}\(k\){:/nomarkdown} הוא חיובי, בינתיים. עכשיו גם ברור למה כאשר {::nomarkdown}\(k\){:/nomarkdown} אי-זוגי אז יש יותר חלוקות אי זוגיות מזוגיות, ואחרת ההפך; כי {::nomarkdown}\(k\){:/nomarkdown} הוא מספר השורות בטבלה, כלומר הזוגיות של {::nomarkdown}\(k\){:/nomarkdown} קובעת האם החלוקה שאין לה בת זוג היא זוגית או אי זוגית.

אז רגע, מה פספסנו? איך ערכים שליליים של {::nomarkdown}\(k\){:/nomarkdown} נכנסים לתמונה? ובכן, רימיתי אתכם קודם והשמטתי עוד מקרה קצה אחד. האם עליתם על הרמאות שלי? הבעיה היא במקרה שבו {::nomarkdown}\(r&gt;s\){:/nomarkdown}. במקרה הזה, כזכור, הרעיון הוא לפרק את האלכסון ולדחוף את האיברים שלו בשורה מעל העליונה; אבל כאן עלולה להיווצר בעיה אם <strong>גם השורה העליונה השתתפה באלכסון</strong>, כי אז כשאני מפרק את האלכסון אני מסיר ממנה איבר אחד. הנה מקרה שבו זה קורה:

<strong><img class="alignnone wp-image-3587 size-medium" src="http://gadial.net/wp-content/uploads/2018/03/young10-300x151.png" alt="" width="300" height="151" /></strong>

כאן האלכסון הוא מגודל 3 ולכאורה אין עם זה בעיה כי השורה העליונה היא מגודל 4, אבל כמובן - אחרי שנסיר את אברי האלכסון ניוותר עם שורה מגודל 3. לכן יכולה להיווצר בעיה בדיוק במקרה שבו {::nomarkdown}\(r=s+1\){:/nomarkdown} ו-{::nomarkdown}\(s=k\){:/nomarkdown} (כי {::nomarkdown}\(s=k\){:/nomarkdown} פירושו "גם השורה העליונה משתתפת באלכסון). במקרה הזה, החלוקה היא מהצורה {::nomarkdown}\(\left(k+1,k+2,\dots,k+k\right)\){:/nomarkdown} והסכום יוצא {::nomarkdown}\(\frac{k\left(3k+1\right)}{2}\){:/nomarkdown}. זה כמובן לא מתאים לנוסחה שלנו של מספר מחומש, אז אם רוצים לקבל את האחידות היפה בנוסחה שיש לנו, בואו נשים לב לכך ש-{::nomarkdown}\(t\left(3t-1\right)=3t^{2}-t\){:/nomarkdown} ולכן אם נגדיר {::nomarkdown}\(t=-k\){:/nomarkdown} נקבל

{::nomarkdown}\(\frac{t\left(3t-1\right)}{2}=\frac{3t^{2}-t}{2}=\frac{3k^{2}+k}{2}=\frac{k\left(3k+1\right)}{2}\){:/nomarkdown}. זה מסביר את עניין המינוס ומסיים את ההוכחה.

נסכם מה הלך פה: הגדרתי אינבולוציה על קבוצת כל טבלאות יאנג הקיימות, למעט כמה מקרי קצה. האינבולוציה לא משנה את ה<strong>גודל</strong> של הטבלה (מספר הריבועים שלה, ששווה לגודל המספר שאת החלוקה שלו הטבלה מייצגת) אבל היא כן משנה בדיוק ב-1 את <strong>מספר השורות</strong> שלה (מספר המחוברים בחלוקה). בצורה הזו אנחנו מקבלים התאמה חח"ע ועל בין החלוקות הזוגיות של מספר והחלוקות האי-זוגיות שלו, למעט במקרים שבהם לפחות אחת מטבלאות היאנג שלו משתייכת אל מקרי הקצה שהאינבולוציה לא יודעת לטפל בהם. ראינו שמקרי הקצה הללו מתרחשים בדיוק עבור מספרים מהצורה {::nomarkdown}\(\frac{k\left(3k-1\right)}{2}\){:/nomarkdown} עבור ערכים שלמים של {::nomarkdown}\(k\){:/nomarkdown}; בפרט, אין שני מקרי קצה שמתרחשים עבור אותו גודל, כי לא קשה להראות שאין לאותו מספר טבעי שני ייצוגים שונים מהצורה {::nomarkdown}\(\frac{k\left(3k-1\right)}{2}\){:/nomarkdown} כאשר {::nomarkdown}\(k\){:/nomarkdown} שלם. זה יפה בפני עצמו, וזה עוד יותר יפה כשזוכרים שזה מה שמוביל בסופו של דבר לנוסחת הנסיגה המופלאה עבור פונקציית החלוקה שראינו בפוסט הקודם.
