<!DOCTYPE html>
<html lang="he" dir="rtl"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>אליס ובוב: ידועים בציבור | לא מדויק</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="אליס ובוב: ידועים בציבור" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="לאליס יש מידע סודי שהיא רוצה להעביר לבוב. במחשב. באינטרנט. הבעיה: אליס ובוב מעולם לא נפגשו פנים אל פנים. אין להם שום ערוץ תקשורת מאובטח. אין שום חלקיק מידע שבוב יכול להעביר לאליס, או ההפך, בלי שמישהו יוכל להאזין ולשמוע." />
<meta property="og:description" content="לאליס יש מידע סודי שהיא רוצה להעביר לבוב. במחשב. באינטרנט. הבעיה: אליס ובוב מעולם לא נפגשו פנים אל פנים. אין להם שום ערוץ תקשורת מאובטח. אין שום חלקיק מידע שבוב יכול להעביר לאליס, או ההפך, בלי שמישהו יוכל להאזין ולשמוע." />
<link rel="canonical" href="http://localhost:4000/blog/2007/11/22/public_key_cryptography" />
<meta property="og:url" content="http://localhost:4000/blog/2007/11/22/public_key_cryptography" />
<meta property="og:site_name" content="לא מדויק" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2007-11-22T01:58:31+02:00" />
<script type="application/ld+json">
{"datePublished":"2007-11-22T01:58:31+02:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/blog/2007/11/22/public_key_cryptography"},"url":"http://localhost:4000/blog/2007/11/22/public_key_cryptography","description":"לאליס יש מידע סודי שהיא רוצה להעביר לבוב. במחשב. באינטרנט. הבעיה: אליס ובוב מעולם לא נפגשו פנים אל פנים. אין להם שום ערוץ תקשורת מאובטח. אין שום חלקיק מידע שבוב יכול להעביר לאליס, או ההפך, בלי שמישהו יוכל להאזין ולשמוע.","headline":"אליס ובוב: ידועים בציבור","dateModified":"2007-11-22T01:58:31+02:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/blog/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/blog/feed.xml" title="לא מדויק" /><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$latex','$'] ],
        processEscapes: true
      },
       TeX: {extensions: ["AMSmath.js","AMSsymbols.js"]}
    });
  </script>
  <!-- "https://www.gadial.net/wp-includes/js/xypic.js" -->

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>
  
</head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/blog/">לא מדויק</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/blog/about/">אודות</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">אליס ובוב: ידועים בציבור</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2007-11-22T01:58:31+02:00" itemprop="datePublished">Nov 22, 2007
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>לאליס יש מידע סודי שהיא רוצה להעביר לבוב. במחשב. באינטרנט. הבעיה: אליס ובוב מעולם לא נפגשו פנים אל פנים. אין להם שום ערוץ תקשורת מאובטח. אין שום חלקיק מידע שבוב יכול להעביר לאליס, או ההפך, בלי שמישהו יוכל להאזין ולשמוע.</p>

<p>מה עושים?</p>

<p>בדרך כלל היינו רוצים להשתמש ב<a href="http://he.wikipedia.org/wiki/%D7%94%D7%A6%D7%A4%D7%A0%D7%94">הצפנה</a>. הבעיה היא ששיטות הצפנה “רגילות” (מה שמכונה “הצפנה סימטרית”) מסתמכות על קיום של מידע סודי (“מפתח”) שידוע הן לאליס והן לבוב. לכן הן לא רלוונטיות, לפחות לא בינתיים. מה שבוב עושה הוא ליצור “מנעול קפיצי” ולשלוח אותו לאליס (ולא אכפת לו שאחרים מצותתים). אליס נועלת את המידע הסודי עם המנעול, ושולחת חזרה לבוב. המצותתים לא מסוגלים לעשות כלום, כי אין להם את המפתח למנעול. איפה המפתח? רק אצל בוב. הוא פותח את המנעול אצלו, מוציא את המידע הסודי, וחסל. שמחה וצהלה.</p>

<p>מה הבעיה? שבמשך זמן מה, לא הייתה ידועה שום שיטה למימוש של “מנעול” שכזה.</p>

<p>השאלה ההיסטורית מי ומתי המציאו את המפתח הציבורי היא די מעורפלת. ככל הנראה, הפעם הראשונה שבה הוא הומצא ועליה אנו יודעים הייתה בסוכנות הביון הבריטית, בתחילת שנות ה-70 של המאה ה-20. עם זאת, כל מה שהם התעסקו בו נותר חסוי כמעט עד לסוף המאה, כך שלא הם זכו בזכות הראשונים. המאמר המדעי הראשון שעסק בצורה מפורשת ברעיון המפתח הציבורי היה מאמרם של <a href="http://he.wikipedia.org/wiki/%D7%95%D7%99%D7%98%D7%A4%D7%99%D7%9C%D7%93_%D7%93%D7%99%D7%A4%D7%99">ויטפילד דיפי</a> ו<a href="http://he.wikipedia.org/wiki/%D7%9E%D7%A8%D7%98%D7%99%D7%9F_%D7%94%D7%9C%D7%9E%D7%9F">מרטין הלמן</a> משנת 1976, “כיוונים חדשים בהצפנה”. הבעיה הייתה שדיפי והלמן, למרות שעלו על הרעיון, לא הצליחו להציע שום שיטה מעשית למימוש של מנעול. מה שהם כן עשו היה להציע <a href="http://he.wikipedia.org/wiki/%D7%A4%D7%A8%D7%95%D7%98%D7%95%D7%A7%D7%95%D7%9C_%D7%93%D7%99%D7%A4%D7%99-%D7%94%D7%9C%D7%9E%D7%9F">שיטה</a> שבה אליס ובוב יכולים ליצור יש מאין מפתח <strong>סימטרי</strong> משותף לשניהם, מבלי שהאויב המאזין יצליח לגלותו. למעשה, הם לא היו הראשונים שעלו על דבר כזה - קדם להם רלף מרקל, עם <a href="http://en.wikipedia.org/wiki/Merkle%27s_Puzzles">שיטה</a> (חזקה פחות) משלו. כל העניינים הללו מרתקים מאוד בפני עצמם וכנראה אקדיש להם פוסט נפרד.</p>

<p>פריצת הדרך המדוברת ביותר התרחשה שנה אחרי המאמר של דיפי והלמן, בשנת 1977. <a href="http://he.wikipedia.org/wiki/%D7%A8%D7%95%D7%A0%D7%9C%D7%93_%D7%A8%D7%99%D7%91%D7%A1%D7%98">רונלד ריבסט</a>, <a href="http://he.wikipedia.org/wiki/%D7%A2%D7%93%D7%99_%D7%A9%D7%9E%D7%99%D7%A8">עדי שמיר</a> ו<a href="http://he.wikipedia.org/wiki/%D7%9C%D7%90%D7%95%D7%A0%D7%A8%D7%93_%D7%90%D7%93%D7%9C%D7%9E%D7%9F">לאונרד אדלמן</a> המציאו שיטה שאכן מייצרת “מנעול” ציבורי מהסוג שעליו דיברתי. שיטת ההצפנה שלהם נקראת על שם ראשי התיבות של שמם - <a href="http://he.wikipedia.org/wiki/RSA#.D7.91.D7.98.D7.99.D7.97.D7.95.D7.AA">RSA</a>. ייתכן מאוד שכבר שמעתם את שמה גם אם אינכם מתעניינים בקריפטוגרפיה.</p>

<p>הרעיון הבסיסי ב-RSA אינו מסובך כל כך. לב העניין הוא <a href="http://he.wikipedia.org/wiki/%D7%97%D7%A9%D7%91%D7%95%D7%9F_%D7%9E%D7%95%D7%93%D7%95%D7%9C%D7%A8%D7%99">חשבון מודולורי</a>, שמבוצע מודולו מספר גדול n (“גדול” פירושו בן מאות ספרות) שהוא מכפלה של שני ראשוניים גדולים (ולכן קשה לפרק אותו לגורמים - רק שני גורמים זה המינימום ההכרחי). העניין הוא בכך שלא קשה להעלות מספר בחזקה טבעית כלשהי e מודולו n הזה, אבל קשה מאוד להוציא שורש מסדר כלשהו מודולו ה-n הזה אם לא ידוע מידע נוסף עליו. המידע הנוסף הזה יכול להיות, למשל, הפירוק שלו - אבל מה שבאמת מעניין הוא מהי פונקצית אוילר שלו (שאותה קל לחשב בהינתן הפירוק, וקל לפרק אם יודעים אותה). אם המידע הזה ידוע, בעיית הוצאת השורש הופכת לטריוויאלית: מתברר שכדי להוציא שורש e-י של מספר מודולו n, לפעמים מספיק להעלות את המספר בחזקה אחרת, d, וההעלאה בחזקה הזו זהה להוצאת שורש. זה לא תמיד אפשרי - בוחרים את e מראש כך שעבורה זה יהיה אפשרי. דוגמה: עבור n=35, זוג אפשרי אחד הוא e=5, d=17 - נסו ותהנו. אם כן, ה”מנעול” הוא פשוט העלאה של ההודעה הסודית שרוצים להצפין (וחושבים עליה כמספר) בחזקת e, והמפתח למנעול הזה הוא ההעלאה של המספר המוצפן בחזקת d.</p>

<p>השאלה למה כל זה עובד ראויה, כמו תמיד, לפוסט נפרד. מכל מקום, השיטה הייתה הצלחה אדירה, ועד היום משתמשים בה. עם זאת, מבחינה תיאורטית יש “בעיה” בשיטה - הקושי שלה לא כל כך ברור. כלומר, בעיית הפירוק לגורמים, שכבר אמרתי ש”מוסכם” שהיא נחשבת קשה למדי, היא בבירור קשה לפחות כמו בעיית פיצוח RSA - כי אם קל לפרק לגורמים, קל בהינתן e למצוא את d שמתאים לו. העניין הוא שבכלל לא ברור שהכיוון השני הפוך - כלומר, שאם בהינתן e היינו יכולים למצוא בקלות את d, גם היה לנו קל לבצע פירוק לגורמים. אם הכיוון הזה היה נכון, היינו אומרים שבעיית פיצוח RSA היא קשה “לפחות כמו” בעיית הפירוק לגורמים. בלי זה - אין לנו מושג. אולי זו בעיה ממש קלה וטרם הבנו זאת.</p>

<p>על רקע זה באה <a href="http://he.wikipedia.org/wiki/%D7%94%D7%A6%D7%A4%D7%A0%D7%AA_%D7%A8%D7%91%D7%99%D7%9F">שיטת ההצפנה</a> של <a href="http://he.wikipedia.org/wiki/%D7%9E%D7%99%D7%9B%D7%90%D7%9C_%D7%A8%D7%91%D7%99%D7%9F">רבין</a>. היא מזכירה למדי את RSA באופיה, אבל ההבדל המהותי ביניהן הוא ששיטת רבין הוכחה כ<strong>שקולה</strong> לבעיית הפירוק לגורמים; כלומר, אם מוצאים דרך לפצח אותה, מוצאים דרך לבצע פירוק לגורמים. השיטה פשוטה יותר לתיאור בסיסי מאשר RSA: כמו ב-RSA בוחרים שני ראשוניים גדולים p,q, מכפילים אותם לקבלת n ומכאן והלאה עוסקים בהודעות שהן מספרים קטנים מ-n. בהינתן מספר כזה, ההצפנה שלו היא פשוט העלאתו בריבוע; הפענוח של מסר מוצפן הוא הוצאת השורש הריבועי שלו. זה הכל. כזכור ממה שכבר כתבתי בעבר, הוצאת שורש היא קשה אלא אם יודעים את הפירוק לגורמים - ולכן הפירוק לגורמים הוא המפתח הפרטי כאן.</p>

<p>יש כאן כמה מהומות שאני מתחמק מהן - למשל, לכל מספר בעל שורש ריבועי יש <strong>ארבעה</strong> שורשים - כלומר, לכל הודעה מוצפנת יש ארבעה “פיענוחים” אפשריים. הדרך שבה מתגברים על כך היא על ידי הוספת “יתירות” להודעה המקורית - טקסט כלשהו שאנו מצפים שיהיה תמיד בכל הודעה (למשל, כותרת “בוקר טוב!” למעלה - או, אם רוצים להיות מתוחכמים יותר, הוספת התוצאה של הפעלת פונקצית תמצות על ההודעה בסופה). הסיכוי ששתי הודעות ששתיהן בעלות משמעות ושתיהן שורש של אותה הודעה מוצפנת יהיו בעלות אותה יתירות הוא אפסי, ולכן זה פותר באופן מעשי את הבעיה.</p>

<p>על פניו, הכל נפלא - רעיון המפתח הציבורי פותר לנו את כל בעיית שיתוף המפתחות, ומעתה ועד עולם אפשר להצפין הכל וללכת לישון בשקט. אם כן, למה בעולם האמיתי עדיין מדברים על הצפנות סימטריות (עד כדי כך שבעשר השנים האחרונות רעשה הארץ כאשר נקבע סטנדרט חדש להצפנה סימטרית, <a href="http://he.wikipedia.org/wiki/AES">AES</a>), ולמה הצפנות מפתח פומבי הן עדיין בעייתיות?</p>

<p>התשובה לכך כפולה. ראשית, הצפנת מפתח פומבי היא איטית הרבה יותר מהצפנה סימטרית. זה לא הופך אותה לבלתי מעשית, כמובן; אבל זה הופך אותה להרבה פחות רצויה. לכן, הפתרון הוא אלגנטי ופשוט: כדי להתחיל תקשורת בין שני צדדים, הם משתמשים בהצפנה פומבית כדי להעביר בצורה בטוחה מפתח מצד אחד לשני. אחרי כן, שני הצדדים משתמשים במפתח המשותף הזה להצפנה סימטרית (מהירה פי כמה). זה גם מה שמשיגות שיטות לשיתוף מפתח, כמו דיפי-הלמן. זה גם מסביר מדוע עוסקים כל הזמן בפיתוח צפנים סימטריים חדשים דוגמת AES, ולא משתמשים פשוט בפנקס חד פעמי (שהוא, כזכור, הצפנה מושלמת) - בפנקס חד פעמי, אורך המפתח הוא כאורך ההודעה שמעבירים, ולכן אין טעם להעביר את המפתח בעזרת ההצפנה הציבורית - אפשר פשוט להעביר את ההודעה (טוב, זה לא נכון לגמרי - אפשר לשדר מפתח ארוך לפנקס חד פעמי בזמן שישנים בלילה ואין הודעות להעביר, למשל, אבל הבעיה העקרונית ברורה). חשוב להבהיר שמפתחות של הצפנות פומביות ולא פומביות הם <strong>קטנים</strong>. קטנים מאוד. אפשר לראות איך מפתח שכזה נראה אם בודקים את ה-<a href="http://en.wikipedia.org/wiki/Digital_certificate">Certificates</a> של הדפדפן שלכם (בפיירפוקס: Edit/Preferences/Advanced/Encryption/View Certificates ואז לבחור אחד אקראי ולחפש בו Subject’s Public Key). זכרו שזה מפתח ציבורי, כלומר של הצפנה שאינה סימטרית; מפתחות של הצפנה סימטרית קטנים בהרבה. עם מפתחות קטנים כאלו קל לעבוד, בניגוד לפנקס חד פעמי.</p>

<p>הבעיה השניה, והמהותית לא פחות, היא זו שמצריכה את קיום הדבר הזה, Certificate. לכאורה, שיטת המפתח הפומבי ביטלה את הצורך של אליס ובוב לתקשר בצורה בטוחה ולהעביר מפתח מאחד לשני. בפועל, עדיין קיימת סכנה כלשהי, הסכנה הבאה: נניח שאליס מפרסמת את המפתח הציבורי שלה “ברבים”. למשל, באתר האינטרנט שלה. בוב נכנס לאתר האינטרנט, מוריד את המפתח הציבורי ממנו, ושולח לאליס את מספר כרטיס האשראי שלו כשהוא שמח ומאושר. מה שבוב לא יודע הוא שאוסקר המרושע עבד עליו; הוא יירט את תקשורת האינטרנט שבה בוב ביקש לראות את האתר של אליס, ושלח אליו במקום זאת אתר שאמנם נראה בדיוק כמו האתר של אליס (שהרי את האתר של אליס אין בעיה להוריד בתור קובץ html ולשלוח לבוב) , אבל המפתח הציבורי שמופיע בו אינו זה של אליס, אלא זה של אוסקר דווקא. כעת, כל הודעה שבוב שולח ניתנת לפיענוח אך ורק על ידי אוסקר - ולכן, מספיק לו ליירט את ההודעה של בוב עם מספר כרטיס האשראי, לעשות בוחטה ולברוח.</p>

<p>זו אחת מהדוגמאות המעצבנות שבהן “העולם האמיתי” מתעקש לקחת רעיון קריפטוגרפי יפה ולזהם אותו. מה לעשות, שבעולם האינטרנט שבו כל בקשת תקשורת עוברת דרך המוני גורמים שונים ומשונים, התקפות כאלו (שמכונות “<a href="http://en.wikipedia.org/wiki/Man_in_the_middle">Man-in-the-middle-attack</a>”) הן פשוטות למדי לביצוע וחייבים להתייחס אליהן.</p>

<p>הפתרון? אין פתרון קסם. הפתרון הקיים כרגע הוא שאליס אולי תשים את המפתח הציבורי שלה באתר, אבל היא תשים שם יותר מאשר מפתח; היא תשים Certificate - תעודה שבה מופיע המפתח הציבורי שלה, ואישור של איזה שהוא גורם מוסמך שזה באמת המפתח של אליס. אחר כך, אם יתברר שטעינו, הגורם המוסמך יצטרך לתת על כך את הדין (מה יוצא לגורם המוסמך הזה? משלמים לו כסף על הנפקות של Certificate-ים שכאלו). השאלה איך אתה יודע שאפשר לסמוך על הגורם המוסמך היא עניין לדיון בפני עצמו - התשובה הפשוטה היא שאתה סומך על מישהו, שסומך על מישהו, שסומך על מישהו, שסומך על הגורם המוסמך הזה  - והמישהו המקורי שאתה סומך עליו, אתה סומך עליו כי פגשת אותו פיזית, או דבר מה דומה (בפועל, רשימה בסיסית של גורמים מוסמכים באה עם הדפדפן שלכם - ולכן השאלה היא האם אתם סומכים על המקור של הדפדפן, ושזה לא דפדפן רמאי שהושתל בידי אוסקר).</p>
<p align="right">רק דבר אחד לא ברור עד הסוף - מה זה ה"אישור" של הגורם המוסמך לפיו המפתח "של אליס" הוא באמת המפתח של אליס? איך מישהו יכול לתת אישור שכזה, בלי חשש מזיופים? באופן כללי יותר, איך אני יכול לראות הודעה כלשהי (בהינתן שאני יודע בודאות מהו המפתח הציבורי של אליס) ולהיות בטוח שהיא נשלחה מאליס ולא מאוסקר? התשובה לכך נעוצה באחד מהשימושים הנוספים שיש לקריפטוגרפיה בכלל ולמפתח ציבורי בפרט - <a href="http://he.wikipedia.org/wiki/%D7%97%D7%AA%D7%99%D7%9E%D7%94_%D7%90%D7%9C%D7%A7%D7%98%D7%A8%D7%95%D7%A0%D7%99%D7%AA">חתימות דיגיטליות</a>. על כך - בפוסט הבא.</p>

  </div>

  <hr />
  <p>
    נהניתם? התעניינתם? אם תרצו, אתם מוזמנים לתת טיפ:
  </p>
  <a href='https://ko-fi.com/H2H5XFBQ' target='_blank'><img height='36' style='border:0px;height:36px;' src='https://az743702.vo.msecnd.net/cdn/kofi2.png?v=2' border='0' alt='Buy Me a Coffee at ko-fi.com' /></a><a class="u-url" href="/blog/2007/11/22/public_key_cryptography" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/blog/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">לא מדויק</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">לא מדויק</li><li><a class="u-email" href="mailto:gadial@gmail.com">gadial@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/gadial"><svg class="svg-icon"><use xlink:href="/blog/assets/minima-social-icons.svg#github"></use></svg> <span class="username">gadial</span></a></li><li><a href="https://www.twitter.com/gadialeks"><svg class="svg-icon"><use xlink:href="/blog/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">gadialeks</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
