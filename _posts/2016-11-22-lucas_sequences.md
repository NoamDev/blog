---
id: 3385
title: "סדרות לוקאס ומבחני ראשוניות"
date: 2016-11-22 14:43:35
layout: post
categories: 
  - תורת המספרים
tags: 
  - אלגוריתם לוקאס-להמר
  - מספרים ראשוניים
  - סדרות לוקאס
  - ראשוני מרסן
  - שאריות ריבועיות
  - שדות סופיים
---
בפוסט הקודם התעסקתי בראשוניי מרסן והקשר הקרוב שלהם למספרים מושלמים. זה עשה לי חשק לדבר על עוד סיבה שבגללה ראשוניי מרסן הם מעניינים, אולי הסיבה הבולטת ביותר למי שלא מתעסקים במתמטיקה ונתקלים מדי פעם בכותרות בעיתונים: יש מבחן לבדיקת ראשוניות של מספרי מרסן שהוא <strong>יעיל בצורה יוצאת דופן</strong> ובזכותו הצלחנו לגלות מספרים ראשוניים שהם גדולים משמעותית ממה שכל שיטה אחרת מניבה לנו. בכל פעם בחמישים ומשהו השנים האחרונות שבה זעקו הכותרות על "התגלה הראשוני הגדול ביותר אי פעם!" זה היה ראשוני מרסן, שהתגלה באמצעות מבחן הראשוניות הזה, שנקרא <strong>מבחן לוקאס-להמר</strong> (כנראה שיש לכתוב "לוקה" כי כך מבטאים את השם, אבל "לוקאס" הוא הכתיב הפופולרי בעברית עבור המתמטיקאי הספציפי הזה). המבחן פשוט בצורה קיצונית, ולכן אציג אותו כמעט מייד; שארית הפוסט תעסוק בשאלה למה המבחן עובד, אבל תלך הרבה יותר רחוק מכך, אל תוצאות ורעיונות כלליים ומגניבים עוד יותר. המחיר יהיה פוסט טכני מאוד, כפי שלרוב קורה כשמתחילים לנבור בתוצאות כמו זו, אבל כל מי שיש לו ידע בסיסי כלשהו באלגברה מופשטת או תורת המספרים כנראה יוכל להבין את הרוב (אני אצטט פה ושם תוצאות בלי להוכיח, אבל גם הן לא משהו עמוק במיוחד).

המבחן מתבסס על סדרת מספרים שנקראת <strong>סדרת לוקאס-להמר</strong> ומתחילה כך: {::nomarkdown}\( 4,14,194,37634,1416317954\){:/nomarkdown}. הנוסחה שלה פשוטה מאוד: {::nomarkdown}\( a_{0}=4\){:/nomarkdown} ו-{::nomarkdown}\( a_{n+1}=a_{n}^{2}-2\){:/nomarkdown}. כלומר, כל איבר מתקבל על ידי העלאה בריבוע של קודמו וחיסור 2. כעת, למבחן: אם {::nomarkdown}\( p\){:/nomarkdown} הוא מספר ראשוני אז מספר מרסן {::nomarkdown}\( M_{p}=2^{p}-1\){:/nomarkdown} הוא ראשוני אם ורק אם {::nomarkdown}\( a_{p-2}\){:/nomarkdown} מתחלק ב-{::nomarkdown}\( M_{p}\){:/nomarkdown}. לכן רק צריך לחשב את {::nomarkdown}\( a_{p-2}\){:/nomarkdown} ולבדוק. בפועל החישוב הזה לא טריוויאלי לגמרי - מהר מאוד האיברים של לוקאס-להמר הופכים לענקיים בגודלם, אבל מצד שני לא צריך לזכור את כל האיבר אלא רק את השארית שלו בחלוקה ב-{::nomarkdown}\( M_{p}\){:/nomarkdown} ויש עוד תעלולים שלא אכנס אליהם כאן. השורה התחתונה היא שזה אלגוריתם יעיל מאוד.

אתם עשויים לשאול למה אני דורש ש-{::nomarkdown}\( p\){:/nomarkdown} יהיה ראשוני דווקא. הסיבה לכך פשוטה: אם {::nomarkdown}\( n\){:/nomarkdown} הוא מספר פריק, אז אין סיכוי ש-{::nomarkdown}\( 2^{n}-1\){:/nomarkdown} יהיה ראשוני. כי נניח ש-{::nomarkdown}\( n=ab\){:/nomarkdown} אז {::nomarkdown}\( 2^{ab}-1=\left(2^{a}\right)^{b}-1\){:/nomarkdown} וכשניקח את המשוואה הזו מודולו {::nomarkdown}\( 2^{a}-1\){:/nomarkdown}, נקבל {::nomarkdown}\( 2^{a}\equiv1\){:/nomarkdown} ולכן נקבל {::nomarkdown}\( 1^{b}-1\equiv0\){:/nomarkdown}, כלומר {::nomarkdown}\( 2^{a}-1\){:/nomarkdown} מחלק את {::nomarkdown}\( 2^{n}-1\){:/nomarkdown} (וכך גם {::nomarkdown}\( 2^{b}-1\){:/nomarkdown} ולכן עבור {::nomarkdown}\( n\){:/nomarkdown} לא ראשוני נמצא מחלק לא טריוויאלי של {::nomarkdown}\( 2^{n}-1\){:/nomarkdown}). לא הבנתם מה עשיתי פה? זו הייתה בדיקה כדי לראות אם אתם מכירים את מושגי היסוד שיהיו הכרחיים בהמשך הפוסט. לכל הפחות יהיה צורך להכיר <a href="http://www.gadial.net/2013/05/13/modular_arithmetic/">חשבון מודולרי</a>.

האלגוריתם הזה נראה כמו קסם. מאיפה בכלל צצה הסדרה הזו של לוקאס-להמר? איך ייתכן שתנאי כל כך פשוט כמו חלוקה מספיק בשביל לבדוק ראשוניות? איך בכלל מתחילים להוכיח משהו כזה? ובכן, האלגוריתם הזה הוא מקרה פרט של מבחן כללי יותר שמשתמש בקשר המעניין שיש בין ראשוניים ובין סדרות שמקיימות נוסחאות נסיגה מסויימות - סדרות שנקראות <strong>סדרות לוקאס</strong>. לוקאס-להמר הוא מה שמתקבל מהמבחן הזה כשהראשוניים הם מהצורה המאוד פשוטה של מספרי מרסן, וסדרת הלוקאס שבה משתמשים נבחרת בקפידה כדי להתאים למקרה הזה. ננסה להבין את הסיטואציה הכללית ואז נקטוף בסוף את לוקאס-להמר בתור מקרה פרטי.

הסיפור מתחיל ונגמר בסדרות לוקאס המדוברות. אלו סדרות של מספרים שלמים, שאסמן ב-{::nomarkdown}\( u_{0},u_{1},u_{2},\dots\){:/nomarkdown} שמקיימות את נוסחת הנסיגה {::nomarkdown}\( u_{n}=au_{n-1}-bu_{n-2}\){:/nomarkdown} כאשר {::nomarkdown}\( a,b\){:/nomarkdown} הם פרמטרים שלמים. הסדרה הידועה ביותר שהיא סדרת לוקאס היא סדרת <strong>מספרי פיבונאצ'י</strong> שמוגדרת על ידי {::nomarkdown}\( F_{0}=0,F_{1}=1\){:/nomarkdown} ו-{::nomarkdown}\( F_{n}=F_{n-1}+F_{n-2}\){:/nomarkdown}, כלומר זו סדרת לוקאס עם פרמטרים {::nomarkdown}\( a=1,b=-1\){:/nomarkdown} ותנאי התחלה {::nomarkdown}\( F_{0}=0\){:/nomarkdown} ו-{::nomarkdown}\( F_{1}=1\){:/nomarkdown}. יש עוד סדרות מספרים שמקיימות נוסחת נסיגה מסוג זה - למשל, מספרי מרסן בעצמם:

{::nomarkdown}\( M_{n}=2^{n}-1=3\left(2^{n-1}-1\right)-2\left(2^{n-2}-1\right)=3M_{n-1}-2M_{n-2}\){:/nomarkdown}

כלומר כאן {::nomarkdown}\( a=3,b=2\){:/nomarkdown} ותנאי ההתחלה הם {::nomarkdown}\( M_{0}=0,M_{1}=1\){:/nomarkdown}.

אם כי, כפי שנראה בהמשך, הסיבה לקיום מבחן הראשוניות המוצלח למספרי מרסן לא קשורה ישירות לכך שהם בעצמם מהווים סדרת לוקאס.

לא ממש הגבלתי את תנאי ההתחלה האפשריים עבור סדרות לוקאס, אבל מסתבר שהסדרות המעניינות ביותר מתקבלות עבור שני סטים אפשריים של ערכי התחלה. ראשית, ערכי ההתחלה {::nomarkdown}\( u_{0}=0,u_{1}=1\){:/nomarkdown} שנתנו לנו את פיבונאצ'י ואת מרסן, ושנית - תנאי ההתחלה {::nomarkdown}\( u_{0}=2\){:/nomarkdown} ו-{::nomarkdown}\( u_{1}=a\){:/nomarkdown} (כאשר {::nomarkdown}\( a\){:/nomarkdown} הוא הפרמטר שמגדיר את נוסחת הנסיגה: {::nomarkdown}\( u_{n}=au_{n-1}-bu_{n-2}\){:/nomarkdown}). בינתיים אדבר על סדרות שמתקבלות מתנאי ההתחלה הראשון. נתחיל בלראות משהו מגניב שקורה ספציפית בפיבונאצ'י, ואז נכליל אותו.

הדבר המגניב הוא זה: אם {::nomarkdown}\( n\){:/nomarkdown} הוא מספר ראשוני, אז {::nomarkdown}\( n\){:/nomarkdown} חייב לחלק את מספר פיבונאצ'י במקום שהוא "כמעט {::nomarkdown}\( n\){:/nomarkdown}". מה זאת אומרת "כמעט"? או שזה יהיה המספר במקום ה-{::nomarkdown}\( n\){:/nomarkdown}, או שזה יהיה המספר במקום ה-{::nomarkdown}\( n+1\){:/nomarkdown} או שזה יהיה המספר במקום ה-{::nomarkdown}\( n-1\){:/nomarkdown}. זה תלוי בתכונה כלשהי של {::nomarkdown}\( n\){:/nomarkdown}. במפורש:
<ul>
	<li>אם {::nomarkdown}\( n\){:/nomarkdown} מתחלק ב-{::nomarkdown}\( 5\){:/nomarkdown} אז {::nomarkdown}\( n\){:/nomarkdown} מחלק את {::nomarkdown}\( F_{n}\){:/nomarkdown}.</li>
	<li>אם {::nomarkdown}\( n\){:/nomarkdown} מחזיר שארית 1 או 4 בחלוקה ב-5 אז {::nomarkdown}\( n\){:/nomarkdown} מחלק את {::nomarkdown}\( F_{n-1}\){:/nomarkdown}.</li>
	<li>אם {::nomarkdown}\( n\){:/nomarkdown} מחזיר שארית 2 או 3 בחלוקה ב-5 אז {::nomarkdown}\( n\){:/nomarkdown} מחלק את {::nomarkdown}\( F_{n+1}\){:/nomarkdown}.</li>
</ul>
בואו נראה דוגמאות. נכתוב את האיברים הראשונים של פיבונאצ'י: {::nomarkdown}\( 0,1,1,2,3,5,8,13,21,34,55\){:/nomarkdown}. עכשיו בואו נעבור על ראשוניים: 2 מחזיר שארית 2 בחלוקה ב-{::nomarkdown}\( 5\){:/nomarkdown} ואכן מחלק את {::nomarkdown}\( F_{3}=2\){:/nomarkdown}. 3 אכן מחלק את {::nomarkdown}\( F_{4}=3\){:/nomarkdown}. 5 אכן מחלק את {::nomarkdown}\( F_{5}=5\){:/nomarkdown}. 7 אכן מחלק את {::nomarkdown}\( F_{8}=21\){:/nomarkdown}. 11 אכן מחלק את {::nomarkdown}\( F_{10}=55\){:/nomarkdown}, וזה נמשך ונמשך ונמשך. זו תוצאה ממש נחמדה! האם היא מספיקה כדי <strong>להוכיח</strong> שמספר הוא ראשוני? ובכן, לא: אפשר להראות, למשל, ש-323 מחלק את {::nomarkdown}\( F_{324}\){:/nomarkdown} אבל הוא לא ראשוני כי {::nomarkdown}\( 323=17\cdot19\){:/nomarkdown}. לכן למספר שמקיים את הקריטריון הזה קוראים <strong>פסאודוראשוני פיבונאצ'י</strong>. לא כדאי לזלזל במבחנים שבודקים אם מספר הוא פסאודוראשוני: זו דרך מאוד טובה לסנן מספרים פריקים לפני שזורקים עליהם אלגוריתם שיודע להוכיח ראשוניות והוא כנראה כבד יחסית. מבחן פסואודוראשוניות אחד כנראה לא יהיה מספיק, אבל אם משלבים כמה מקבלים סינון אפקטיבי מאוד.

עכשיו בואו נוריד חלק מהמיסטיקה סביב הניסוח של המשפט הזה. ה"כמעט במקום ה-{::nomarkdown}\( n\){:/nomarkdown}" הוא מעצבן כי הוא מייצר חלוקה למקרים שנראית שרירותית מאוד, אבל בפועל היא לא שרירותית בכלל: היא תלויה בשאלה האם {::nomarkdown}\( n\){:/nomarkdown} הוא <strong>שארית ריבועית</strong> מודולו {::nomarkdown}\( 5\){:/nomarkdown}. יש לי <a href="http://www.gadial.net/2009/06/26/sums_of_squares_and_quadratic_reciprocity/">פוסט בנושא</a> אבל הנה תזכורת: מספר {::nomarkdown}\( a\){:/nomarkdown} הוא שארית ריבועית מודולו {::nomarkdown}\( n\){:/nomarkdown} אם הוא ריבוע ב-{::nomarkdown}\( \mathbb{Z}_{n}^{*}\){:/nomarkdown}, כלומר אם למשוואה {::nomarkdown}\( x^{2}=n\){:/nomarkdown} קיים פתרון ב-{::nomarkdown}\( \mathbb{Z}_{n}^{*}\){:/nomarkdown}. ספציפית עבור {::nomarkdown}\( z=5\){:/nomarkdown} קל לראות שעבור 1 ו-4 יש פתרונות (1 ו-2, כמובן) אבל עבור 2 ו-3 אין פתרונות (כי 3 בריבוע מודולו 5 נותן 4 ואילו 4 בריבוע נותן 1 - אלו השורשים הנוספים שיש ל-1 ו-4, כי בשדה כמו {::nomarkdown}\( \mathbb{Z}_{5}\){:/nomarkdown} אם למספר יש שורש יש לו בדיוק שני שורשים). שימו לב שההגדרה שלי דיברה על {::nomarkdown}\( \mathbb{Z}_{n}^{*}\){:/nomarkdown}, כלומר על אוסף כל המספרים <strong>שזרים</strong> ל-5; לכן המקרה של {::nomarkdown}\( n\){:/nomarkdown} מתחלק ב-5 הוא מיוחד.

כעת, יש סימון מקובל לתיאור האם מספר הוא שארית ריבועית או לא, שהתגלה כשימושי במיוחד והוא שימושי גם כאן: אם {::nomarkdown}\( p\){:/nomarkdown} ראשוני ו-{::nomarkdown}\( n\){:/nomarkdown} הוא מספר כלשהו, אז {::nomarkdown}\( \left(\frac{n}{p}\right)=1\){:/nomarkdown} אם {::nomarkdown}\( n\){:/nomarkdown} הוא שארית ריבועית מודולו {::nomarkdown}\( p\){:/nomarkdown}, {::nomarkdown}\( \left(\frac{n}{p}\right)=-1\){:/nomarkdown} אם {::nomarkdown}\( n\){:/nomarkdown} הוא לא שארית ריבועית אבל זר ל-{::nomarkdown}\( p\){:/nomarkdown}, ואילו {::nomarkdown}\( \left(\frac{n}{p}\right)=0\){:/nomarkdown} אם {::nomarkdown}\( n\){:/nomarkdown} לא זר ל-{::nomarkdown}\( p\){:/nomarkdown}. לסימן הזה קוראים <strong>סימן לז'נדר</strong> (ובמקרה שבו ה"מכנה" הוא לא ראשוני, קוראים לו <strong>סימן יעקובי</strong>). צריך כמובן לומר במפורש שהסימן הזה <strong>לא מתאר שבר</strong>. קו השבר בין {::nomarkdown}\( n\){:/nomarkdown} ל-{::nomarkdown}\( p\){:/nomarkdown} הוא סתם סימון, ומההקשר מבינים שלא מדובר על שבר. עכשיו אפשר לנסח את המשפט בצורה קצת יותר קומפקטית: אם {::nomarkdown}\( n\){:/nomarkdown} הוא ראשוני, אז {::nomarkdown}\( n\){:/nomarkdown} מחלק את {::nomarkdown}\( F_{n-\left(\frac{n}{5}\right)}\){:/nomarkdown}. הנה, הסימון כבר מתחיל לעבוד לטובתנו.

עד עכשיו נראה היה שתיארתי תכונה מעניינת <strong>של סדרת פיבונאצ'י</strong>. אבל בפועל מדובר על תכונה מעניינת של סדרות לוקאס באופן כללי - ליתר דיוק, אלו עם תנאי ההתחלה 0,1. הנה המשפט הכללי: תהא {::nomarkdown}\( U_{k}\){:/nomarkdown} סדרת לוקאס עם תנאי התחלה {::nomarkdown}\( 0,1\){:/nomarkdown} ונוסחת נסיגה {::nomarkdown}\( U_{k}=aU_{k-1}-bU_{k-2}\){:/nomarkdown}. נסמן {::nomarkdown}\( \Delta=a^{2}-4b\){:/nomarkdown}. אם {::nomarkdown}\( p\){:/nomarkdown} הוא מספר ראשוני שזר ל-{::nomarkdown}\( 2b\Delta\){:/nomarkdown} אז {::nomarkdown}\( p\){:/nomarkdown} מחלק את {::nomarkdown}\( U_{p-\left(\frac{\Delta}{p}\right)}\){:/nomarkdown}.

מה קורה אצל פיבונאצ'י? במקרה הזה {::nomarkdown}\( a=1,b=-1\){:/nomarkdown} ולכן {::nomarkdown}\( \Delta=1^{2}+4=5\){:/nomarkdown} - מכאן הגיע ה-5 הזה. כעת, {::nomarkdown}\( 2b\Delta=10\){:/nomarkdown} ולכן כל ראשוני פרט ל-{::nomarkdown}\( 2,5\){:/nomarkdown} זר ל-{::nomarkdown}\( 2b\Delta\){:/nomarkdown} (ועבורם המשפט עובד בכל מקרה כאן). לכן המסקנה היא ש-{::nomarkdown}\( p\){:/nomarkdown} מחלק את {::nomarkdown}\( U_{p-\left(\frac{5}{p}\right)}\){:/nomarkdown}. זה נראה <strong>כמעט</strong> כמו המשפט על פיבונאצ'י רק ששמשהו התהפך כאן: כתוב {::nomarkdown}\( \left(\frac{5}{p}\right)\){:/nomarkdown} במקום {::nomarkdown}\( \left(\frac{p}{5}\right)\){:/nomarkdown}. הסיבה לכך שאפשר לבצע את ההיפוך הזה היא משפט נפלא שנקרא <strong>משפט ההדדיות הריבועית</strong> שאומר שאם {::nomarkdown}\( p,q\){:/nomarkdown} הם ראשוניים אז {::nomarkdown}\( \left(\frac{p}{q}\right)\left(\frac{q}{p}\right)=\left(-1\right)^{\left(\frac{p-1}{2}\right)\left(\frac{q-1}{2}\right)}\){:/nomarkdown}, ובמילים: אם {::nomarkdown}\( p\){:/nomarkdown} או {::nomarkdown}\( q\){:/nomarkdown} שקולים ל-1 מודולו 4 אז {::nomarkdown}\( \left(\frac{p}{q}\right)=\left(\frac{q}{p}\right)\){:/nomarkdown}, ואם שניהם שקולים ל-3 מודולו 4 אז {::nomarkdown}\( \left(\frac{p}{q}\right)=-\left(\frac{q}{p}\right)\){:/nomarkdown}. מכיוון ש-{::nomarkdown}\( 5\){:/nomarkdown} שקול ל-1 מודולו 4 אנחנו במקרה הראשון ולכן ניתן "להפוך" כפי שהפכנו.

עכשיו לשאלה המעניינת - למה המשפט הכללי נכון? כאן מגיעים הניסים והנפלאות. הרעיון הבסיסי יהיה לחשוב על אברי הסדרה {::nomarkdown}\( U_{k}\){:/nomarkdown} לא בתור "סתם" מספרים שלמים, אלא בתור יצורים שחיים בתוך מרחב גדול יותר - <strong>השדה הסופי</strong> {::nomarkdown}\( \mathbb{F}_{p^{2}}\){:/nomarkdown}. תכף אסביר בדיוק על מה מדובר, אבל לפני כן אני רוצה להתלהב מהרעיון הכללי כאן. זו תופעה מאוד נפוצה במתמטיקה בכלל, ובתורת המספרים בפרט: יש לנו אובייקט שאנחנו מסוגלים להבין אינטואיטיבית, אבל פתאום צצות תכונות יפהפיות שלו שאין לנו מושג איך להסביר באמצעות התיאור הרגיל שלנו של האובייקט. רק כשאנחנו מתחילים לחשוב על האובייקט בתור משהו שחי בעולם גדול יותר, ומסובך יותר, ואולי גם נוגד אינטואיציה הרבה יותר, פתאום התכונות מתחילות לצוץ כמעט מאליהן. זה מתרחש בגלל שהאובייקט שלנו מקיים יחסי גומלין עם האובייקטים של העולם הגדול והמסובך יותר, גם אם מבחינתנו זה שקוף לחלוטין כל עוד אנחנו נשארים בחיק החמים של האינטואיציה שלנו, שמסתירה מפנינו את העולם הגדול יותר. כמה פעמים שמעתם מישהו אומר ש"הוא לא מבין למה מספרים מרוכבים הם מספרים בכלל"? זו דוגמת האבטיפוס: יש שלל תכונות שהדרך הנכונה להבין מדוע המספרים הממשיים/השלמים מקיימים אותן שצצות רק כשחושבים על המספרים הללו בתור יצורים שחיים בשדה המספרים המרוכבים. למרוכבים לא אכפת אם אתם מקבלים אותם או לא; הם קיימים, והם מרתקים, וגם אם אנחנו מנסים לאטום את החלון ולא לראות אותם, מדי פעם קרני שמש חודרות מבעד למעטה שלנו ונופלות על אותו חלק קטן מהמספרים המרוכבים שאנחנו מוכנים ברוב טובנו להכיר בקיומו.

טוב, מספיק עם הפילוסופיה; היא דרושה כדי להכין אתכם לזבנג שאני הולך לתת עוד שניה למי שלא רגיל לנושאים הללו. כאמור, אני רוצה לחשוב על ה-{::nomarkdown}\( U_{k}\){:/nomarkdown}-ים בתור איברים בשדה סופי עם {::nomarkdown}\( p^{2}\){:/nomarkdown} איברים. <a href="http://www.gadial.net/2011/07/11/fields_and_how_can_they_be_finite/">יש לי כאן הסברים</a> על מהם שדות כאלו אז לא אכנס למלוא הפרטים כרגע. השאלה המעניינת מבחינתנו היא איך אנחנו רוצים <strong>לייצג</strong> את אברי השדה הסופי הזה. השיטה המקובלת לבנייה של שדה סופי בן {::nomarkdown}\( p^{2}\){:/nomarkdown} איברים היא זו: מתחילים מהשדה {::nomarkdown}\( \mathbb{Z}_{p}=\left\{ 0,1,\dots,p-1\right\} \){:/nomarkdown}, ולוקחים פולינום {::nomarkdown}\( f\left(x\right)\){:/nomarkdown} ממעלה שניה מעליו שהוא <strong>אי פריק</strong>, כלומר שאין לו שורש ב-{::nomarkdown}\( \mathbb{Z}_{p}\){:/nomarkdown}. ועכשיו מסתכלים על <strong>חוג המנה</strong> שמתקבל כשמחלקים את חוג הפולינומים מעל {::nomarkdown}\( \mathbb{Z}_{p}\){:/nomarkdown} באידאל שנוצר מהפולינום {::nomarkdown}\( f\left(x\right)\){:/nomarkdown}. מה זה אומר בתכל'ס? שמסתכלים על קבוצת הפולינומים מהצורה {::nomarkdown}\( sx+t\){:/nomarkdown} עם פעולות חיבור וכפל "מודולו {::nomarkdown}\( f\left(x\right)\){:/nomarkdown}" - כלומר, אחרי שמחברים או כופלים מחלקים ב-{::nomarkdown}\( f\left(x\right)\){:/nomarkdown} ולוקחים את השארית (בפועל על חיבור זה לא משפיע, רק על כפל).

עכשיו מגיע החלק המוזר למראה. כזכור, אנחנו מסתכלים על הסדרה {::nomarkdown}\( U_{k}\){:/nomarkdown} שמוגדרת על ידי הפרמטרים {::nomarkdown}\( a,b\){:/nomarkdown}. זה אומר שמתקיים {::nomarkdown}\( U_{k+2}=aU_{k+1}-bU_{k}\){:/nomarkdown}. בואו נשחק לרגע משחק: במקום {::nomarkdown}\( U_{k+i}\){:/nomarkdown} נכתוב {::nomarkdown}\( x^{i}\){:/nomarkdown}. כלומר, {::nomarkdown}\( x^{2}=ax^{1}-bx^{0}\){:/nomarkdown} או בקיצור {::nomarkdown}\( x^{2}=ax-b\){:/nomarkdown}. נעביר אגפים ונקבל {::nomarkdown}\( x^{2}-ax+b=0\){:/nomarkdown}. בואו נקרא לפולינום שבצד שמאל {::nomarkdown}\( f\left(x\right)\){:/nomarkdown}, כלומר {::nomarkdown}\( f\left(x\right)=x^{2}-ax+b\){:/nomarkdown}. הפולינום הזה מאפשר לנו להגדיר את הסדרה {::nomarkdown}\( U_{k}\){:/nomarkdown} בתור <strong>סדרה של פולינומים</strong> באופן הבא, שייראה לכם מאוד מוזר במבט ראשון ולכן אני מבטיח שהוא מאוד שימושי:

{::nomarkdown}\( U_{k}\triangleq\frac{x^{k}-\left(a-x\right)^{k}}{x-\left(a-x\right)}\left(\mbox{mod }f\left(x\right)\right)\){:/nomarkdown}

מה טוב בהגדרה המוזרה הזו? שזו <strong>לא הגדרה רקורסיבית</strong>. מצד שני, קל לראות שהיא מגדירה את הסדרה {::nomarkdown}\( U_{k}\){:/nomarkdown} שתיארתי קודם. בפרט, זו נראית כמו סדרה של פולינומים, אבל בפועל נקבל סדרה של מספרים שלמים. כדי לראות את זה, בואו קודם כל נציב {::nomarkdown}\( k=0\){:/nomarkdown} ונקבל

{::nomarkdown}\( U_{0}=\frac{x^{0}-\left(a-x\right)^{0}}{x-\left(a-x\right)}=\frac{1-1}{x-\left(a-x\right)}=0\){:/nomarkdown}

וכעת נציב {::nomarkdown}\( k=1\){:/nomarkdown} ונקבל

{::nomarkdown}\( U_{1}=\frac{x^{1}-\left(a-x\right)^{1}}{x-\left(a-x\right)}=\frac{x-\left(a-x\right)}{x-\left(a-x\right)}=1\){:/nomarkdown}

אז קיבלנו את הערכים ההתחלתיים שציפינו להם. כעת, למה {::nomarkdown}\( U_{k}\){:/nomarkdown} מקיים את נוסחת הנסיגה? בשביל זה צריך להבין מה המשמעות של חישובים מודולו {::nomarkdown}\( f\left(x\right)\){:/nomarkdown}. זה אומר שאנחנו יכולים להחליף כל מופע של {::nomarkdown}\( x^{2}-ax+b\){:/nomarkdown} באפס, או באופן שקול, להחליף כל מופע של {::nomarkdown}\( x^{2}\){:/nomarkdown} ב-{::nomarkdown}\( ax-b\){:/nomarkdown} וההפך. אז בואו נעשה חישובים עם הנשק החדש הזה שלנו:

{::nomarkdown}\( x^{2}=ax-b\){:/nomarkdown}

{::nomarkdown}\( \left(a-x\right)^{2}=a^{2}-2ax+x^{2}=a^{2}-2ax+\left(ax-b\right)=a^{2}-ax-b=a\left(a-x\right)-b\){:/nomarkdown}

ולכן:

{::nomarkdown}\( x^{k+2}=x^{k}\left(ax-b\right)=ax^{k+1}-bx^{k}\){:/nomarkdown}

{::nomarkdown}\( \left(a-x\right)^{k+2}=\left(a-x\right)^{k}\left(a-x\right)^{2}=a\left(a-x\right)^{k+1}-b\left(a-x\right)^{k}\){:/nomarkdown}

ומכאן:

{::nomarkdown}\( U_{k+2}=\frac{x^{k+2}-\left(a-x\right)^{k+2}}{x-\left(a-x\right)}=a\frac{x^{k+1}-\left(a-x\right)^{k+1}}{x-\left(a-x\right)}-b\frac{x^{k}-\left(a-x\right)^{k}}{x-\left(a-x\right)}=aU_{k+1}-bU_{k}\){:/nomarkdown}

כלומר, ה-{::nomarkdown}\( U_{k}\){:/nomarkdown} היא עדיין הסדרה המוכרת והאהובה עלינו, רק כתובה בצורה מוזרה עם פולינומים שבסוף בכלל לא באים לידי ביטוי כי כל האיקסים מצטמצמים. אבל הפולינומים הללו הם בדיוק ה"עולם רחב יותר" שאני מדבר עליו.

בואו נחזור לרגע לדבר על העולם ונראה במפורש איך מתנהגות פעולות החיבור והכפל בו. זכרו: הן מתנהגות כמו חיבור וכפל פולינומים רגיל, בתוספת היכולת שלנו להשתמש במשוואה {::nomarkdown}\( x^{2}=ax-b\){:/nomarkdown}. לכן נקבל:

{::nomarkdown}\( \left(s_{1}x+t_{1}\right)+\left(s_{2}x+t_{2}\right)=\left(s_{1}+s_{2}\right)x+\left(t_{1}+t_{2}\right)\){:/nomarkdown}

{::nomarkdown}\( \left(s_{1}x+t_{1}\right)\cdot\left(s_{2}x+t_{2}\right)=s_{1}s_{2}x^{2}+\left(s_{1}t_{2}+s_{2}t_{1}\right)x+t_{1}t_{2}=\){:/nomarkdown}

{::nomarkdown}\( \left(s_{1}t_{2}+s_{2}t_{1}+as_{1}s_{2}\right)x+\left(t_{1}t_{2}-bs_{1}s_{2}\right)\){:/nomarkdown}

זה ייצוג מפורש של פעולות החשבון, גם עבור מי שלא מבין את הדיבורים הגבוהים על חלוקה באידאלים של חוגי פולינומים. עכשיו אפשר לעבור לאקשן של הוכחת המשפט. המשפט, כזכור, אומר שאם {::nomarkdown}\( p\){:/nomarkdown} הוא מספר ראשוני שזר ל-{::nomarkdown}\( 2b\Delta\){:/nomarkdown} אז {::nomarkdown}\( p\){:/nomarkdown} מחלק את {::nomarkdown}\( U_{p-\left(\frac{\Delta}{p}\right)}\){:/nomarkdown}, כאשר {::nomarkdown}\( \Delta=a^{2}-4b\){:/nomarkdown}.

הגיע הזמן להבין מאיפה הגיע {::nomarkdown}\( \Delta\){:/nomarkdown} הזה. אולי אתם זוכרים מהתיכון שזה סימון של <strong>דיסקרימיננטה</strong>, שזה "המשהו שמתחת לשורש" בפתרון משוואה ריבועית. זה לא מקרי. ההפרדה למקרים שלנו עוסקת בדיוק בשאלה האם הפולינום {::nomarkdown}\( x^{2}-ax+b\){:/nomarkdown} הוא אי-פריק (ואז חלוקה בו נותנת שדה) או שהוא פריק (ואז עדיין אפשר להגדיר את פעולות החשבון כמו למעלה אבל נקבל משהו שאינו שדה). לשם כך משתמשים בנוסחת השורשים, שנכונה גם מעל שדות סופיים: שורשי הפולינום הזה הם {::nomarkdown}\( \frac{a\pm\sqrt{a^{2}-4b}}{2}=\frac{a\pm\sqrt{\Delta}}{2}\){:/nomarkdown} ולכן יש לפולינום הזה שורש אם ורק אם ל-{::nomarkdown}\( \Delta\){:/nomarkdown} יש שורש, כלומר אם ורק אם {::nomarkdown}\( \left(\frac{\Delta}{p}\right)=1\){:/nomarkdown} (בלתי אפשרי שיתקיים ש-{::nomarkdown}\( \Delta\){:/nomarkdown} היא 0 ב-{::nomarkdown}\( \mathbb{Z}_{p}\){:/nomarkdown} כי המשמעות של כך היא ש-{::nomarkdown}\( \Delta\){:/nomarkdown} לא זרה ל-{::nomarkdown}\( p\){:/nomarkdown}, בניגוד להנחה שלנו).

אם {::nomarkdown}\( \left(\frac{\Delta}{p}\right)=-1\){:/nomarkdown}, כלומר {::nomarkdown}\( \Delta\){:/nomarkdown} איננו ריבוע, קיבלנו שאוסף הפולינומים שלנו מודולו {::nomarkdown}\( f\left(x\right)\){:/nomarkdown} הוא שדה. עכשיו מגיע השלב שבו אנחנו מגלים שמשתלם לנו לחשוב לא רק על מספרים שלמים אלא גם על עולם רחב יותר מזה - אפשר להשתמש בידע שיש לנו בתורת השדות. ספציפית, הידע הזה מלמד אותנו במקרה הזה שבתוך השדה שלנו, {::nomarkdown}\( x^{p}=a-x\){:/nomarkdown} ואילו {::nomarkdown}\( \left(a-x\right)^{p}=x\){:/nomarkdown}. למה? ובכן, ראשית נשים לב לכך שבתוך השדה שבנינו, {::nomarkdown}\( x\){:/nomarkdown} הוא שורש של הפולינום {::nomarkdown}\( f\left(t\right)=t^{2}-at+b\){:/nomarkdown} (אני כותב אותו בכוונה עם {::nomarkdown}\( t\){:/nomarkdown} הפעם כדי לא ליצור בלבול - ה-{::nomarkdown}\( x\){:/nomarkdown} הוא איבר של ממש בשדה, בעוד שסימון המשתנה שאיתו אנחנו בוחרים לתאר פולינום הוא לגמרי בשליטתנו). כמו כן, אפשר לראות שגם {::nomarkdown}\( a-x\){:/nomarkdown} הוא שורש של הפולינום הזה, על ידי הצבה ישירה:

{::nomarkdown}\( \left(a-x\right)^{2}-a\left(a-x\right)+b=a^{2}-2ax+x^{2}-a^{2}+ax+b=-ax+ax-b+b=0\){:/nomarkdown}

עכשיו, תוצאה בסיסית בתורת השדות היא שבהינתן שדה סופי {::nomarkdown}\( \mathbb{F}_{p^{k}}\){:/nomarkdown}, הפונקציה {::nomarkdown}\( a\mapsto a^{p}\){:/nomarkdown} היא <strong>אוטומורפיזם</strong> של השדה, שזוכה לשם המיוחד <strong>אוטומורפיזם פרובניוס</strong>. ידוע גם שהפונקציה הזו היא הזהות בדיוק על שדה הבסיס {::nomarkdown}\( \mathbb{F}_{p}=\mathbb{Z}_{p}\){:/nomarkdown}, ואנחנו יודעים בדיוק מה עושה אוטומורפיזם של שדה {::nomarkdown}\( E\){:/nomarkdown} שהוא הזהות בדיוק על שדה הבסיס {::nomarkdown}\( F\){:/nomarkdown}, כשנותנים לו שורשים של פולינומים שהמקדמים שלהם כולם מתוך {::nomarkdown}\( F\){:/nomarkdown}: הוא חייב לבצע <strong>פרמוטציה</strong> של השורשים הללו. כלומר, חופש הבחירה של האוטומורפיזם לאן הוא רוצה לשלוח את השורשים מוגבל לשורשים אחרים של אותו הפולינום. האבחנה הזו היא הבסיס לתורת גלואה, אבל לא אכנס לכך כרגע. השורה התחתונה היא שלמי שיש נסיון בתורת השדות ברור כמעט מייד שיתקיימו שני השוויונות שכתבתי למעלה. וזה אומר את הדבר הבא:

{::nomarkdown}\( U_{p+1}=\frac{x^{p+1}-\left(a-x\right)^{p+1}}{x-\left(a-x\right)}=\frac{x\left(a-x\right)-\left(a-x\right)x}{x-\left(a-x\right)}=0\){:/nomarkdown}

כלומר, {::nomarkdown}\( U_{p+1}\){:/nomarkdown} מתחלק ב-{::nomarkdown}\( p\){:/nomarkdown}, בדיוק כפי שרצינו.

המקרה השני, {::nomarkdown}\( \left(\frac{\Delta}{p}\right)=1\){:/nomarkdown}, הוא קצת שונה אבל בצורה שהופכת אותו לפשוט יותר. במקרה הזה אוסף הפולינומים שלנו לא מהווה שדה אלא "סתם" חוג - אז איזה חוג זה? בעזרת <a href="http://www.gadial.net/2012/09/12/chinese_remainder_theorem/">משפט השאריות הסיני</a> בגרסה מוכללת שלו אפשר להראות שאם מחלקים חוג {::nomarkdown}\( R\){:/nomarkdown} במכפלה של אידאלים {::nomarkdown}\( IJ\){:/nomarkdown} אז מקבלים את המכפלה של חלוקת החוג בכל אידאל בנפרד, כלומר {::nomarkdown}\( R/IJ\cong R/I\times R/J\){:/nomarkdown}. במקרה שלנו אנחנו מחלקים באידאל שנוצר על ידי פולינום; אם הפולינום מתפרק, אפשר לכתוב את האידאל שהוא יוצר בתור מכפלת האידאלים של המרכיבים של הפירוק. כל אחד מהם הוא פולינום ממעלה 1 ולכן החוג שמתקבל מחלוקה בהם איזומורפי לחוג המקורי. כל להטוטי האלגברה הללו מובילים למסקנה הפשוטה: במקרה השני החוג שלנו הוא {::nomarkdown}\( \mathbb{Z}_{p}\times\mathbb{Z}_{p}\){:/nomarkdown}. החוג הזה נחמד מאוד כי קל לראות שכאשר מעלים איבר <strong>כלשהו</strong> בו בחזקת {::nomarkdown}\( p\){:/nomarkdown} מקבלים חזרה את האיבר המקורי. לכן במקרה הזה {::nomarkdown}\( x^{p}=x\){:/nomarkdown} ו-{::nomarkdown}\( \left(a-x\right)^{p}=a-x\){:/nomarkdown} ולכן אחרי צמצום (צריך לנמק למה אפשר לצמצם את האיברים הללו - נסו!) מקבלים {::nomarkdown}\( x^{p-1}=\left(a-x\right)^{p-1}=1\){:/nomarkdown} ואנחנו מקבלים:

{::nomarkdown}\( U_{p-1}=\frac{x^{p-1}-\left(a-x\right)^{p-1}}{x-\left(a-x\right)}=\frac{1-1}{x-\left(a-x\right)}=0\){:/nomarkdown}

כלומר {::nomarkdown}\( U_{p-1}\){:/nomarkdown} מתחלק ב-{::nomarkdown}\( p\){:/nomarkdown}, כפי שרצינו.

סיימנו את ההוכחה של משפט מאוד נחמד שנותן לנו מבחן של פסאודוראשוניות, אבל בואו נתאפס לרגע - התחלנו את הפוסט הזה עם אלגוריתם לוקאס-להמר ואנחנו עדיין ממש לא שם. על פניו כל מה שעשינו כרגע בכלל לא היה קשור. בפועל אנחנו כבר מאוד קרובים אל לוקאס-להמר, אבל לפני כן אני צריך להציג מבחן כללי יותר שיכול להוכיח ראשוניות - נקרא לו "מבחן ה-{::nomarkdown}\( n+1\){:/nomarkdown}". לוקאס-להמר יתקבל בתור מקרה פרטי נחמד במיוחד שלו.

המבחן אומר את הדבר הבא: בואו ניקח {::nomarkdown}\( f\left(x\right)=x^{2}-ax+b\){:/nomarkdown} כמו קודם ונסמן {::nomarkdown}\( \Delta=a^{2}-4b\){:/nomarkdown} כמו קודם, וניקח מספר {::nomarkdown}\( n\){:/nomarkdown} חיובי כלשהו שהוא זר ל-{::nomarkdown}\( 2b\){:/nomarkdown} ומקיים {::nomarkdown}\( \left(\frac{\Delta}{n}\right)=-1\){:/nomarkdown}. ראשית כל נבדוק האם {::nomarkdown}\( U_{n+1}\){:/nomarkdown} מתחלק ב-{::nomarkdown}\( n\){:/nomarkdown}, כמו קודם: אם {::nomarkdown}\( n\){:/nomarkdown} ראשוני זה חייב להתקיים. אבל זה לא מספיק כדי להוכיח שהוא ראשוני. אבל אפשר לחזק את זה: בואו ניקח מחלק <strong>כלשהו</strong> של {::nomarkdown}\( n+1\){:/nomarkdown} ונסמן אותו ב-{::nomarkdown}\( F\){:/nomarkdown}. נניח שאנחנו מכירים את הפירוק לגורמים ראשוניים של {::nomarkdown}\( F\){:/nomarkdown}. לכל גורם ראשוני {::nomarkdown}\( q\){:/nomarkdown} של {::nomarkdown}\( F\){:/nomarkdown}, נבדוק אם {::nomarkdown}\( U_{\frac{n+1}{q}}\){:/nomarkdown} זר ל-{::nomarkdown}\( n\){:/nomarkdown}. אם כן, זה מוכיח שלכל {::nomarkdown}\( p\){:/nomarkdown} ראשוני שמחלק את {::nomarkdown}\( n\){:/nomarkdown} מתקיים {::nomarkdown}\( p\equiv\left(\frac{\Delta}{p}\right)\){:/nomarkdown} מודולו {::nomarkdown}\( F\){:/nomarkdown}.

רגע, מה? המסקנה של המשפט ממש לא ברורה. את מי זה מעניין? ובכן עבור ערכים קטנים של {::nomarkdown}\( F\){:/nomarkdown} זה לא כל כך מעניין. אבל נניח ש-{::nomarkdown}\( n\){:/nomarkdown} לא ראשוני ולקחנו {::nomarkdown}\( F&gt;\sqrt{n}+1\){:/nomarkdown}, אז בהכרח <strong>כל</strong> הגורמים הראשוניים של {::nomarkdown}\( n\){:/nomarkdown} יהיו קטנים מ-{::nomarkdown}\( F\){:/nomarkdown}, ולכן מודולו {::nomarkdown}\( F\){:/nomarkdown} יהיו שווים לעצמם. מה שאומר שהמשוואה {::nomarkdown}\( p\equiv\left(\frac{\Delta}{p}\right)\){:/nomarkdown} לא תוכל להתקיים בכלל. מכאן שאם מצאנו {::nomarkdown}\( F&gt;\sqrt{n}+1\){:/nomarkdown} שמקיים את הבדיקה שלעיל ({::nomarkdown}\( U_{\frac{n+1}{q}}\){:/nomarkdown} זר ל-{::nomarkdown}\( n\){:/nomarkdown} לכל {::nomarkdown}\( q\){:/nomarkdown} ראשוני שמחלק את {::nomarkdown}\( F\){:/nomarkdown}), זה מוכיח ש-{::nomarkdown}\( n\){:/nomarkdown} ראשוני.

למה זה נכון? ובכן, ראשית בואו נסמן ב-{::nomarkdown}\( r_{f}\left(n\right)\){:/nomarkdown} את האינדקס של המספר הראשון בסדרה {::nomarkdown}\( U_{k}\){:/nomarkdown} שמתחלק ב-{::nomarkdown}\( n\){:/nomarkdown}. קוראים לזה <strong>דרגת ההופעה</strong> של {::nomarkdown}\( n\){:/nomarkdown}. אפשר להוכיח עם קצת עבודה טכנית שאדלג עליה שדרגת ההופעה של {::nomarkdown}\( n\){:/nomarkdown} מחלקת כל מופע אחר של {::nomarkdown}\( n\){:/nomarkdown}: דהיינו, {::nomarkdown}\( U_{k}\){:/nomarkdown} כלשהו מתחלק ב-{::nomarkdown}\( n\){:/nomarkdown} אם ורק אם {::nomarkdown}\( k\){:/nomarkdown} מתחלק ב-{::nomarkdown}\( r_{f}\left(n\right)\){:/nomarkdown}. ניקח עכשיו מספר ראשוני {::nomarkdown}\( p\){:/nomarkdown} שמחלק את {::nomarkdown}\( n\){:/nomarkdown}: המשפט שראינו קודם אמר שאם {::nomarkdown}\( p\){:/nomarkdown} ראשוני אז הוא מחלק את {::nomarkdown}\( U_{p-\left(\frac{\Delta}{p}\right)}\){:/nomarkdown}. כלומר, קיבלנו ש-{::nomarkdown}\( r_{f}\left(p\right)\){:/nomarkdown} מחלק את {::nomarkdown}\( p-\left(\frac{\Delta}{p}\right)\){:/nomarkdown}, ובניסוח שקול: {::nomarkdown}\( p\equiv\left(\frac{\Delta}{p}\right)\){:/nomarkdown} מודולו {::nomarkdown}\( r_{f}\left(p\right)\){:/nomarkdown} מתקיים תמיד. זו המשוואה שרצינו להגיע אליה, אבל לא מודולו {::nomarkdown}\( r_{f}\left(p\right)\){:/nomarkdown} אלא מודולו מחלק {::nomarkdown}\( F\){:/nomarkdown} של {::nomarkdown}\( n+1\){:/nomarkdown} שמקיים כך-וכך. לצורך כך יספיק לנו להוכיח ש-{::nomarkdown}\( F\){:/nomarkdown} שמקיים כך-וכך מחלק את {::nomarkdown}\( r_{f}\left(p\right)\){:/nomarkdown} (כי אם {::nomarkdown}\( F\){:/nomarkdown} מחלק את {::nomarkdown}\( r_{f}\left(p\right)\){:/nomarkdown} הוא מחלק גם כל דבר שמתחלק על ידי {::nomarkdown}\( r_{f}\left(p\right)\){:/nomarkdown}).

בואו נזכור מה הכך-וכך ש-{::nomarkdown}\( F\){:/nomarkdown} מקיים. ראשית, {::nomarkdown}\( U_{n+1}\){:/nomarkdown} מתחלק ב-{::nomarkdown}\( n\){:/nomarkdown} ולכן בפרט מתחלק ב-{::nomarkdown}\( p\){:/nomarkdown}, ואנחנו יודעים ש-{::nomarkdown}\( F\){:/nomarkdown} מחלק את {::nomarkdown}\( n+1\){:/nomarkdown}. אם היינו יכולים לטעון משהו כמו {::nomarkdown}\( r_{f}\left(p\right)=n+1\){:/nomarkdown} היינו מסיימים כאן. אבל זה לא בהכרח נכון. אנחנו יודעים שבגלל ש-{::nomarkdown}\( p\){:/nomarkdown} מחלק את {::nomarkdown}\( U_{n+1}\){:/nomarkdown} אז {::nomarkdown}\( r_{f}\left(p\right)\){:/nomarkdown} <strong>מחלק</strong> את {::nomarkdown}\( n+1\){:/nomarkdown}, אבל הוא לא חייב להיות שווה לו. אני חושב שהכי ברור להציג את הסיטואציה הזו באופן הבא: אפשר לכתוב את הפירוק לגורמים של {::nomarkdown}\( n+1\){:/nomarkdown}: {::nomarkdown}\( n+1=q_{1}^{k_{1}}\cdots q_{t}^{k_{t}}\){:/nomarkdown}. כעת, המשמעות של "{::nomarkdown}\( r_{f}\left(p\right)\){:/nomarkdown} מחלק את {::nomarkdown}\( n+1\){:/nomarkdown}" הוא שיש ל-{::nomarkdown}\( r_{f}\left(p\right)\){:/nomarkdown} <strong>את אותו פירוק לגורמים אבל עם חזקות שהן אולי נמוכות יותר</strong>. במילים אחרות, אפשר להגיע מ-{::nomarkdown}\( n+1\){:/nomarkdown} אל {::nomarkdown}\( r_{f}\left(p\right)\){:/nomarkdown} על ידי סדרה של צעדים, שבכל אחד מהם אנחנו לוקחים גורם ראשוני {::nomarkdown}\( q\){:/nomarkdown} של {::nomarkdown}\( n+1\){:/nomarkdown} ומחלקים את המספר שיש לנו ביד כרגע בגורם הזה. והנה הפאנץ': כל עוד הגורם {::nomarkdown}\( q\){:/nomarkdown} הזה <strong>איננו</strong> גורם של {::nomarkdown}\( F\){:/nomarkdown}, אז {::nomarkdown}\( F\){:/nomarkdown} ימשיך לחלק את התוצאה שלנו (כי אנחנו לא מקטינים את החלק של {::nomarkdown}\( F\){:/nomarkdown} בתוך {::nomarkdown}\( n+1\){:/nomarkdown}).

כאן נכנס לתמונה התנאי הנוסף שאנחנו בודקים: אם עבור גורם {::nomarkdown}\( q\){:/nomarkdown} של {::nomarkdown}\( F\){:/nomarkdown} מתקיים ש-{::nomarkdown}\( U_{\frac{n+1}{q}}\){:/nomarkdown} זר ל-{::nomarkdown}\( n\){:/nomarkdown}, אז בפרט הוא לא מתחלק על ידי אף גורם של {::nomarkdown}\( n\){:/nomarkdown}, כלומר {::nomarkdown}\( p\){:/nomarkdown} לא מחלק את {::nomarkdown}\( U_{\frac{n+1}{q}}\){:/nomarkdown}. זה <strong>מבטיח</strong> שלא ייתכן ש-{::nomarkdown}\( r_{f}\left(p\right)\){:/nomarkdown} יחלק את {::nomarkdown}\( \frac{n+1}{q}\){:/nomarkdown} כי אמרנו שאם אינדקס ההופעה של {::nomarkdown}\( p\){:/nomarkdown} מחלק אינדקס אחר, אז {::nomarkdown}\( p\){:/nomarkdown} מופיע גם באינדקס הזה (דהיינו, {::nomarkdown}\( p\){:/nomarkdown} מחלק את {::nomarkdown}\( U\){:/nomarkdown} עבור האינדקס הזה). המסקנה היא שבמעבר מ-{::nomarkdown}\( n+1\){:/nomarkdown} אל {::nomarkdown}\( r_{f}\left(p\right)\){:/nomarkdown} אנחנו לא מחלקים אף פעם ב-{::nomarkdown}\( q\){:/nomarkdown}, עבור אף {::nomarkdown}\( q\){:/nomarkdown} שהוא מחלק של {::nomarkdown}\( F\){:/nomarkdown}. לכן התוצאה שנקבל בסוף, שהיא {::nomarkdown}\( r_{f}\left(p\right)\){:/nomarkdown}, מתחלקת ב-{::nomarkdown}\( F\){:/nomarkdown} וסיימנו את ההוכחה הזו.

יפה, עוד עצירה לצורך השבת הנשימה והתמקדות מה שכבר עשינו ומה שנשאר לעשות. מה שעשינו היה להוכיח מבחן הוכחת ראשוניות כללי, שנקרא "מבחן ה-{::nomarkdown}\( n+1\){:/nomarkdown}". אני אומר "מבחן <strong>הוכחת</strong> ראשוניות" כי המבחן הזה לא יודע להוכיח שמספר הוא <strong>לא</strong> ראשוני; הוא רק יודע להוכיח, עבור חלק מהמספרים הראשוניים, שהם אכן כאלו. למבחן הזה יש חיסרון בולט - צריך להכיר את הפירוק לגורמים של {::nomarkdown}\( n+1\){:/nomarkdown}, ובאופן כללי בעיית הפירוק לגורמים היא קשה משמעותית יותר מבעיית בדיקת הראשוניות. עדיין, זה שמדובר על בעיה קשה לא אומר שלפעמים לא קל לפרק מספרים לגורמים. נניח שיש לכם מספר {::nomarkdown}\( n\){:/nomarkdown} שממש קריטי עבורכם להוכיח שהוא ראשוני והאלגוריתמים הרגילים רצים ורצים עליו ולא מסיימים - אין שום סיבה לא לתת למבחן ה-{::nomarkdown}\( n+1\){:/nomarkdown} הזדמנות, אולי במזל יוצא שאת {::nomarkdown}\( n+1\){:/nomarkdown} דווקא קל לפרק לגורמים במקרה הזה ואז אפשר יהיה להשתמש במבחן. כל כלי נוסף שמאפשר לנו להוכיח ראשוניות הוא דבר טוב.

אבל פרט להצדקות הכלליות הללו, המבחן מן הסתם מעניין במיוחד במקרה שבו {::nomarkdown}\( n+1\){:/nomarkdown} הוא מספר פשוט במיוחד, ואין סיטואציה פשוטה יותר מאשר זו שבה {::nomarkdown}\( n\){:/nomarkdown} הוא מספר מרסן, כלומר {::nomarkdown}\( n=2^{k}-1\){:/nomarkdown}. במקרה הזה, {::nomarkdown}\( n+1\){:/nomarkdown} הוא פשוט חזקה של 2. לא רק שאנחנו יודעים לפרק אותה עד הסוף, יש לנו גם גורם יחיד, וגורם שהוא בסיסי מאוד. זה לגמרי מזמין נסיון להוכיח שבמקרה הספציפי הזה, אפשר לעשות יותר מסתם להוכיח ראשוניות בחלק מהמקרים - אנחנו הרי רוצים מבחן שעונה תשובה ודאית של כן/לא.

בשביל לבצע את הצעד האחרון, אנחנו צריכים וריאציה על מבחן ה-{::nomarkdown}\( n+1\){:/nomarkdown} שהיא <strong>טיפ-טיפה</strong> יותר מתאימה לנו. בשביל לעשות את זה, אנחנו מכניסים לתמונה סוג חדש של סדרת לוקאס שהזכרתי בחטף בתחילת הפוסט: סדרה {::nomarkdown}\( V_{k}\){:/nomarkdown} שגם היא מוגדרת בעזרת נוסחת נסיגה {::nomarkdown}\( V_{k+2}=aV_{k+1}-bV_{k}\){:/nomarkdown}, אבל תנאי ההתחלה שלה שונים: {::nomarkdown}\( V_{0}=2,V_{1}=a\){:/nomarkdown}. גם לסדרה הזו יש ייצוג נחמד בתור פולינומים: {::nomarkdown}\( V_{k}\triangleq x^{k}+\left(a-x\right)^{k}\){:/nomarkdown}. אם תזכרו ש-{::nomarkdown}\( U_{k}\triangleq\frac{x^{k}-\left(a-x\right)^{k}}{x-\left(a-x\right)}\){:/nomarkdown} בוודאי תראו מייד שמתקיים {::nomarkdown}\( U_{k}V_{k}=U_{2k}\){:/nomarkdown} (זה נובע מהתכונה הנחמדה {::nomarkdown}\( \left(a+b\right)\left(a-b\right)=a^{2}-b^{2}\){:/nomarkdown}), כך ששתי הסדרות הללו מקיימות ביניהם קשרים ברורים למדי.

בואו ננסח את מבחן ה-{::nomarkdown}\( n+1\){:/nomarkdown} בוריאציה שמערבת את ה-{::nomarkdown}\( V_{k}\){:/nomarkdown}-ים הללו: אם {::nomarkdown}\( n\){:/nomarkdown} זר ל-{::nomarkdown}\( 2b\){:/nomarkdown} ו-{::nomarkdown}\( \left(\frac{\Delta}{n}\right)=-1\){:/nomarkdown}, ניקח מחלק <strong>זוגי </strong>{::nomarkdown}\( F\){:/nomarkdown} של {::nomarkdown}\( n+1\){:/nomarkdown} ונבדוק את שני התנאים הבאים:
<ul>
	<li>{::nomarkdown}\( V_{F/2}\){:/nomarkdown} מתחלק ב-{::nomarkdown}\( n\){:/nomarkdown}.</li>
	<li>{::nomarkdown}\( V_{F/2q}\){:/nomarkdown} זר ל-{::nomarkdown}\( n\){:/nomarkdown} עבור כל {::nomarkdown}\( q\){:/nomarkdown} <strong>אי זוגי</strong> שמחלק את {::nomarkdown}\( F\){:/nomarkdown}.</li>
</ul>
אז במקרה הזה קורה מה שקרה קודם - כל {::nomarkdown}\( p\){:/nomarkdown} שמחלק את {::nomarkdown}\( n\){:/nomarkdown} מקיים {::nomarkdown}\( p\equiv\left(\frac{\Delta}{p}\right)\){:/nomarkdown} מודולו {::nomarkdown}\( F\){:/nomarkdown}.

הניסוח הזה <strong>מושלם</strong> עבור מספרי מרסן בגלל שהתנאי השני בכלל לא יכול לבוא לידי ביטוי: אם {::nomarkdown}\( F\){:/nomarkdown} מחלק את {::nomarkdown}\( n+1\){:/nomarkdown}, שהוא חזקה של 2, אז גם {::nomarkdown}\( F\){:/nomarkdown} הוא בסך הכל חזקה של 2 ולכן אין לו גורמים אי זוגיים. בואו נסביר בזריזות למה הגרסה הזו של מבחן ה-{::nomarkdown}\( n+1\){:/nomarkdown} נכונה ואז נגיע סוף סוף להוכחת לוקאס-להמר.

מן הסתם אין לי כוונה להוכיח את מבחן ה-{::nomarkdown}\( n+1\){:/nomarkdown} החדש הזה מאפס - אני מבצע פה רדוקציה למבחן הקודם, עם ה-{::nomarkdown}\( U_{k}\){:/nomarkdown}-ים. ראשית, אני צריך להראות ש-{::nomarkdown}\( U_{n+1}\){:/nomarkdown} מתחלק ב-{::nomarkdown}\( n\){:/nomarkdown}. אם {::nomarkdown}\( F\){:/nomarkdown} מחלק את {::nomarkdown}\( n+1\){:/nomarkdown} יהיה מספיק להוכיח ש-{::nomarkdown}\( U_{F}\){:/nomarkdown} מתחלק ב-{::nomarkdown}\( n\){:/nomarkdown} (כי אפשר להראות שאם {::nomarkdown}\( k\){:/nomarkdown} מחלק את {::nomarkdown}\( t\){:/nomarkdown} אז {::nomarkdown}\( U_{k}\){:/nomarkdown} מחלק את {::nomarkdown}\( U_{t}\){:/nomarkdown}). מכיוון ש-{::nomarkdown}\( U_{F}=U_{F/2}V_{F/2}\){:/nomarkdown} ומכיוון שאנחנו מניחים ש-{::nomarkdown}\( V_{F/2}\){:/nomarkdown} מתחלק ב-{::nomarkdown}\( n\){:/nomarkdown}, יש לנו את התנאי הזה.

התנאי השני של מבחן ה-{::nomarkdown}\( n+1\){:/nomarkdown} המקורי הוא ש-{::nomarkdown}\( U_{\frac{n+1}{q}}\){:/nomarkdown} זר ל-{::nomarkdown}\( n\){:/nomarkdown} עבור כל מחלק ראשוני {::nomarkdown}\( q\){:/nomarkdown} של {::nomarkdown}\( F\){:/nomarkdown}. בשביל זה מספיק להראות ש-{::nomarkdown}\( U_{\frac{F}{2q}}\){:/nomarkdown} זר ל-{::nomarkdown}\( n\){:/nomarkdown} (כי {::nomarkdown}\( U_{\frac{F}{2q}}\){:/nomarkdown} מחלק את {::nomarkdown}\( U_{\frac{n+1}{q}}\){:/nomarkdown}), ובשביל זה מספיק להראות ש-{::nomarkdown}\( U_{F/2}\){:/nomarkdown} זר ל-{::nomarkdown}\( n\){:/nomarkdown}. שימו לב שאנחנו כבר יודעים ש-{::nomarkdown}\( V_{F/2}\){:/nomarkdown} לא רק שהוא לא זר ל-{::nomarkdown}\( n\){:/nomarkdown} אלא שהוא ממש מתחלק בו, כלומר <strong>כל</strong> מחלק של {::nomarkdown}\( n\){:/nomarkdown} מחלק את {::nomarkdown}\( V_{F/2}\){:/nomarkdown}. לכן כדי לסיים את זה מספיק להוכיח שלכל {::nomarkdown}\( k\){:/nomarkdown}, אין ל-{::nomarkdown}\( U_{k},V_{k}\){:/nomarkdown} בו זמנית מחלקים משותפים שהם גם מחלקים של {::nomarkdown}\( n\){:/nomarkdown}. ליתר דיוק, נראה שכל מחלק משותף כזה חייב לחלק את {::nomarkdown}\( 2b\){:/nomarkdown}, ונשתמש בהנחה שלנו ש-{::nomarkdown}\( 2b\){:/nomarkdown} זר ל-{::nomarkdown}\( n\){:/nomarkdown}.

הנימוק עכשיו חוזר להגדרה הבסיסית של {::nomarkdown}\( U_{k},V_{k}\){:/nomarkdown}. נניח ש-{::nomarkdown}\( p\){:/nomarkdown} הוא מחלק ראשוני של {::nomarkdown}\( n\){:/nomarkdown} שמחלק בו זמנית את {::nomarkdown}\( U_{k}\){:/nomarkdown} ואת {::nomarkdown}\( V_{k}\){:/nomarkdown}. אז יש לנו את שתי המשוואות הבאות מודולו {::nomarkdown}\( p\){:/nomarkdown} (ומודולו {::nomarkdown}\( f\left(x\right)\){:/nomarkdown} אבל מי זוכר את זה): {::nomarkdown}\( \frac{x^{k}-\left(a-x\right)^{k}}{x-\left(a-x\right)}=0\){:/nomarkdown} ו-{::nomarkdown}\( x^{k}+\left(a-x\right)^{k}=0\){:/nomarkdown}. מהראשונה נקבל את {::nomarkdown}\( x^{k}-\left(a-x\right)^{k}=0\){:/nomarkdown} ואחרי שנחבר את שתיהן נקבל {::nomarkdown}\( 2x^{k}=0\){:/nomarkdown}. אפשר לצמצם פה ב-2 כי הוא זר ל-{::nomarkdown}\( p\){:/nomarkdown}, ולכן נקבל {::nomarkdown}\( x^{k}=0\){:/nomarkdown}. איך זה קשור ל-{::nomarkdown}\( b\){:/nomarkdown}? ובכן, {::nomarkdown}\( b=x\left(a-x\right)\){:/nomarkdown} מודולו {::nomarkdown}\( f\left(x\right)\){:/nomarkdown} (כי {::nomarkdown}\( f\left(x\right)\){:/nomarkdown} הוא הפולינום {::nomarkdown}\( x^{2}-ax+b\){:/nomarkdown}) ולכן {::nomarkdown}\( b^{k}=x^{k}\left(a-x\right)^{k}=0\){:/nomarkdown} מודולו {::nomarkdown}\( f\left(x\right)\){:/nomarkdown} ו-{::nomarkdown}\( p\){:/nomarkdown}. בפרט, {::nomarkdown}\( p\){:/nomarkdown} מחלק את {::nomarkdown}\( b^{k}\){:/nomarkdown} ולכן הוא מחלק את {::nomarkdown}\( b\){:/nomarkdown} וסיימנו.

אנחנו ממש בסיום. הראינו וריאציה למבחן ה-{::nomarkdown}\( n+1\){:/nomarkdown} שמשתמשת בסדרת ה-{::nomarkdown}\( V\){:/nomarkdown}-ים במקום בסדרת ה-{::nomarkdown}\( U\){:/nomarkdown}-ים. עכשיו נבחן מה קורה כשאנחנו משתמשים במבחן הזה ספציפית על מספרי מרסן. במקרה הזה, {::nomarkdown}\( n=M_{p}=2^{p}-1\){:/nomarkdown} עבור {::nomarkdown}\( p\){:/nomarkdown} ראשוני כלשהו. כמו כן, אנחנו צריכים להחליט על {::nomarkdown}\( f\left(x\right)\){:/nomarkdown} קונקרטי שנבנה את המבחן סביבו - מה שיוצא טוב במקרה הזה הוא {::nomarkdown}\( f\left(x\right)=x^{2}-4x+1\){:/nomarkdown}, דהיינו {::nomarkdown}\( a=4,b=1\){:/nomarkdown}, ולכן {::nomarkdown}\( \Delta=a^{2}-4b=12\){:/nomarkdown}. האם {::nomarkdown}\( n\){:/nomarkdown} זר ל-{::nomarkdown}\( 2\Delta=24\){:/nomarkdown}? הוא בוודאי לא זוגי, אבל אולי הוא מתחלק ב-3? ובכן, לא: 2 בחזקת מספר אי זוגי שקול תמיד ל-2 מודולו 3 ולכן חזקה של 2 פחות 1 שקולה ל-1 מודולו 3. זה מראה ש-{::nomarkdown}\( n\){:/nomarkdown} זר ל-{::nomarkdown}\( \Delta\){:/nomarkdown}. עדיין צריך להשתכנע ש-{::nomarkdown}\( \left(\frac{\Delta}{n}\right)=-1\){:/nomarkdown} כדי שאפשר יהיה להשתמש במבחן. חישוב של סימן יעקובי שכזה הוא עניין סטנדרטי למדי שלא אוכיח את פרטיו פה: הרעיון הוא ש-{::nomarkdown}\( \left(\frac{\Delta}{n}\right)=\left(\frac{24}{n}\right)=\left(\frac{2}{n}\right)\left(\frac{4}{n}\right)\left(\frac{3}{n}\right)=\left(\frac{2}{n}\right)\left(\frac{3}{n}\right)\){:/nomarkdown} ועכשיו אפשר לטפל בנפרד במוכפלים. ידוע ש-{::nomarkdown}\( \left(\frac{2}{n}\right)=1\){:/nomarkdown} אם {::nomarkdown}\( n\){:/nomarkdown} שקול ל-7 מודולו {::nomarkdown}\( 8\){:/nomarkdown} (וזה יהיה המקרה פה כי {::nomarkdown}\( n+1\){:/nomarkdown} הוא חזקה גבוהה של 2 ולכן מתחלק ב-8). עבור {::nomarkdown}\( \left(\frac{3}{n}\right)\){:/nomarkdown} צריך להשתמש במשפט ההדדיות: {::nomarkdown}\( \left(\frac{3}{n}\right)=-\left(\frac{n}{3}\right)\){:/nomarkdown} (המינוס נובע מכך שגם ה-3 שב"מונה" וגם ה-{::nomarkdown}\( n\){:/nomarkdown} שב"מכנה" הם שניהם 3 מודולו 4). כעת, אפשר להחליף את {::nomarkdown}\( n\){:/nomarkdown} שב"מונה" במספר ששקול לו מודולו 3, שהוא כאמור 2, ואנחנו יודעים ש-2 איננו שארית ריבועית מודולו 3, ולכן נקבל פה {::nomarkdown}\( -\left(\frac{n}{3}\right)=-\left(-1\right)=1\){:/nomarkdown} בסופו של דבר.

עכשיו נותר לבחור מחלק זוגי {::nomarkdown}\( F\){:/nomarkdown} של {::nomarkdown}\( n+1\){:/nomarkdown} כדי להפעיל עליו את המבחן. משתלם לבחור כאן את {::nomarkdown}\( 2^{p-1}\){:/nomarkdown}. עם הבחירה הזו, התנאי הראשון של המבחן שיש לבדוק הוא ש-{::nomarkdown}\( V_{2^{p-2}}\){:/nomarkdown} מתחלק ב-{::nomarkdown}\( M_{p}\){:/nomarkdown}. והתנאי השני? הוא נעלם, כי הוא מערב מחלקים אי זוגיים של {::nomarkdown}\( F\){:/nomarkdown} ואין כאלו.

נותרנו, אם כן, עם השאלה איך אפשר לחשב את {::nomarkdown}\( V_{2^{p-2}}\){:/nomarkdown}. כאן סוף סוף נכנסת לתמונה <strong>סדרת לוקאס-להמר</strong> מתחילת הפוסט. זו שהוגדרה באמצעות הכלל {::nomarkdown}\( a_{0}=4\){:/nomarkdown} ו-{::nomarkdown}\( a_{n+1}=a_{n}^{2}-2\){:/nomarkdown}. זו פשוט {::nomarkdown}\( V_{k}\){:/nomarkdown} עם הפולינום המגדיר {::nomarkdown}\( x^{2}-4x+1\){:/nomarkdown} בתחפושת, כשאנחנו מתקדמים ב"קפיצות" וכל פעם מכפילים את האינדקס שלנו. קל לראות את זה מההגדרה ה"פולינומית" של {::nomarkdown}\( V_{k}\){:/nomarkdown}:

{::nomarkdown}\( V_{2k}=x^{2k}+\left(4-x\right)^{2k}=\left(x^{k}+\left(4-x\right)^{k}\right)^{2}-2x^{k}\left(4-x\right)^{k}\equiv V_{k}^{2}-2\){:/nomarkdown}

כאשר המעבר האחרון הוא מודולו {::nomarkdown}\( f\left(x\right)=x^{2}-4x+1\){:/nomarkdown} (מה שחוקי לעשות כי כל הסדרה מוגדרת מודולו הפולינום הזה מלכתחילה).

גם את תנאי ההתחלה קל להבין כעת: אמרנו ש-{::nomarkdown}\( V_{0}=2\){:/nomarkdown} ו-{::nomarkdown}\( V_{1}=a\){:/nomarkdown}, ובמקרה שלנו {::nomarkdown}\( V_{1}=4\){:/nomarkdown}. כלומר, הסדרה {::nomarkdown}\( a_{n}\){:/nomarkdown} <strong>באמת</strong> מוגדרת בתור {::nomarkdown}\( a_{0}=V_{1}\){:/nomarkdown} ובאופן כללי, {::nomarkdown}\( a_{n}=V_{2^{n}}\){:/nomarkdown}. לכן {::nomarkdown}\( a_{p-2}\){:/nomarkdown} הוא בדיוק {::nomarkdown}\( V_{2^{p-2}}\){:/nomarkdown} שלנו, כמבוקש.

האם סיימנו? לא! עדיין לא! זאת מכיוון שראינו רק כיוון אחד: מבחן ה-{::nomarkdown}\( n+1\){:/nomarkdown} מוכיח רק ש<strong>אם</strong> {::nomarkdown}\( n\){:/nomarkdown} עובר אותו, אז {::nomarkdown}\( n\){:/nomarkdown} ראשוני. אבל זה עדיין לא מוכיח שאם {::nomarkdown}\( n\){:/nomarkdown} ראשוני אז בהכרח הוא יעבור את המבחן. במילים אחרות, אנחנו עדיין צריכים להראות שאם {::nomarkdown}\( M_{p}\){:/nomarkdown} ראשוני אז {::nomarkdown}\( a_{p-2}\){:/nomarkdown} יתחלק על ידו. זה דומה באופי שלו למבחן הפיבונאצ'י מתחילת הפוסט, וגם ההוכחה די דומה.

נניח אם כן ש-{::nomarkdown}\( n\){:/nomarkdown} הוא אכן ראשוני. כבר ראינו קודם ש-{::nomarkdown}\( \left(\frac{\Delta}{n}\right)=-1\){:/nomarkdown} במקרה הנוכחי, ולכן כשמסתכלים על חוג הפולינומים מודולו {::nomarkdown}\( n\){:/nomarkdown} ו-{::nomarkdown}\( f\left(x\right)\){:/nomarkdown} מקבלים שדה סופי עם {::nomarkdown}\( n^{2}\){:/nomarkdown} איברים (זה דומה למה שהלך בהוכחה של פיבונאצ'י). בשדה כזה, כפי שראינו קודם, מתקיים {::nomarkdown}\( x^{n}=4-x\){:/nomarkdown}. עכשיו נבצע להטוט אלגברי שמטרתו לחשב את {::nomarkdown}\( \left(x-1\right)^{n+1}\){:/nomarkdown} בשתי דרכים שונות. החישובים שלנו יתבצעו כולם בתוך השדה, כלומר אני אעשה הכל מודולו {::nomarkdown}\( n\){:/nomarkdown} ומודולו {::nomarkdown}\( f\left(x\right)\){:/nomarkdown} (דהיינו תוך שימוש בשוויון {::nomarkdown}\( x^{2}=4x-1\){:/nomarkdown}) בלי להזכיר זאת אפילו. כעת:

{::nomarkdown}\( \left(x-1\right)^{2}=x^{2}-2x+1=2x\){:/nomarkdown}

ולכן:

{::nomarkdown}\( \left(x-1\right)^{n+1}=\left(2x\right)^{\frac{n+1}{2}}=2\cdot2^{\frac{n-1}{2}}x^{\frac{n+1}{2}}\){:/nomarkdown}

אני רוצה לנטרל את ה-{::nomarkdown}\( 2^{\frac{n-1}{2}}\){:/nomarkdown} הזה שבאמצע ולטעון שהוא שווה ל-1 (מודולו {::nomarkdown}\( n\){:/nomarkdown}); זו עוד תוצאה סטנדרטית על שאריות ריבועיות שלא אוכיח כרגע (לכל מספר {::nomarkdown}\( a\){:/nomarkdown} וראשוני {::nomarkdown}\( p\){:/nomarkdown} מתקיים ש-{::nomarkdown}\( \left(\frac{a}{p}\right)=a^{\frac{p-1}{2}}\){:/nomarkdown} מודולו {::nomarkdown}\( p\){:/nomarkdown}). קיבלנו, אם כן, את השוויון

{::nomarkdown}\( \left(x-1\right)^{n+1}=2x^{\frac{n+1}{2}}\){:/nomarkdown}

עכשיו לחישוב בדרך השניה. אני הולך להתבסס על כך ש-{::nomarkdown}\( \left(a+b\right)^{n}=a^{n}+b^{n}\){:/nomarkdown} מודולו {::nomarkdown}\( n\){:/nomarkdown} (זה נכון רק כש-{::nomarkdown}\( n\){:/nomarkdown} ראשוני, כמו במקרה שלנו) ולכן {::nomarkdown}\( \left(x-1\right)^{n}=x^{n}+\left(-1\right)^{n}=x^{n}-1\){:/nomarkdown} (המעבר האחרון נכון רק כש-{::nomarkdown}\( n\){:/nomarkdown} אי זוגי, כמו במקרה שלנו) ועל מה שהזכרתי לפני רגע, ש-{::nomarkdown}\( x^{n}=4-x\){:/nomarkdown}:

{::nomarkdown}\( \left(x-1\right)^{n+1}=\left(x-1\right)\left(x-1\right)^{n}=\left(x-1\right)\left(x^{n}-1\right)=\left(x-1\right)\left(3-x\right)=4x-x^{2}-3=-2\){:/nomarkdown}

ולכן קיבלנו:

{::nomarkdown}\( 2x^{\frac{n+1}{2}}=-2\){:/nomarkdown}

כלומר:

{::nomarkdown}\( x^{\frac{n+1}{2}}=-1\){:/nomarkdown}.

בואו ניזכר עכשיו מה זה {::nomarkdown}\( n\){:/nomarkdown}: זה {::nomarkdown}\( n=2^{p}-1\){:/nomarkdown}, כלומר {::nomarkdown}\( \frac{n+1}{2}=2^{p-1}\){:/nomarkdown}. לכן קיבלנו {::nomarkdown}\( x^{2^{p-1}}=-1\){:/nomarkdown}. את כל העסק הזה אפשר להעלות בחזקת {::nomarkdown}\( n\){:/nomarkdown} כדי להפוך את ה-{::nomarkdown}\( x\){:/nomarkdown} ל-{::nomarkdown}\( 4-x\){:/nomarkdown}; אגף ימין לא ישתנה כי {::nomarkdown}\( n\){:/nomarkdown} אי-זוגי. נקבל {::nomarkdown}\( \left(4-x\right)^{2^{p-1}}=-1\){:/nomarkdown}. מכיוון ש-{::nomarkdown}\( U_{2^{p-1}}\){:/nomarkdown} הוא הפרש שני אלו חלקי משהו מודולו {::nomarkdown}\( n\){:/nomarkdown}, נקבל שהוא מתחלק ב-{::nomarkdown}\( n\){:/nomarkdown}. עכשיו, {::nomarkdown}\( U_{2^{p-1}}=U_{2^{p-2}}V_{2^{p-2}}\){:/nomarkdown}; מכיוון ש-{::nomarkdown}\( n\){:/nomarkdown} ראשוני, אם הוא מחלק את המכפלה שלהם הוא חייב לחלק אחד מהם. אם הוא מחלק את {::nomarkdown}\( V_{2^{p-2}}\){:/nomarkdown}, סיימנו; זה בדיוק מה שרצינו להראות. נשאר רק להשתכנע שהוא לא מחלק את {::nomarkdown}\( U_{2^{p-2}}\){:/nomarkdown}. אם הוא כן, אז נקבל את השוויון {::nomarkdown}\( x^{2^{p-2}}=\left(4-x\right)^{2^{p-2}}\){:/nomarkdown}, ועל כן:

{::nomarkdown}\( -1=x^{2^{p-1}}=x^{2^{p-2}}\cdot x^{2^{p-2}}=x^{2^{p-2}}\left(4-x\right)^{2^{p-2}}=\left(x\left(4-x\right)\right)^{2^{p-2}}=1^{2^{p-2}}=1\){:/nomarkdown}

וזו סתירה, כי גם מודולו {::nomarkdown}\( f\left(x\right)\){:/nomarkdown} ומודולו {::nomarkdown}\( n\){:/nomarkdown}, עדיין {::nomarkdown}\( 1\ne-1\){:/nomarkdown}, מה שמסיים את ההוכחה.

סוף דבר - התחלנו עם מבחן פשוט בצורה קיצונית ויעיל בצורה קיצונית. גילינו שההוכחה לא פשוטה בצורה קיצונית, אבל גם אין בה שום דבר מתוחכם במיוחד, ובדרך ראינו כל מני מבחנים למציאת פסואדוראשוניים והוכחת ראשוניות. עבורי מי שהיה נחמד פה במיוחד הוא לראות איך דברים כמו שדות סופיים, אוטומורפיזם פרובניוס ושאריות ריבועיות צצים כמעט מאליהם כשמתעסקים בנושאים הללו; כשרק לומדים אותם המושגים הללו נראים די מנותקים ולא כמו כלי העבודה המאוד בסיסי שהם.
