---
id: 1480
title: "משפט הפירוק הפרימרי"
date: 2012-01-09 11:22:22
layout: post
categories: 
  - אלגברה לינארית
tags: 
  - אלגברה לינארית
  - משפט הפירוק הפרימרי
---
בפעם האחרונה שבה <a href="http://www.gadial.net/?p=1464">דיברתי על אלגברה לינארית</a> המושג הדומיננטי היה זה של <strong>תת-מרחב שמור</strong>. כזכור, {::nomarkdown}\( W\subseteq V\){:/nomarkdown} הוא תת-מרחב שמור של טרנספורמציה לינארית {::nomarkdown}\( T:V\to V\){:/nomarkdown} אם {::nomarkdown}\( T\left(W\right)\subseteq W\){:/nomarkdown}, והחשיבות של תתי-מרחבים כאלו נובעת מהעובדה שאפשר <strong>לצמצם</strong> את {::nomarkdown}\( T\){:/nomarkdown} אליהם - להגדיר טרנספורמציה {::nomarkdown}\( T_{W}:W\to W\){:/nomarkdown} כך ש-{::nomarkdown}\( T_{W}\left(w\right)=T\left(w\right)\){:/nomarkdown} על {::nomarkdown}\( w\in W\){:/nomarkdown}. אם הצלחנו לפרק את {::nomarkdown}\( V\){:/nomarkdown} לסכום ישר של תתי-מרחבים שכולם תתי-מרחבים שמורים של {::nomarkdown}\( T\){:/nomarkdown}, נובע מכך פירוק של {::nomarkdown}\( T\){:/nomarkdown} לסכום של טרנספורמציות פשוטות יותר, ומכאן נובעת הבנה יותר טובה של מה {::nomarkdown}\( T\){:/nomarkdown} עושה. המקרה הפשוט ביותר היה כאשר {::nomarkdown}\( T\){:/nomarkdown} הייתה <strong>לכסינה</strong> - במקרה זה אפשר היה לפרק את {::nomarkdown}\( V\){:/nomarkdown} לתתי-מרחבים שמורים שבכל אחד מהם {::nomarkdown}\( T\){:/nomarkdown} פועלת פשוט על ידי כפל בסקלר (ולכן מיוצגת על ידי מטריצה סקלרית - מטריצה אלכסונית שבאלכסון שלה יש תמיד אותו מספר). כפי שראינו, התכונה הזו הייתה שקולה לכך שהפולינום המינימלי שמאפס את {::nomarkdown}\( T\){:/nomarkdown} מתפרק לגורמים לינאריים שונים. בפוסט הזה נראה את ההכללה של התוצאה הזו עבור המקרה הכללי ביותר; ההכללה הזו נקראת <strong>משפט הפירוק הפרימרי</strong>. שמו של המשפט נובע כנראה מכך שהוא אינו סוף הסיפור אלא רק ההתחלה - גם אחרי הפירוק עדיין צריך להבין איך נראית {::nomarkdown}\( T\){:/nomarkdown} כשהיא מצומצמת לתתי-המרחבים שמשפט הפירוק נותן - אבל הוא הצעד הראשון (וההכרחי?) שיש לנקוט בו.

נתחיל מלצטט את המשפט, ואז נוכיח. כרגיל, נתחיל עם טרנספורמציה לינארית {::nomarkdown}\( T:V\to V\){:/nomarkdown}, כאשר {::nomarkdown}\( V\){:/nomarkdown} הוא מרחב סוף-ממדי (בכל הדיון הנוכחי אנחנו לא מדברים על מרחבים אינסוף ממדיים; יש להם תורה דומה לזו שאני מציג כאן אבל היא מורכבת יותר ודורשת הכנסה לתמונה של עוד הרבה מושגים יפים שיוצגו בפעם אחרת). אם {::nomarkdown}\( p\){:/nomarkdown} הוא הפולינום המינימלי של {::nomarkdown}\( T\){:/nomarkdown} אז אפשר לכתוב אותו בתור מכפלה של חזקות של פולינומים אי פריקים (מתוקנים, כלומר עם מקדם מוביל 1) {::nomarkdown}\( p=p_{1}^{r_{1}}\cdots p_{k}^{r_{k}}\){:/nomarkdown}. נגדיר את המרחבים {::nomarkdown}\( W_{i}\){:/nomarkdown} בתור {::nomarkdown}\( W_{i}=\ker\left(p_{i}^{r_{i}}\left(T\right)\right)\){:/nomarkdown} (כלומר, {::nomarkdown}\( W_{i}\){:/nomarkdown} הוא אוסף כל הוקטורים שמתאפסים על ידי הטרנספורמציה שמתקבלת כשמציבים את {::nomarkdown}\( T\){:/nomarkdown} ב-{::nomarkdown}\( p_{i}^{r_{i}}\){:/nomarkdown}), אז ה-{::nomarkdown}\( W_{i}\){:/nomarkdown}-ים הללו הם פירוק של {::nomarkdown}\( V\){:/nomarkdown} לתת-מרחבים שמורים של {::nomarkdown}\( T\){:/nomarkdown}; והפולינום המינימלי של {::nomarkdown}\( T_{W_{i}}\){:/nomarkdown} הוא בדיוק {::nomarkdown}\( p_{i}^{r_{i}}\){:/nomarkdown}.

למי שרוצה לוודא שהוא לא מאבד אותי, עכשיו זה זמן טוב לעצור ולהבין למה המשפט הזה הוא הכללה של לכסינות. מה הפולינום המינימלי אם {::nomarkdown}\( T\){:/nomarkdown} לכסינה? מהם {::nomarkdown}\( W_{i}\){:/nomarkdown} במקרה הזה?

נעבור להוכחה. הכלי שבו נשתמש כדי לפרק את {::nomarkdown}\( V\){:/nomarkdown} לתת-מרחבים הוא הטלות. כזכור, הטלה {::nomarkdown}\( E\){:/nomarkdown} היא טרנספורמציה לינארית שמקיימת {::nomarkdown}\( E^{2}=E\){:/nomarkdown}. אם יש לנו קבוצה של טרנספורמציות {::nomarkdown}\( E_{i}\){:/nomarkdown} כך ש-{::nomarkdown}\( \sum E_{i}=I\){:/nomarkdown} ו-{::nomarkdown}\( E_{i}E_{j}=0\){:/nomarkdown} לכל {::nomarkdown}\( i\ne j\){:/nomarkdown}, אז הטרנספורמציות הן הטלות (נסו להוכיח שזה אכן נובע, זה קל) והתמונות של ההטלות הללו הן פירוק של {::nomarkdown}\( V\){:/nomarkdown} לסכום ישר של תתי-מרחבים. מכאן שהאתגר במשפט הפירוק הפרימרי הוא למצוא את ההטלות הנכונות. כאן תצטרכו לסמוך עלי לרגע - אני אציג את ההטלות, במה שייראה כמו קסם שבא משום מקום (אבל זה לא "משום מקום"; הרעיון מאחורי ההוכחה דומה להפליא לזה של הוכחת <a href="http://www.gadial.net/2012/09/12/chinese_remainder_theorem/">משפט השאריות הסיני</a>), ואז נראה שהן עובדות.

לב העניין הוא הפולינום המינימלי {::nomarkdown}\( p=p_{1}^{r_{1}}\cdots p_{k}^{r_{k}}\){:/nomarkdown}. לכל גורם {::nomarkdown}\( i\){:/nomarkdown} שלו, נגדיר פולינום {::nomarkdown}\( q_{i}=\frac{p}{p_{i}^{r_{i}}}\){:/nomarkdown}, או במילים אחרות {::nomarkdown}\( q_{i}=\prod_{j\ne i}p_{j}^{r_{j}}\){:/nomarkdown} - "סיננו" את הגורם {::nomarkdown}\( p_{i}\){:/nomarkdown} על כל חזקותיו מתוך {::nomarkdown}\( p\){:/nomarkdown}. כעת די ברור שהמחלק המשותף המקסימלי של כל הפולינומים {::nomarkdown}\( q_{1},\dots,q_{k}\){:/nomarkdown} הוא 1, ושפן אלגברי שאני שולף מהכובע ולא מוכיח כרגע הוא שבשל כך, קיימים פולינומים {::nomarkdown}\( h_{1},\dots,h_{k}\){:/nomarkdown} כך ש-{::nomarkdown}\( \sum h_{i}q_{i}=1\){:/nomarkdown}. זה מוביל אותנו להגדרה {::nomarkdown}\( E_{i}=\left(h_{i}q_{i}\right)\left(T\right)\){:/nomarkdown} ומהנוסחה {::nomarkdown}\( \sum h_{i}q_{i}=1\){:/nomarkdown} אנחנו מקבלים מיידית ש-{::nomarkdown}\( \sum E_{i}=I\){:/nomarkdown}.

אוקיי, אבל... מה? למה, למשל, {::nomarkdown}\( E_{i}E_{j}=0\){:/nomarkdown}? ובכן, כי {::nomarkdown}\( E_{i}E_{j}=\left(h_{i}q_{i}h_{j}q_{j}\right)\left(T\right)\){:/nomarkdown}, אבל {::nomarkdown}\( h_{i}\){:/nomarkdown} ו-{::nomarkdown}\( h_{j}\){:/nomarkdown} יחדיו כוללים את כל הרכיבים של {::nomarkdown}\( p\){:/nomarkdown}, ולכן {::nomarkdown}\( p\|h_{i}h_{j}\){:/nomarkdown}, ולכן {::nomarkdown}\( h_{i}q_{i}h_{j}q_{j}\){:/nomarkdown} הוא פולינום שמתחלק על ידי הפולינום המינימלי של {::nomarkdown}\( T\){:/nomarkdown} ולכן כשמציבים בו את {::nomarkdown}\( T\){:/nomarkdown} מקבלים 0. פשוט למדי.

אם כן, ה-{::nomarkdown}\( E_{i}\){:/nomarkdown}-ים הללו הן אכן הטלות ולכן מפרקות את {::nomarkdown}\( V\){:/nomarkdown}, אבל האם זה כמו שרצינו? לשם כך צריך להראות ש-{::nomarkdown}\( E_{i}\left(V\right)=W_{i}\){:/nomarkdown}. נתחיל מהכיוון הקל. נניח ש-{::nomarkdown}\( w\in E_{i}\left(V\right)\){:/nomarkdown}, אז זה אומר ש-{::nomarkdown}\( E_{i}\left(w\right)=w\){:/nomarkdown} (בשל התכונה {::nomarkdown}\( E_{i}=E_{i}^{2}\){:/nomarkdown}). מכאן שמתקיים:

{::nomarkdown}\( p_{i}^{r_{i}}\left(T\right)\left(w\right)=p_{i}^{r_{i}}\left(T\right)E_{i}\left(w\right)=\left(p_{i}^{r_{i}}h_{i}q_{i}\right)\left(T\right)\left(w\right)=0\){:/nomarkdown}

כשהשוויון האחרון נובע שוב מכך ש-{::nomarkdown}\( p_{i}^{r_{i}}h_{i}q_{i}\){:/nomarkdown} מתחלק על ידי הפולינום המינימלי של {::nomarkdown}\( T\){:/nomarkdown}.

בכיוון השני, נניח ש-{::nomarkdown}\( w\in\ker\left(p_{i}^{r_{i}}\left(T\right)\right)\){:/nomarkdown}. היינו רוצים להראות ש-{::nomarkdown}\( w\in E_{i}\left(V\right)\){:/nomarkdown}, אבל יהיה לנו יותר קל להראות תכונה משלימה: ש-{::nomarkdown}\( E_{j}\left(w\right)=0\){:/nomarkdown} לכל {::nomarkdown}\( j\ne i\){:/nomarkdown}, מה שיסיים מייד את ההוכחה כי אז {::nomarkdown}\( w=I\left(w\right)=\sum E_{j}\left(w\right)=E_{i}\left(w\right)\in E_{i}\left(V\right)\){:/nomarkdown}. כעת, {::nomarkdown}\( p_{i}^{r_{i}}\){:/nomarkdown} מחלק את {::nomarkdown}\( h_{j}\){:/nomarkdown} לכל {::nomarkdown}\( j\ne i\){:/nomarkdown} ולכן {::nomarkdown}\( E_{j}\left(w\right)=\left(h_{j}q_{j}\left(T\right)\right)\left(w\right)=0\){:/nomarkdown} כי אפשר להציג את {::nomarkdown}\( h_{j}q_{j}\left(T\right)\){:/nomarkdown} כמכפלה של {::nomarkdown}\( p_{i}^{r_{i}}\left(T\right)\){:/nomarkdown} (שמאפס את {::nomarkdown}\( w\){:/nomarkdown} ולכן המכפלה תצא 0) בעוד איזה פולינום לא מעניין.

יפה. קיבלנו ש-{::nomarkdown}\( W_{i}=E_{i}\left(V\right)\){:/nomarkdown} ולכן {::nomarkdown}\( V=W_{1}\oplus\dots\oplus W_{k}\){:/nomarkdown}. קיבלנו פירוק של {::nomarkdown}\( V\){:/nomarkdown} למרחבים שהצהרנו עליהם מראש, אבל למה הם תת-מרחבים שמורים של {::nomarkdown}\( T\){:/nomarkdown}? ובכן, אם {::nomarkdown}\( p_{i}^{r_{i}}\left(T\right)\left(w\right)=0\){:/nomarkdown} אז {::nomarkdown}\( p_{i}^{r_{i}}\left(T\right)\left(T\left(w\right)\right)=T\left(p_{i}^{r_{i}}\left(T\right)\left(w\right)\right)=T\left(0\right)=0\){:/nomarkdown} - כאן השתמשנו בכך שטרנספורמציה מתחלפת בכפל עם כל פולינום בה. נותר רק להראות ש-{::nomarkdown}\( p_{i}^{r_{i}}\){:/nomarkdown} הוא הפולינום המינימלי של {::nomarkdown}\( T_{W_{i}}\){:/nomarkdown}. את זה שהוא מאפס את {::nomarkdown}\( T_{W_{i}}\){:/nomarkdown} קל לראות ישירות מההגדרה של {::nomarkdown}\( W_{i}\){:/nomarkdown} (הרי {::nomarkdown}\( W_{i}\){:/nomarkdown} <strong>הוגדר</strong> בתור אוסף האיברים שמאופסים על ידי {::nomarkdown}\( p_{i}^{r_{i}}\left(T\right)\){:/nomarkdown}, כלומר באופן שמבטיח ש-{::nomarkdown}\( p_{i}^{r_{i}}\left(T\right)\){:/nomarkdown} יהיה אפס בכל {::nomarkdown}\( W_{i}\){:/nomarkdown}, ולכן {::nomarkdown}\( p_{i}^{r_{i}}\left(T_{W_{i}}\right)\){:/nomarkdown} הוא אפס בכל מקום שבו הוא מוגדר). למה הוא מינימלי? נניח ש-{::nomarkdown}\( q\){:/nomarkdown} הוא פולינום כלשהו שמאפס את {::nomarkdown}\( T_{W_{i}}\){:/nomarkdown}. אז {::nomarkdown}\( q\cdot q_{i}\){:/nomarkdown} יאפס את כל {::nomarkdown}\( T\){:/nomarkdown} (כי {::nomarkdown}\( q\left(T\right)\){:/nomarkdown} מתאפס על כל {::nomarkdown}\( W_{i}\){:/nomarkdown}, ואילו {::nomarkdown}\( q_{i}\left(T\right)\){:/nomarkdown} יתאפס על כל {::nomarkdown}\( W_{j}\){:/nomarkdown} עבור {::nomarkdown}\( j\ne i\){:/nomarkdown}), ומכאן ש-{::nomarkdown}\( p\){:/nomarkdown} מחלק את {::nomarkdown}\( q\cdot q_{i}\){:/nomarkdown}. אבל ב-{::nomarkdown}\( q_{i}\){:/nomarkdown} בכלל לא מופיע הגורם {::nomarkdown}\( p_{i}^{r_{i}}\){:/nomarkdown} של {::nomarkdown}\( p\){:/nomarkdown} ולכן הוא חייב להופיע בשלמותו ב-{::nomarkdown}\( q\){:/nomarkdown}, כלומר {::nomarkdown}\( q\){:/nomarkdown} מתחלק על ידי {::nomarkdown}\( p_{i}^{r_{i}}\){:/nomarkdown}, ומכאן שזהו אכן הפולינום המינימלי. סוף ההוכחה.

למרות שאני זוכר בבעתה את הבעתה שלי כשנתקלתי במשפט לראשונה, בסיכומו של דבר המשפט הוא אינו קשה במיוחד, אם כי הוא דורש היכרות כלשהי עם פולינומים שבדרך כלל אין לסטודנטים שרק מתחילים ללמוד אלגברה לינארית (התעסקות שכזו עם פולינומים נפוצה יותר בקורסים באלגברה מופשטת). הפסגה הזו, שהיא בעצם יותר רמה מפסגה, נראית לי כמו מקום טוב לעצור בינתיים את הריצה שלנו אחרי צורות קנוניות של מטריצות (שסופה הוא בצורת ז'ורדן, שהיא דרך כללית למדי להבין מה קורה בתוך ה-{::nomarkdown}\( W_{i}\){:/nomarkdown}-ים הללו), אם כי אחזור אליה בהמשך; לעת עתה נעבור לדבר החל מהפוסט הבא על מושג שעליו באמת אפשר לדבר מכאן ועד אינסוף - <strong>מכפלה פנימית</strong>.
