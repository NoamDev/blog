---
id: 146
title: פרדוקס המעטפות
date: 2008-07-25T17:26:35+00:00
author: gadial
layout: post
guid: http://gadial.blogli.co.il/archives/151
permalink: /2008/07/25/envelope_paradox/
categories:
  - הסתברות
  - משחקים וחידות מתמטיות
---
ביום רביעי האחרון התמזל מזלי והייתי נוכח בהרצאה של פרופ' [נוגה אלון](http://he.wikipedia.org/wiki/%D7%A0%D7%95%D7%92%D7%94_%D7%90%D7%9C%D7%95%D7%9F) על "חשיבה הסתברותית". אלון הוא מרצה בחסד עליון, וייתכן שזו (או אולי [הפורום הספציפי](http://www.math.technion.ac.il/Site/events/special-lectures/Mathclub/) שבו ניתנה ההרצאה) הסיבה לכך שהוא לא היסס להציג את הנושאים שעליהם הוא דיבר בצורה קצת יותר מורכבת מההצגה הסטנדרטית שלהם. הוא דיבר על [הבעיה של מונטי הול](http://www.gadial.net/?p=111), על [אלגוריתמים הסתברותיים](http://he.wikipedia.org/wiki/%D7%90%D7%9C%D7%92%D7%95%D7%A8%D7%99%D7%AA%D7%9D_%D7%90%D7%A7%D7%A8%D7%90%D7%99) ודה-רנדומיזציה שלהם (הפיכתם לדטרמיניסטיים בלי שהדבר ילווה בפגיעה משמעותית בזמן הריצה), עם דגש על [אלגוריתם בדיקת הראשוניות AKS](http://en.wikipedia.org/wiki/AKS_primality_test) (שהזכרתי את הדיווח הנלהב-יתר-על-המידה עליו ב"הארץ" ב[פוסט קודם](http://www.gadial.net/?p=144), ואני מקווה להציג בצורה יותר קונקרטית בעתיד) שהושג באמצעות דה-רנדומיזציה של אלגוריתם אחר; וכמובן, [בשיטה ההסתברותית](http://en.wikipedia.org/wiki/Probabilistic_method) (שאלון חיבר [ספר](http://www.amazon.com/Probabilistic-Wiley-Interscience-Discrete-Mathematics-Optimization/dp/0471370460) עליה) שהצגתי את קצה הקרחון שלה ב[פוסט קודם](http://www.gadial.net/?p=36). עם זאת, החלק שהכי עניין אותי בהרצאה ועליו אני רוצה לדבר בפוסט הזה היה [פרדוקס המעטפות](http://en.wikipedia.org/wiki/Two_envelopes_problem).

היחס שלי לפרדוקסים הוא כאל הוכחות בדרך השלילה. הם מגיעים לתוצאה אבסורדית, כן; אבל כל מה שאני מסיק מכך הוא שמשהו שגוי בדרך הסקת המסקנות או בהנחות היסוד שלהם. [בפוסטים](http://www.gadial.net/?p=141) [קודמים](http://www.gadial.net/?p=142) הראיתי ש[הפרדוקסים של זנון](http://he.wikipedia.org/wiki/%D7%94%D7%A4%D7%A8%D7%93%D7%95%D7%A7%D7%A1%D7%99%D7%9D_%D7%A9%D7%9C_%D7%96%D7%A0%D7%95%D7%9F) לא מרשימים אותי במיוחד כי הם נראים לי כמו המחשה לבלבול שנובע מהגדרות גרועות. גם [הפרדוקס של ראסל](http://nimrodavissar.com/blogica/archives/125) לא מטריד אותי במיוחד, כי ברור לי שתורת הקבוצות הנאיבית פשוט שגויה באספקט שלה שמאפשר את הפרדוקס. פרדוקסים כמו [פרדוקס השקרן](http://he.wikipedia.org/wiki/%D7%A4%D7%A8%D7%93%D7%95%D7%A7%D7%A1_%D7%94%D7%A9%D7%A7%D7%A8%D7%9F) או פרדוקס "[המספר הטבעי הקטן ביותר שלא ניתן לתאר בפחות ממאה אותיות](http://he.wikipedia.org/wiki/%D7%94%D7%A4%D7%A8%D7%93%D7%95%D7%A7%D7%A1_%D7%A9%D7%9C_%D7%91%D7%A8%D7%99)" לא מרשימים אותי כי ברור לי שהקושי בהם נעוץ בהגדרה שלהם של משהו בעזרת עצמו (כמו להגיד "אני מגדיר את x להיות x+1" ולהתפלא שלא קיבלת שום דבר בעל משמעות). [פרדוקס יום ההולדת](http://he.wikipedia.org/wiki/%D7%A4%D7%A8%D7%93%D7%95%D7%A7%D7%A1_%D7%99%D7%95%D7%9D_%D7%94%D7%94%D7%95%D7%9C%D7%93%D7%AA) (ש[הבטחתי](http://www.gadial.net/?p=137) פוסט שעוסק בו, ואקיים) ובעיות כמו מונטי הול (שלעתים מכונה "פרדוקס") הם בכלל לא פרדוקסים, אלא סך הכל תוצאות לא אינטואיטיביות.

לעומת כל אלו, פרדוקס המעטפות מטריד אותי. מאוד. מעולם לא זכיתי לשמוע פתרון מניח את הדעת שלו. מה שהכי מצמרר כאן (עד כמה שבעיה מתמטית יכולה להיות מצמררת) הוא שלא נראה לי שאי פעם אשמע; לפרדוקס יש "פתרון" מתמטי, הוא פשוט נוגד בצורה חריפה לא רק את האינטואיציה אלא גם את השכל הישר שלי, ונשמע לי בעיקר כמו התחמקות &#8211; אף שהוא אינו התחמקות. לטעמי, הפרדוקס מצביע בצורה נאה מאוד על בעיה בסיסית ומהותית שיש לנו כאשר אנו לוקחים עובדות מתמטיות ומנסים למצוא להם משמעות ב"עולם האמיתי", ולכן הוא פרדוקס חשוב ומעניין, ואין פלא שנוגה אלון טרח להביא אותו.

אם כן, מהו הפרדוקס? יש לו מספר גרסאות, ואציג שתיים: את הפשוטה, הנפוצה יותר, ואת זו שאלון הציג. הגרסה הפשוטה יותר היא סתם מטומטמת; יש בה כשל בסיסי שתכף אסביר, ולכן הפתרון במקרה שלה מיידי. במשך זמן רב הכרתי רק את הגרסה הראשונה והייתי בטוח שזהו, הפרדוקס סגור ונעול &#8211; זאת עד שבא מתמטיקאי (לא אלון), הראה לי את הגרסה השנייה ופוצץ לי את הבלון בפרצוף. בכל זאת, אי אפשר ולא כדאי להתעלם מהגרסה הראשונה, והנה היא:

נניח שמשחקים איתכם משחק שבו נותנים לכם שתי מעטפות חתומות ומבקשים מכם לבחור אחת. אתם יודעים שבאחת המעטפות יש סכום כסף כפול מאשר במעטפה השנייה. אתם בוחרים מעטפה (אין לך שום דרך לדעת מה בפנים, כך שזו בחירה אקראית לגמרי), פותחים אותה ומוצאים בפנים סכום כסף $latex A$. כעת, בדיוק כמו במונטי הול, שואלים אתכם אם ברצונכם להחליף. מכיוון שאתם בוגרי מונטי הול אתם מייד קופצים על ההצעה&#8230; רגע, האמנם? מן הסתם מתבקש כאן ניתוח מתמטי כלשהו.

יש שתי אפשרויות: או שבמעטפה השנייה יש סכום כפול, כלומר $latex 2A$, ואז הרווחתם $latex A$; או שבמעטפה השנייה יש  רק חצי מהסכום שבמעטפה שלכם, ואז הפסדתם $latex \frac{1}{2}A$. סביר להניח שההסתברות שבחרתם במעטפה עם הסכום הגדול יותר היא $latex \frac{1}{2}$. אם כן, האם כדאי להחליף או לא?

הדרך שבה משתמשים למדוד את כדאיות ההחלפה היא תוחלת הרווח; מעין ממוצע משוקלל של הרווח/הפסד שיכול להיווצר כתוצאה מהפעולה שלכם, כשהשיקלול הוא על פי ההסתברות של המאורע. אפשר לחשוב על תוחלת בתור הרווח הממוצע שיתקבל לאחר הרבה מאוד חזרות על המשחק; כך למשל במונטי הול, תוחלת הרווח במקרה של החלפה (אם אומרים שזכייה ברכב היא רווח 1, והפסד הוא רווח 0) היא $latex \frac{2}{3}$.

חישוב התוחלת במקרה שלנו קל מאוד, והנה הוא: $latex E=\frac{1}{2}A-\frac{1}{2}\cdot\frac{1}{2}A=\frac{1}{4}A$.

כלומר, תוחלת הרווח במקרה של החלפה היא חיובית. לכן כדאי להחליף.

כעת נכנס לתמונה הטיעון ה"פרדוקסלי", שהולך כך: הרי החישוב שלעיל נכון עבור כל $latex A$ חיובי, לא משנה מה ערכו. אם כן, מדוע צריך בכלל לפתוח את המעטפה? אפילו בלי לפתוח אותה אתה יודע שאתה רוצה להחליף. ואחרי שהחלפת, אותם שיקולים ממשיכים לעבוד, ולכן שוב אתה רוצה להחליף. מכאן שתמיד "משתלם" לך להחליף את המעטפה שלך, שוב ושוב ושוב עד אינסוף. ברור שמשהו שבור כאן.

מה הרמאות כאן? שכל חישובי ההסתברויות הם בלוף אחד גדול. נתחיל מכך שאם הערכים שבוחרים לשים במעטפות לא נבחרים בצורה אקראית, אז אי אפשר בכלל להשתמש בניתוח ההסתברותי שלנו. אם למשל שמים במעטפות 100 ו-200 ש"ח, אז ההסתברות שלך להרוויח אם ראית 200 ש"ח במעטפה שלך ואתה מחליף היא לא חצי; היא אפס. הניתוח שלי הניח הנחה שקרית, שההסתברות היא חצי-חצי; אבל כדי שזה יקרה, צריך שהכסף שמוכנס למעטפות ייבחר בצורה אקראית כלשהי, ולא סתם יהיה שני מספרים שהם תמיד אותו הדבר. אמנם, אין לי מושג מה המספרים הללו, ולכן כשאני רואה מספר אין לי מושג אם ההסתברות שלי להרוויח היא 0 או לא; אבל זה שחסר לי מידע לא משנה את המציאות.

יש עוד נימוקים לבעייתיות אבל לא איכנס אליהם כי זה שהצגתי הוא החביב עלי. השורה התחתונה היא שכדי לפתור את הבעיה המתמטית שיש כאן צריך להגדיר התפלגות כלשהי על הערכים של $latex A$ שיכולים להופיע במעטפה; אבל התפלגות כזו בהכרח תספק לי, כשחקן, מידע ותוכל לרמוז לי מה עדיף לעשות. אם אפשר היה לבחור את $latex A$ באקראי ובהתפלגות אחידה מבין כל המספרים הטבעיים, זה היה מחזיר אותי לסיטואציה שבה תמיד כדאי להחליף, בלי תלות בערך הספציפי של $latex A$; אלא שהתפלגות אחידה שכזו אינה קיימת (תרגיל: הוכיחו). הפרדוקס בגרסה זו [מתואר גם ב-Ynet](http://www.ynet.co.il/articles/0,7340,L-3460198,00.html), ובדרך הצגה שהיא אמנם טובה למדי והניתוח שלה לא רע בכלל, אבל השורה התחתונה &#8211; הצורך בהגדרת התפלגות על הערכים האפשריים &#8211; לא מוזכרת שם, וכמה טוקבקיסטים העירו על כך (עם זאת, את ההצגה גונבות תגובות הטוקבקיסטים שהם פחות מדוייקים מתמטית, למשל "<span><span>היות ושני המעתפות זהות לחלוטין מבחינה חיצונית, לפי תורת הקוונטים הם בעצם אותו המעתפה.").</span></span>

כאן מסתיים תיאור הניסוח הראשון, וזה כאמור כל מה שהכרתי מהבעיה במשך זמן רב &#8211; ובמשך זמן רב, לא חשבתי שהיא מעניינת במיוחד. אלא שכל מתמטיקאי סקרן מספיק שחושב על הבעיה יצליח, כנראה, לראות שאפשר להיפטר מהקושי הטכני שבה בלי בעיות מיוחדות &#8211; להישאר עם התפלגות על ה-$latex A$-ים שאמנם איננה אחידה אך עדיין יוצרת את אותה תוצאה אבסורדית. נוגה אלון הציג התפלגות שכזו, אבל זו בשום פנים ואופן אינה היחידה או ה"אופטימלית" מבחינת טווח הערכים שבה; היא פשוט יחסית קלה להבנה.

הרעיון הוא כזה: הערכים שיוכנסו למעטפות יהיו חזקות של 10. כלומר, או 10, או 100, או 1,000 וכן הלאה עד אינסוף. הזוג 10 ו-100 יוכנס בהסתברות 1/2; הזוג 100 ו-1,000 יוכנס בהסתברות 1/4, וכן הלאה. בניסוח פורמלי, ההסתברות של הזוג $latex (10^n,10^{n+1})$ היא $latex \frac{1}{2^n}$. קל לראות שמדובר בהתפלגות חוקית (סכום ההסתברויות של כל הזוגות הוא 1). כעת נותר רק לבצע את חישוב התוחלת הישן, שעכשיו הוא מחוכם קצת יותר ואחזור עליו בשלמותו.

נניח שפתחנו את המעטפה וגילינו בפנים סכום של $latex 10^n$ עבור איזה שהוא $latex n$ טבעי. ברור לנו שאנו נמצאים באחד משני מקרים &#8211; או שבמעטפה השנייה יש $latex 10^{n+1}$ (סכום גדול פי 10) או שיש בה $latex 10^{n-1}$ (סכום קטן פי עשר). היוצא מן הכלל היחיד הוא המקרה שבו מצאנו 10 במעטפה, ואז ברור לנו שכדאי להחליף (זה פועל לטובת הפרדוקס &#8211; זכרו, הפואנטה בסוף תהיה שתמיד כדאי להחליף).

נשים לב שהסכום $latex 10^n$ (אם הוא לפחות 100) מוגרל בדיוק פעמיים: פעם אחת בהסתברות $latex \frac{1}{2^n}$ ואז הוא הסכום ה**קטן** יותר; ופעם אחת בהסתברות $latex \frac{1}{2^{n-1}}$ ואז הוא הסכום ה**גדול** יותר. במילים אחרות, ההסתברות שבמעטפה השנייה יש סכום קטן פי 10 מהסכום במעטפה שלנו היא כפולה מההסתברות שבמעטפה השנייה סכום גדול יותר. אם כן, בהסתברות $latex \frac{1}{3}$ נרוויח מהחלפת המעטפות, ובהסתברות $latex \frac{2}{3}$ נפסיד.

בצורה פורמלית ("בצורה פורמלית" זו דרכי לומר "מי שלא מתעניין בפרטים הטכניים המתמטים, שפשוט יאמין לי ויפסח על הפסקה") הדרך להגיע למספרים אלו היא באמצעות חישוב [הסתברות מותנה](http://he.wikibooks.org/wiki/%D7%94%D7%A1%D7%AA%D7%91%D7%A8%D7%95%D7%AA/%D7%94%D7%A1%D7%AA%D7%91%D7%A8%D7%95%D7%AA_%D7%9E%D7%95%D7%AA%D7%A0%D7%94); ההסתברות של המאורע "ה-$latex 10^n$ שבמעטפה הוא הקטן יותר" היא $latex \frac{1}{2^n}$; ההסתברות של המאורע "יש $latex 10^n$ באחת המעטפות" היא סכום ההסתברויות של שני המקרים שבהם $latex 10^n$ מוכנס למעטפות, דהיינו $latex \frac{1}{2^n}+\frac{1}{2^{n-1}}=\frac{3}{2^n}$. כשמחלקים את ההסתברות הראשונה בשנייה, מקבלים $latex \frac{1}{2^n}/\frac{3}{2^n}=\frac{1}{3}$, דהיינו ההסתברות המותנה של "ההחלפה משתלמת" היא אכן שליש.

כעת ניתן לחשב את תוחלת הרווח במקרה של החלפה. התוחלת הזו היא פשוט:

$latex \frac{1}{3}\cdot 9\cdot 10^n-\frac{2}{3}\cdot 9\cdot 10^{n-1}=30\cdot 10^{n-1}-6\cdot 10^{n-1}=24\cdot 10^{n-1}$

דהיינו, תוחלת רווח חיובית (שיצאה מספר "מכוער" כי לא באמת טרחנו לשפצר את הפרמטרים של הבעיה). לכן תמיד כדאי להחליף, והפרדוקס בעינו נותר. מה הולך כאן?

ובכן, כפי שאמרתי לעיל, אין לי מושג מה הולך כאן. אמרתי שאני תמיד מתייחס לפרדוקסים כאל הוכחות לכך שהנחה שלנו או דרך הסקנת המסקנות שלנו שגויה &#8211; מפרדוקס המעטפות לא נותר לי אלא להסיק שהחלטה על "שווה להחליף" אינה שקולה לחישוב תוחלת הרווח מההחלפה. המסקנה הזו נראית מאוד מוזרה &#8211; איך תמודד את ה"שווה להחליף" אם לא באופן הזה? ולכן מה שהפרדוקס מעיד עליו הוא שבמקרים **מסויימים** זה לא מדד טוב. למרבה המזל, הפתרון ה"מתמטי" של הפרדוקס שעליו הצבעתי קודם נותן לנו מדד כלשהו למקרים המסויימים הללו.

הבה ונשאל את עצמנו שאלה שונה מזו שעסקנו בה עד כה. עד עכשיו עסקנו, למעשה, בתוחלת מותנה: מה הרווח הצפוי לנו מהחלפת מעטפות **בהינתן** שראינו במעטפה שלנו סכום כזה וכזה. כעת נעבור לעסוק בתוחלת הרווח שלנו באופן כללי. דהיינו, אם נשחק את המשחק הרבה פעמים, ותמיד נחליף, מה יהיה הרווח הממוצע שלנו?

אבחנה אידיוטית ראשונה היא שהתוחלת הזו תהיה **שווה** לתוחלת הרווח שלנו במשחק ללא החלפה. הרי את המעטפה המקורית שאנחנו מקבלים, אנחנו מקבלים באקראי מבין השתיים שנבחרו; אם אנחנו תמיד מחליפים, זה שקול לכך שפשוט נקבל באקראי דווקא את המעטפה השנייה, ושתי הסיטואציות שקולות. למי שלא משתכנע &#8211; מהנימוק הזה אבטיח שמבחינה מתמטית הוא תקף וניתן להצדיק אותו. אם כן, לכאורה ההפרש בין תוחלת הרווח שלנו בשתי האסטרטגיות היא אפס (כפי שההגיון אכן אומר); מדוע אם כן כשמסתכלים על התוחלות המותנות מקבלים יתרון להחלפה?

לצורך כך, הבה נחשב בפועל את תוחלת הרווח שלנו. לשם כך עלינו לשאול את עצמנו את השאלה הבאה: נניח שאנחנו לא מחליפים; מה ההסתברות שלנו לקבל את המעטפה שהסכום שבה הוא $latex 10^n$? התשובה לכך היא שקיימות שתי סיטואציות שבהן זה קורה: או שנבחר הזוג $latex 10^n, 10^{n+1}$ בהסתברות $latex \frac{1}{2^n}$ ולאחר מכן בחרנו את $latex 10^n$ מבין שתי המעטפות (בהסתברות $latex \frac{1}{2}$; או שנבחר הזוג $latex 10^{n-1},10^n$ בהסתברות $latex \frac{1}{2^{n-1}}$ ולאחר מכן בחרנו את $latex 10^n$ &#8211; שוב, בהסתברות $latex \frac{1}{2}$. מכאן שההסתברות הכוללת לקבל $latex 10^n$ היא $latex \frac{1}{2}\left(\frac{1}{2^n}+\frac{1}{2^{n-1}}\right)=\frac{1}{2}\cdot\frac{3}{2^{n}}=\frac{3}{2^{n+1}}$. היוצא מן הכלל הוא 10, שמתקבל בהסתברות 1/4 (למה?)

בשלב הזה רצוי לעשות "בדיקת שפיות" ולראות שסכום ההסתברויות של כל הערכים האפשריים (דהיינו, כל החזקות האפשריות של 10) מסתכם ל-1 (זו התכונה הבסיסית של מרחבי הסתברות &#8211; סכום ההסתברות של כל המאורעות הבסיסיים האפשריים צריך להיות 1). זה תרגיל פשוט למדי להיווכח בכך, וגם מי שלא למד טורים אינסופיים באופן פורמלי אולי יוכל להיעזר ב[פוסט](http://www.gadial.net/?p=134) שכתבתי על טורים שכאלו לא מזמן.

אם כן, אפשר לפנות לחישוב התוחלת של הכסף שמקבלים בסה"כ אם בוחרים באסטרטגיית אי-החלפה. על פי הגדרה, היא שווה לסכום על כל אחת מכמויות הכסף שעשויים לקבל, מוכפלת בהסתברות שכמות הכסף הזו תתקבל. פורמלית זה יוצא $latex \frac{10}{4}+3\sum\_{n=2}^\infty\frac{10^n}{2^{n+1}}=\frac{10}{4}+\frac{3}{2}\sum\_{n=2}^\infty\left(\frac{10}{2}\right)^n$.כאן מגיעים לפאנץ' ליין, שהוא מה שחשוב גם אם לא עקבתם אחרי החישובים &#8211; הטור הזה בכלל לא מתכנס. הסכום שלו יעבור כל מספר טבעי אם רק נסכם מספיק איברים בו. פירוש הדבר הוא שהתוחלת היא **אינסופית**, כלומר שאם נשחק במשחק הרבה מאוד פעמים, הזכייה "הממוצעת" שלנו תהיה אינסוף.

ומה יקרה אם דווקא כן נחליף כל פעם את המעטפה? בכמה נזכה אז? כפי שאמרתי, המקרה הזה זהה לחלוטין לקודם מבחינת חישוב התוחלת הכללית, ולכן גם במקרה הזה נקבל אינסוף. לכן גישת ה"נחסר את תוחלת הגישה הראשונה מתוחלת הגישה השניה" לא עובדת כאן &#8211; אי אפשר לחסר אינסוף מאינסוף; אלו לא מספרים ממשיים ואין לפעולת החיסור משמעות עבורם. יתר על כן, אם היינו מנסים למצוא משמעות, היינו מגיעים מהר מאוד לאבסורדים.

למשל, אם למשל היינו מגדירים את החיסור של אינסוף מאינסוף כאפס, היינו אוכלים אותה בגדול כשהיינו מנסים להחיל את השיטה הזו על הפרש הטורים (שסכום כל אחד מהם אינסוף) הבאים: $latex \sum\_{n=1}^\infty (n+1)-\sum\_{n=1}^\infty n$ &#8211; ההפרש הוא מצד אחד אפס, על פי ההגדרה המטופשת שלנו ש"אינסוף פחות אינסוף הוא אפס"; ומצד שני, אם נחסר את הטורים איבר-איבר נקבל טור שסכומו עדיין אינסופי. בקיצור, בעיה.

הייתי שמח לומר שזה מסביר את הכל. שבגלל שבשני המקרים התוחלת היא אינסופית, אין פלא שנוצר הבלבול לפיו נראה שתמיד כדאי להחליף. להגיד שה"כדאי" הזה מבוסס, אי שם עמוק בפנים, על חיסור שתי התוחלות, חיסור שפשוט אינו מוגדר. לרוע המזל, למרות שמבחינה מתמטית כל זה כנראה נכון, האינטואיציה שלי לא משתפת פעולה. הפרדוקס מצביע יפה מאוד על הבעיה שבשימוש במונח "כדאי להחליף" תוך התבססות על רעיונות מתמטיים, ובפרט על השימוש בתוחלת מותנה עבורו; אבל אני לא רואה שום שימוש אפשרי אחר במונח הזה, ואני לא רואה שום פתרון שישביע את דעתי לפרדוקס.

למישהו יש הצעות?