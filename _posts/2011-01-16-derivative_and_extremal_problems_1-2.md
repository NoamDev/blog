---
id: 973
title: "נגזרת - בשביל מה זה טוב? (בעיות קיצון, חלק ב')"
date: 2011-01-16 21:09:19
layout: post
categories: 
  - אנליזה מתמטית
tags: 
  - חשבון אינפיניטסימלי
  - מתמטיקה תיכונית
---
<a href="http://www.gadial.net/?p=969">בפוסט הקודם</a> עסקנו בשתי בעיות "מציאותיות" ובסופו של דבר בנינו מודל מתמטי עבורן שבא לידי ביטוי בפונקציה ממשית מסויימת. זה מעביר אותנו לבעיה הכללית הבאה: נתונה פונקציה ממשית {::nomarkdown}\( f\left(x\right)\){:/nomarkdown}, ואנו רוצים למצוא ערכי {::nomarkdown}\( x\){:/nomarkdown} שעבורם {::nomarkdown}\( f\left(x\right)\){:/nomarkdown} היא מקסימלית או מינימלית. הנחת היסוד שלנו הוא ש-{::nomarkdown}\( f\left(x\right)\){:/nomarkdown} היא פונקציה "נחמדה" - ניתן לגזור אותה, ולהפיק מהנגזרת מידע על {::nomarkdown}\( f\){:/nomarkdown} עצמה. כמו כן, אם {::nomarkdown}\( f\){:/nomarkdown} גזירה אז היא בפרט רציפה ולכן ניתן לצייר אותה בצורה פשוטה בתור קו אחד רציף. באופן פשטני, פונקציה כזו תיראה בתור קו שעולה למעלה, ואז יורד למטה, ואז שוב עולה, ואז שוב יורד, וכדומה (כמובן, היא יכולה להיות אפילו יותר משעממת - {::nomarkdown}\( f\left(x\right)=x\){:/nomarkdown} היא "קו ישר שכל הזמן עולה"). בואו נסתכל על דוגמה:

<strong><a href="http://www.gadial.net/wp-content/uploads/2011/01/silly_function.png"><img class="alignnone size-full wp-image-974" title="silly_function" src="http://www.gadial.net/wp-content/uploads/2011/01/silly_function.png" alt="" width="275" height="364" /></a></strong>

מה שאנחנו רואים הוא שלפונקציה יכולות להיות הרבה נקודות מינימום ומקסימום <strong>מקומיות</strong>. נקודות שאם מסתכלים רק בהן ובסביבה קטנה שלהן, בהן הפונקציה מקבלת את הערך המקסימלי/מינימלי באותה הסביבה. אם אנחנו רוצים להבין איך הפונקציה פחות או יותר נראית, כל הנקודות הללו מעניינות אותנו; ואם אנחנו מעוניינים רק בערך המקסימלי שלה בכלל, גם אז הן מעניינות אותנו - נמצא את כולן ונבדוק באיזו מהן הפונקציה מקבלת את הערך הגדול ביותר.

בואו ננסה להבין מה קורה בנקודת מקסימום, ונחזור לאנלוגיה הרגילה שלנו של "הפונקציה מתארת מיקום, הנגזרת שלה מתארת מהירות, הנגזרת של הנגזרת מתארת תאוצה". חשבו על כדור שנבעט לו לשמיים - בהתחלה הוא עולה עולה עולה, והעלייה הופכת איטית יותר ויותר, עד שהוא פתאום "נעצר", ואז מתחיל ליפול. הנקודה שבו הוא נעצר היא נקודת המקסימום שאליה הגובה הגיע. אנחנו יכולים לאפיין אותה באופן הבא: הן מימין והן משמאל לנקודת הזמן הזו, הגובה של הכדור קטן יותר מאשר הוא בנקודת הזמן עצמה. פורמלית, נקודת מקסימום מקומי {::nomarkdown}\( x_{0}\){:/nomarkdown} מקיימת {::nomarkdown}\( f\left(x_{0}-h\right)\le f\left(x_{0}\right)\){:/nomarkdown} ו-{::nomarkdown}\( f\left(x_{0}+h\right)\le f\left(x_{0}\right)\){:/nomarkdown} עבור כל ה-{::nomarkdown}\( h\){:/nomarkdown} החיוביים שהם קטנים מגודל כלשהו (שיכול להיות קטן כרצוננו - כל שאמרנו הוא שצריך שהנקודת תהיה המקסימלית בסביבה כלשהי אך לא דרשנו כלום על גודלה).

כאן נכנס החשבון הדיפרנציאלי לתמונה. מהי הנגזרת של {::nomarkdown}\( f\){:/nomarkdown} בנקודה {::nomarkdown}\( x_{0}\){:/nomarkdown}? כאן אפשר ללכת בדיוק לפי ההגדרה. אם הנגזרת קיימת, אז היא שווה לגבול {::nomarkdown}\( \lim_{h\to0}\frac{f\left(x_{0}+h\right)-f\left(x_{0}\right)}{h}\){:/nomarkdown}. כאן {::nomarkdown}\( h\){:/nomarkdown} יכול להיות גם חיובי וגם שלילי, אבל ההבנה שלנו לגבי מה שהולך כאן משתפרת אם אנחנו בוחרים להסתכל על כל אחד מהמקרים לחוד. נסמן ב-{::nomarkdown}\( h\to0^{+}\){:/nomarkdown} את "{::nomarkdown}\( h\){:/nomarkdown} שואף לאפס מימין", שפירושו ש-{::nomarkdown}\( h\){:/nomarkdown} מקבל ערכים שהולכים ומתקרבים לאפס אבל כולם חיוביים. בדומה נשתמש גם בסימון {::nomarkdown}\( h\to0^{-}\){:/nomarkdown}. למי שהסימון הזה עדיין מציק לו בגלל מחסור בפורמליות, הנה הגדרה פורמלית: {::nomarkdown}\( \lim_{h\to a^{+}}g\left(h\right)=L\){:/nomarkdown} אם ורק אם לכל {::nomarkdown}\( \varepsilon&gt;0\){:/nomarkdown} קיימת {::nomarkdown}\( \delta&gt;0\){:/nomarkdown} כך שלכל {::nomarkdown}\( a\le h&lt;a+\delta\){:/nomarkdown} מתקיים {::nomarkdown}\( \left\|g\left(h\right)-L\right\|&lt;\varepsilon\){:/nomarkdown}. כעת ארשה לעצמי להשתמש בסימון הזה בחופשיות.

אם כן, מהו {::nomarkdown}\( \lim_{h\to0^{+}}\frac{f\left(x_{0}+h\right)-f\left(x_{0}\right)}{h}\){:/nomarkdown}? אנחנו לא יודעים את הערך המדוייק של הנגזרת, אבל דבר אחד אפשר לומר בודאות - היא <strong>קטנה או שווה לאפס</strong>. למה? ובכן, כי היצור {::nomarkdown}\( \frac{f\left(x_{0}+h\right)-f\left(x_{0}\right)}{h}\){:/nomarkdown} הוא שלילי או אפס תמיד - {::nomarkdown}\( h\){:/nomarkdown} חיובי, אבל המונה תמיד שלילי או אפס ל-{::nomarkdown}\( h\){:/nomarkdown} קטנים מספיק כי {::nomarkdown}\( f\left(x_{0}\right)\ge f\left(x_{0}+h\right)\){:/nomarkdown} לכל ה-{::nomarkdown}\( h\){:/nomarkdown}-ים הקטנים מספיק. גבול של פונקציה שהיא אי-חיובית באיזור הנקודה אליה שואפים גם הוא אי-חיובי (זה תרגיל פשוט להוכיח את זה - אם הגבול דווקא כן חיובי אפשר למצוא סביבה כלשהי של הנקודה אליה שואפים שבה הפונקציה אף היא חיובית).

את אותו תעלול אפשר לעשות גם עבור {::nomarkdown}\( \lim_{h\to0^{-}}\frac{f\left(x_{0}+h\right)-f\left(x_{0}\right)}{h}\){:/nomarkdown} אבל כאן מתהפכים היוצרות - המכנה הוא עדיין אי-חיובי, אבל כעת המונה הוא שלילי (כי {::nomarkdown}\( h\){:/nomarkdown} נלקח מבין המספרים הקטנים מאפס). לכן המנה היא אי-שלילית, ולכן גם הגבול הוא אי שלילי. קיבלנו ש-{::nomarkdown}\( f^{\prime}\left(x_{0}\right)\){:/nomarkdown} הוא מצד אחד אי שלילי, ומצד שני אי חיובי, ולכן {::nomarkdown}\( f^{\prime}\left(x_{0}\right)=0\){:/nomarkdown}. מסקנה: בנקודת מקסימום הנגזרת מתאפסת. באותו אופן מראים גם שבנקודת מינימום הנגזרת מתאפסת. לתוצאה הזו קוראים "משפט פרמה", אם כי אין הכוונה ל"משפט האחרון של פרמה" המפורסם - פרמה היה מתמטיקאי עסוק וגילה דברים בתחומים רבים, כולל בתחום שרק עשרות שנים אחר כך, בימי ניוטון ולייבניץ, יהפוך להיות החשבון הדיפרנציאלי והאינטגרלי שאנו מכירים.

החישוב היבש שלמעלה הוא לדעתי התחלה לא רעה להבין מה קורה שם ולמה זה נכון, אבל אינטואיציה טובה יותר באה אם חושבים על הנגזרת בתור שיפוע המשיק לפונקציה בנקודה. משיק, זכרו, הוא קו שהכיוון שלו הוא הכיוון שאליו הפונקציה "הולכת". נקודת מקסימום היא מעין גבעה; עד אליה המשיק הוא בשיפוע חיובי - האף שלו מצביע למעלה. מייד אחרי הגבעה האף של המשיק מצביע למטה. באמצע הדרך המשיק היה צריך להשפיל את האף שלו. דמיינו אותו מסתובב - אי שם באמצע הסיבוב המשיק הוא מאוזן לגמרי. זוהי דוגמה ל<strong>רציפות</strong>: תנועת הסיבוב שהמשיק מבצע היא רצופה - הוא לא "קופץ" לפתע ממצב שבו הוא מצביע למעלה למצב שבו הוא מצביע למטה אלא עובר בכל מצבי הביניים האפשריים, וזה שבו הוא מיושר לגמרי בפרט. מכיוון שחלקיק שניה לפני המצב הזה המשיק עוד מצביע למעלה ולכן הפונקציה עולה, וחלקיק שניה אחרי כן הראש מצביע למטה והפונקציה יורדת, הרגע שבו הוא מאוזן לחלוטין הוא בדיוק בראש הגבעה. משיק מאוזן פירושו שיפוע 0, ולכן נגזרת 0. מכאן האינטואיציה שלי.

אם כן, שיטת העבודה שלנו כדי למצוא נקודות מינימום ומקסימום היא פשוטה - גוזרים את הפונקציה ובודקים באילו נקודות הנגזרת מתאפסת. כל נקודת מינימום או מקסימום תצוץ כך. לרוע המזל, יש סיכוי שיצוצו עוד נקודות. הביטו בגרף של {::nomarkdown}\( f\left(x\right)=x^{3}\){:/nomarkdown}:

<strong><a href="http://www.gadial.net/wp-content/uploads/2011/01/x3.png"><img class="alignnone size-full wp-image-975" title="x3" src="http://www.gadial.net/wp-content/uploads/2011/01/x3.png" alt="" width="402" height="408" /></a></strong>

בנקודה {::nomarkdown}\( x=0\){:/nomarkdown} הפונקציה מתיישרת לשניה, והנגזרת ({::nomarkdown}\( 3x^{2}\){:/nomarkdown}) אכן מתאפסת. אבל הפונקציה ממשיכה לעלות גם אחר כך. לפונקציה הזו בכלל אין נקודות מינימום ומקסימום. אז מה קרה כאן? ב-{::nomarkdown}\( x=0\){:/nomarkdown} היה לפונקציה מה שמכונה "נקודת פיתול". נקודה שבה היא עוברת מ<strong>קמירות</strong> ל<strong>קעירות</strong> או להיפך; והנה כי כן צריך להבין גם את שני המושגים הללו כדי להבין עד הסוף מה המידע שהנגזרת נותנת לנו.

בואו נביט בגרפים של שתי הפונקציות הבאות, {::nomarkdown}\( f\left(x\right)=x^{2}\){:/nomarkdown} ו-{::nomarkdown}\( g\left(x\right)=\sqrt{x}\){:/nomarkdown}:

<a href="http://www.gadial.net/wp-content/uploads/2011/01/concave_and_convex.png"><img class="alignnone size-full wp-image-976" title="concave_and_convex" src="http://www.gadial.net/wp-content/uploads/2011/01/concave_and_convex.png" alt="" width="387" height="369" /></a>

שתיהן פונקציות עולות. שתיהן מקיימות {::nomarkdown}\( f\left(0\right)=g\left(0\right)=0\){:/nomarkdown} {::nomarkdown}\( f\left(1\right)=g\left(1\right)=1\){:/nomarkdown}, כלומר הן מתחילות מגובה 0 בזמן 0, ומגיעות לגובה 1 בזמן 1, ועם זאת מבט אחד בגרף של שתיהן מבהיר לנו ששתיהן בעלות אופי שונה לגמרי. מה ההבדל? ש-{::nomarkdown}\( f\left(x\right)=x^{2}\){:/nomarkdown} היא פונקציה <strong>קמורה</strong> בעוד {::nomarkdown}\( g\left(x\right)=\sqrt{x}\){:/nomarkdown} היא פונקציה <strong>קעורה</strong>. השמות מבלבלים: {::nomarkdown}\( f\left(x\right)=x^{2}\){:/nomarkdown} היא הפונקציה שיותר דומה לקערה ("פרבולה צוחקת" - זה יהיה יותר ברור אם נצייר את הפונקציה גם לערכים שליליים של {::nomarkdown}\( x\){:/nomarkdown}) ולמרות זאת המילה "קעורה" שמורה לפונקציה שנראית כמו קערה הפוכה. באנגלית המילה המתאימה ל"קמורה" היא Convex ול"קעורה" היא Concave ויש קצת יותר הגיון בהן, אבל לא ניכנס לכך כאן.

אז מה ההבדל ה<strong>איכותי</strong> ביניהן ואיך אפשר לתאר אותו במדוייק? ההבדל הוא ש-{::nomarkdown}\( x^{2}\){:/nomarkdown} היא פונקציה שהמהירות שלה <strong>גדלה עם הזמן</strong>, בעוד ש-{::nomarkdown}\( \sqrt{x}\){:/nomarkdown} היא פונקציה שהמהירות שלה <strong>קטנה עם הזמן</strong>. תחשבו על שני רצים - אחד שמתחיל מהר והולך ומתעייף - זה {::nomarkdown}\( \sqrt{x}\){:/nomarkdown}; ואחד שמתחיל לאט אבל לאט לאט הופך למהיר יותר ויותר - זה {::nomarkdown}\( x^{2}\){:/nomarkdown}. הרץ הראשון יתחיל את המירוץ ביתרון, אבל מתישהו שני הרצים ייפגשו בדרך (בדיוק ב-{::nomarkdown}\( x=1\){:/nomarkdown}) ומכאן ואילך הרץ השני יהיה בעל ההובלה. איפה טמון ההבדל המתמטי בין שני הרצים? הראשון הוא בעל מהירות התחלתית גבוהה אבל תאוצה <strong>שלילית</strong> (מהירותו קטנה), ואילו השני מתחיל עם מהירות התחלתית נמוכה אבל תאוצה <strong>חיובית</strong> (מהירותו גדלה). "תאוצה" היא, כזכור, הנגזרת השנייה של פונקציה (קצב השינוי של קצב השינוי שלה), ומכאן המסקנה: פונקציה היא קמורה בנקודה כלשהי (ליתר דיוק - בסביבה של נקודה כלשהי) אם הנגזרת השנייה שלה באותה נקודה היא חיובית, והיא קעורה אם הנגזרת השנייה שלילית.

יש לקמירות וקעירות גם הגדרה כללית יותר, שעובדת גם עבור פונקציות שהן לא בהכרח גזירות. ההגדרה שנתתי כרגע הייתה "נקודתית", אבל בפועל קמירות וקעירות הן תכונות שבאות לידי ביטוי על פי התנהגות הפונקציה בתוך קטע שלם, לא רק בנקודה מבודדת. לכן בואו נביט על קטע {::nomarkdown}\( \left[a,b\right]\){:/nomarkdown}. הוא מייצג פרק זמן מסויים, שבמהלכו שני הרצים שלנו, זה של {::nomarkdown}\( f\){:/nomarkdown} וזה של {::nomarkdown}\( g\){:/nomarkdown}, עוברים את המרחק שבין {::nomarkdown}\( f\left(a\right)\){:/nomarkdown} ל-{::nomarkdown}\( f\left(b\right)\){:/nomarkdown}. בואו נכניס לתמונה כעת רץ שלישי, {::nomarkdown}\( h\){:/nomarkdown}, שגם הוא רץ מ-{::nomarkdown}\( f\left(a\right)\){:/nomarkdown} אל {::nomarkdown}\( f\left(b\right)\){:/nomarkdown} (כלומר, {::nomarkdown}\( f\left(a\right)=g\left(a\right)=h\left(a\right)\){:/nomarkdown} ו-{::nomarkdown}\( f\left(b\right)=g\left(b\right)=h\left(b\right)\){:/nomarkdown}) אבל הוא הרץ הכי יציב מבין שלושתם: את כל הדרך הוא עובר במהירות קבועה. אם נצייר את גרף הריצה שלו, הוא יהיה קו ישר ששיפועו {::nomarkdown}\( \frac{h\left(b\right)-h\left(a\right)}{b-a}\){:/nomarkdown}.

הטענה שלי היא כזו: הרץ שהתחיל לאט ואט אט מגדיל את מהירותו, שתואר על ידי {::nomarkdown}\( f\){:/nomarkdown}, תמיד מפגר מאחורי הרץ היציב {::nomarkdown}\( h\){:/nomarkdown} עד לנקודה שבה הם נפגשים. כלומר, לא ייתכן שיש רגע שבו {::nomarkdown}\( f\left(x\right)&gt;h\left(x\right)\){:/nomarkdown} בכל הקטע {::nomarkdown}\( \left[a,b\right]\){:/nomarkdown}. למה? חשבו על זה כך: בהתחלה מהירות הריצה של {::nomarkdown}\( f\){:/nomarkdown} קטנה מזו של {::nomarkdown}\( h\){:/nomarkdown} (כי אם היא הייתה גדולה מזו של {::nomarkdown}\( h\){:/nomarkdown} <strong>בהתחלה</strong>, והמהירות של {::nomarkdown}\( f\){:/nomarkdown} רק גדלה עוד ועוד עם הזמן, אז בנקודה {::nomarkdown}\( b\){:/nomarkdown} בהכרח {::nomarkdown}\( f\){:/nomarkdown} היה חייב להיות הרחק מעבר ל-{::nomarkdown}\( h\){:/nomarkdown}). כדי ש-{::nomarkdown}\( f\){:/nomarkdown} יצליח להשיג את {::nomarkdown}\( h\){:/nomarkdown} חייב להיות רגע שבו מהירותו של {::nomarkdown}\( f\){:/nomarkdown} עוברת את זו של {::nomarkdown}\( h\){:/nomarkdown}, אבל מאותו רגע ואילך המהירות של {::nomarkdown}\( f\){:/nomarkdown} תהיה גדולה יותר <strong>תמיד</strong> מזו של {::nomarkdown}\( h\){:/nomarkdown}, ולכן אחרי הפעם הראשונה שבה הוא יעקוף אותו, {::nomarkdown}\( h\){:/nomarkdown} לעולם לא ישיג אותו מחדש. נקודת המפגש הזו היא רק ב-{::nomarkdown}\( b\){:/nomarkdown} ולכן עד אז {::nomarkdown}\( f\){:/nomarkdown} חייב לפגר אחרי {::nomarkdown}\( h\){:/nomarkdown}. מטיעונים סימטריים לגמרי מקבלים ש-{::nomarkdown}\( g\){:/nomarkdown} תמיד <strong>משיג</strong> את {::nomarkdown}\( h\){:/nomarkdown} עד לנקודה {::nomarkdown}\( b\){:/nomarkdown}.

במילים אחרות, אם משרטטים את התנועה של {::nomarkdown}\( f\){:/nomarkdown}, ואז בוחרים שתי נקודות על הגרף ומותחים ביניהן קו, אז הגרף של {::nomarkdown}\( f\){:/nomarkdown} בין אותן שתי נקודות יהיה תמיד <strong>מתחת</strong> לקו. בדומה עם {::nomarkdown}\( g\){:/nomarkdown} הגרף של הפונקציה יהיה תמיד <strong>מעל</strong> לקו. בנוסחה אומרים שפונקציה (כללית) {::nomarkdown}\( f\){:/nomarkdown} היא קמורה בקטע {::nomarkdown}\( \left[a,b\right]\){:/nomarkdown} אם לכל {::nomarkdown}\( x\in\left[a,b\right]\){:/nomarkdown} מתקיים {::nomarkdown}\( f\left(x\right)\le\frac{f\left(b\right)-f\left(a\right)}{b-a}\){:/nomarkdown}. לפונקציות קעורות זה אותו דבר עם היפוך סימן אי השוויון.

בואו נמשיך עוד רגע עם האנלוגיה ל"הרץ שנע במהירות קבועה" כדי להבין עוד תופעה מבלבלת אחת שמתרחשת עם פונקציות קמורות וקעורות. בואו נניח ש-{::nomarkdown}\( f\){:/nomarkdown} היא קמורה - כזכור, זה אומר שהיא מייצגת "רץ שהמהירות שלו גדלה כל הזמן". בואו ניקח נקודה כלשהי על גרף הפונקציה ונצייר את המשיק לאותה נקודה. מהו המשיק הזה? קו ישר, ששיפועו מייצג את המהירות הרגעית של {::nomarkdown}\( f\){:/nomarkdown} ברגע שמיוצג על ידי אותה נקודה. נקודות אחרות על הישר מייצגות את "איפה נמצא רץ שמהירותו קבועה ושווה למהירות בנקודת ההשקה ברגעים אחרים". תדמיינו לעצמכם את הרץ של {::nomarkdown}\( f\){:/nomarkdown} מתרוצץ לו, ואז פתאום אנחנו מקפיאים את התמונה ומציירים לידו רץ חדש, כך שמהירות הרץ החדש שווה למהירות של {::nomarkdown}\( f\){:/nomarkdown} ברגע שהקפאנו. כעת אנו ממשיכים להריץ את הסרט, מה קורה? ברור ש-{::nomarkdown}\( f\){:/nomarkdown} יעבור את הרץ החדש, כי המהירות של {::nomarkdown}\( f\){:/nomarkdown} תהיה גדולה משל הרץ החדש (אמרנו ש-{::nomarkdown}\( f\){:/nomarkdown} מגדיל כל הזמן את מהירותו בעוד שהרץ החדש רץ במהירות קבועה).

אוקיי, עכשיו בואו נריץ את הסרט <strong>אחורה</strong>. האינטואיציה שלי אומרת שבמקרה הזה הרץ החדש צריך <strong>להשיג</strong> את {::nomarkdown}\( f\){:/nomarkdown} כי הוא מהיר יותר - ככל שמריצים את הסרט אחורה, המהירות של {::nomarkdown}\( f\){:/nomarkdown} נהיית קטנה יותר ויותר ביחס לזו של הרץ החדש. אבל האינטואיציה שלי פשוט שגויה - אם נריץ את הסרט אחורה, עדיין נראה את {::nomarkdown}\( f\){:/nomarkdown} משיג את הרץ החדש. למה? ובכן, כי אם הרץ החדש היה משיג את {::nomarkdown}\( f\){:/nomarkdown}, והמהירות של הרץ החדש <strong>גדולה</strong> מזו של {::nomarkdown}\( f\){:/nomarkdown} עד לשלב שבו הם נפגשים (ואז היא שווה), איך בדיוק {::nomarkdown}\( f\){:/nomarkdown} יצליח להשיג אותו כך שהם ייפגשו?

הסרט המלא, אם כן, הוא זה: {::nomarkdown}\( f\){:/nomarkdown} רץ לו בניחותא ולאט לאט מגדיל את מהירותו. הרץ החדש רץ אליו במהירות קבועה ולאט לאט מצמצם את הפער... מתקרב... מתקרב... משיג אותו! אבל בשניה שאחר כך {::nomarkdown}\( f\){:/nomarkdown} כבר נהיה מהיר מדי והרץ החדש נשאר מאחור. כלומר, הרץ החדש אף פעם לא עובר את {::nomarkdown}\( f\){:/nomarkdown}. ובמתמטיקה: המשיק ל-{::nomarkdown}\( f\){:/nomarkdown} בנקודה כלשהי, בתנאי ש-{::nomarkdown}\( f\){:/nomarkdown} קמורה בסביבת הנקודה הזו, נמצא כולו <strong>מתחת</strong> לגרף הפונקציה. שימו לב לבלבול - המשיק כולו <strong>מתחת</strong>, אבל אם מסתכלים על המיתר שמחבר שתי נקודות בסביבה של נקודת ההשקה, המיתר כולו <strong>מעל</strong>. אני מקווה שעם כל האינטואיציות שניסיתי לתת כאן העסק קצת פחות מבלבל.

עבור פונקציות קעורות כל הדיון עובד באותה מידה, כצפוי, ומקבלים שהמשיק בנקודה כלשהי הוא תמיד <strong>מעל</strong> לגרף הפונקציה.

טוב, סיימנו את הדיון הזה בפונקציות קמורות וקעורות - איך זה מתקשר לנקודות מינימום ומקסימום? בפשטות - בנקודת מינימום הפונקציה קמורה, ובנקודת מקסימום הפונקציה קעורה. זה נותן לנו קריטריון מיידי לזיהוי נקודות קיצון: אם הנגזרת הראשונה של הפונקציה היא אפס והשנייה היא חיובית, אז זוהי נקודת <strong>מינימום</strong>, אם הנגזרת הראשונה היא אפס והשניה שלילית, זוהי נקודת <strong>מקסימום</strong>, ואם גם הנגזרת השניה היא אפס אנחנו בצרות - הכל יכול לקרות.

שתי הדוגמאות הבסיסיות ל"הכל יכול לקרות" הן פשוטות מאוד: {::nomarkdown}\( f\left(x\right)=x^{3}\){:/nomarkdown} ו-{::nomarkdown}\( f\left(x\right)=x^{4}\){:/nomarkdown}. בדוגמה של {::nomarkdown}\( f\left(x\right)=x^{3}\){:/nomarkdown} מה שקורה בנקודה {::nomarkdown}\( x=0\){:/nomarkdown} הוא מה שקראתי לו "נקודת פיתול" - רגע לפני הפונקציה קעורה ורגע אחרי היא קמורה, וכל זה מבלי שהיא תפסיק לעלות מעלה. פורמלית זה מתבטא בכך שהנגזרת הראשונה בסביבות הנקודה הזו היא חיובית, והנגזרת השניה היא שלילית לפני 0 וחיובית אחרי 0. אם נחזור לדוגמת הרץ, מה שיש לנו פה הוא אדם שרץ ומאיט אט אט, נעצר לשבריר שניה ב-{::nomarkdown}\( x=0\){:/nomarkdown}, ואז מתחיל להאיץ מחדש. במשך כל הזמן הזה הוא מתקדם קדימה.

לעומת זאת ב-{::nomarkdown}\( f\left(x\right)=x^{4}\){:/nomarkdown} הנגזרת הראשונה היא אפס אבל שלילית לפני אפס וחיובית אחריו - מכאן שיש לנו פה נקודת מינימום - הרץ רץ "אחורה" עד ל-{::nomarkdown}\( x=0\){:/nomarkdown} ואז התחיל לרוץ "קדימה". אם היינו מנסים להבין זאת דרך הנגזרת השנייה היינו מסתבכים בצרות - הנגזרת השנייה היא גם כן אפס. וגם השלישית! רק הנגזרת הרביעית אינה אפס אלא מספר חיובי. זה מוביל אותנו לקריטריון המוזר הבא: אם הנגזרת הראשונה שאינה מתאפסת היא רציפה ומספרה זוגי, הנקודה היא היא נקודת מינימום או מקסימום (בהתאם לערכה של אותה נגזרת שלא התאפסה), ואם היא נגזרת (רציפה) שמספרה אי זוגי, הנקודה היא נקודת פיתול. תכף אסביר את הקריטריון הזה אבל עוד קודם לכן אעיר שזה לא סוף הסיפור - הנגזרת עשויה להיות לא מוגדרת בכלל, ולמרות זאת עדיין תהיה משמעות לשאלה אם הנקודה היא נקודת מינימום, מקסימום או פיתול (כל אלו הן תכונות "מקומיות" שלא דורשות נגזרת שניה אלא רק ראשונה). במקרים כאלו ייתכן שהנקודה לא תהיה לא נקודת מינימום, לא נקודת מקסימום וגם לא נקודת פיתול - דוגמה לפתולוגיה כזו היא הפונקציה {::nomarkdown}\( f\left(x\right)=x^{2}\sin\left(\frac{1}{x}\right)\){:/nomarkdown} שמוגדרת להיות 0 בנקודה 0, ואפשר להוכיח שהיא רציפה ואפילו גזירה (פעם אחת בלבד!) ב-{::nomarkdown}\( x=0\){:/nomarkdown}, וערך הנגזרת שם הוא 0, אבל אין שם לא נקודת קיצון וגם לא נקודת פיתול. בחיי היום יום בדרך כלל לא נתקלים בתופעות מטורללות שכאלו.

טוב, אז בואו נבין את הקריטריון שהצגתי לזיהוי נקודות קיצון אל מול נקודות פיתול. אני חושב שכדאי להתחיל כאן מהסוף - מהנגזרת הראשונה שאינה אפס - ולטפס מעלה. בואו נניח ש-{::nomarkdown}\( f^{\left(n\right)}\left(x_{0}\right)=C\){:/nomarkdown} כך ש-{::nomarkdown}\( C&gt;0\){:/nomarkdown} וה-{::nomarkdown}\( n\){:/nomarkdown} שהוא לכאורה חזקה של {::nomarkdown}\( f\){:/nomarkdown} מציין שזוהי הנגזרת ה-{::nomarkdown}\( n\){:/nomarkdown}-ית. כמו כן {::nomarkdown}\( f^{\left(1\right)}\left(x_{0}\right)=\dots=f^{\left(n-1\right)}\left(x_{0}\right)=0\){:/nomarkdown}. אז מה קורה כאן?

מכיוון ש-{::nomarkdown}\( C&gt;0\){:/nomarkdown} אז {::nomarkdown}\( f^{\left(n\right)}\){:/nomarkdown} (שהיא רציפה, הנחנו) היא חיובית בסביבה של {::nomarkdown}\( x_{0}\){:/nomarkdown}. לכן {::nomarkdown}\( f^{\left(n-1\right)}\){:/nomarkdown} היא פונקציה <strong>עולה</strong> בסביבות {::nomarkdown}\( x_{0}\){:/nomarkdown}. מכיוון שב-{::nomarkdown}\( x_{0}\){:/nomarkdown} היא אפס, הרי שלפני {::nomarkdown}\( x_{0}\){:/nomarkdown} היא שלילית, ואחרי כן היא חיובית. זה אומר, וכאן העסק מתחיל להיות מבלבל, ש-{::nomarkdown}\( f^{\left(n-2\right)}\){:/nomarkdown} היא שוב פונקציה שהיא תמיד חיובית. למה? כי לפני {::nomarkdown}\( x_{0}\){:/nomarkdown} היא ירדה, ובדיוק ב-{::nomarkdown}\( x_{0}\){:/nomarkdown} היא הייתה אפס, אז לפני כן היא הייתה חייבת להיות חיובית; ואחרי {::nomarkdown}\( x_{0}\){:/nomarkdown} היא שוב עולה מעלה. אבל זה אומר ש-{::nomarkdown}\( f^{\left(n-2\right)}\){:/nomarkdown} לא שונה עקרונית מ-{::nomarkdown}\( f^{\left(n\right)}\){:/nomarkdown}, ולכן אפשר להמשיך את המשחק הזה עוד ועוד עד שמגיעים חזרה למעלה. נקבל בסופו של דבר ש-{::nomarkdown}\( f^{\prime}\){:/nomarkdown} היא או פונקציה שלילית-ואז-חיובית, ואז נקבל ש-{::nomarkdown}\( x_{0}\){:/nomarkdown} היא נקודת מינימום, או ש-{::nomarkdown}\( f^{\prime}\){:/nomarkdown} היא חיובית תמיד ואז {::nomarkdown}\( f^{\prime\prime}\){:/nomarkdown} היא הפונקציה שהיא שלילית-ואז-חיובית, כלומר {::nomarkdown}\( x_{0}\){:/nomarkdown} היא נקודת פיתול.

ואחרי כל המהומה הזו, איך אני פותר את השאלות שמהן התחלתי את הדיון? ובכן, האתגר הראשון היה למצוא איפה ל-{::nomarkdown}\( \sin\left(2\theta\right)\){:/nomarkdown} יש מקסימום בהינתן ש-{::nomarkdown}\( \theta\){:/nomarkdown} הוא בין 0 ל-90 מעלות. גזירה של הפונקציה מניבה את {::nomarkdown}\( 2\cos\left(2\theta\right)\){:/nomarkdown}. קוסינוס מתאפס בתשעים מעלות, כך שהפונקציה הזו מתאפסת ב-45 מעלות. גזירה נוספת מניבה את {::nomarkdown}\( -4\sin\left(2\theta\right)\){:/nomarkdown}, וכשמציבים 45 מעלות ל-{::nomarkdown}\( \theta\){:/nomarkdown}מקבלים שערך הנגזרת השנייה בנקודה ה"חשודה" הוא -4. נגזרת שנייה שלילית - נקודת מקסימום. סיימנו; 45 מעלות היא הזווית האופטימלית (ומי שמדגדג לו לצעוק עלי להשתמש כאן ברדיאנים - אל).

נעבור לדוגמת החתונות. שם, כזכור, המטרה הייתה למצוא את המינימום של הפונקציה {::nomarkdown}\( f\left(x\right)=A+\left(b-c\left(x\right)\right)x\){:/nomarkdown} כאשר {::nomarkdown}\( c\left(x\right)\){:/nomarkdown} היא פונקציה אחרת כלשהי (שהאופי שלה ישפיע מאוד על התוצאה). אם נגזור את {::nomarkdown}\( f\){:/nomarkdown} נקבל {::nomarkdown}\( f^{\prime}\left(x\right)=\left(b-c\left(x\right)\right)-xc^{\prime}\left(x\right)\){:/nomarkdown}. מייד שמים לב למשהו מעניין - הפרמטר {::nomarkdown}\( A\){:/nomarkdown}, שתיאר את ההוצאות הקבועות על חתונה, בכלל לא משתתף במשחק. מה שחשוב הוא רק המחיר למנה {::nomarkdown}\( b\){:/nomarkdown}, והאופי של התשלומים שמשלמים האורחים, {::nomarkdown}\( c\){:/nomarkdown}. פוטנציאל לנקודת קיצון יש במקום שבו הפונקציה מתאפסת, כלומר {::nomarkdown}\( \left(b-c\left(x\right)\right)-xc^{\prime}\left(x\right)=0\){:/nomarkdown}, כלומר {::nomarkdown}\( b=c\left(x\right)+xc^{\prime}\left(x\right)\){:/nomarkdown}. אנו מעוניינים מראש רק בערכי {::nomarkdown}\( x\){:/nomarkdown} חיוביים כי הם מייצגים מספר חיובי - מספר האורחים שהוזמנו לחתונה. כעת אין מנוס אלא לבדוק דוגמאות קונקרטיות של {::nomarkdown}\( c\left(x\right)\){:/nomarkdown} ולראות מה קורה איתן.

דרך פשוטה לבנות פונקציה כזו היא להחליט מה יהיו חלק מהערכים שלה בנקודות מסויימות ואז לבצע <strong>אינטרפולציה</strong>: למצוא פונקציה פשוטה שמקבלת את הערכים באותן הנקודות. אני אבצע אינטרפולציה פשוטה במיוחד, שבהינתן שתי נקודות מחזירה את הקו הישר שעובר דרכן. בואו נניח שאם יש 0 אורחים אז התשלום הממוצע הוא {::nomarkdown}\( 4b\){:/nomarkdown}, ואם יש 100 אורחים אז התשלום הממוצע הוא {::nomarkdown}\( \frac{b}{2}\){:/nomarkdown}. זה תרגיל פשוט לראות שבמקרה הזה, {::nomarkdown}\( c\left(x\right)=4b-\frac{7b}{200}x\){:/nomarkdown}. הנגזרת גם היא פשוטה: {::nomarkdown}\( c^{\prime}\left(x\right)=-\frac{7b}{200}\){:/nomarkdown}, ולכן כדי שיתקיים השוויון שלעיל צריך להתקיים {::nomarkdown}\( b=4b-\frac{7b}{200}x-\frac{7b}{200}x\){:/nomarkdown}, כלומר {::nomarkdown}\( 3b=\frac{7b}{100}x\){:/nomarkdown}, כלומר {::nomarkdown}\( x=\frac{300}{7}\){:/nomarkdown} - בערך 42 אורחים. שימו לב שהתוצאה הסופית לא תלויה אפילו ב-{::nomarkdown}\( b\){:/nomarkdown}: היא תלויה רק בפרמטרים שאני בחרתי (תשלום שבהתחלה הוא פי ארבע וכשיש 100 אורחים קופץ להיות חצי). אנחנו רואים, אם כן, שבסופו של דבר התשובה לשאלה "כמה אורחים כדאי להזמין" תלויה באופן כמעט בלעדי ביכולת שלנו להעריך כמה מהר יצנח התשלום שלהם, וזה כמובן נתון שלא ניתן להגיע אליו באופן מתמטי טהור נטו - הוא תלוי באלף ואחד גורמים וכנראה שאומדנים על בסיס סטטיסטיקות עבר הם הדרך הטובה ביותר להעריך אותו. אל תתנו לאנשים לסובב אתכם עם מספרים כשהם מנסים לטעון משהו על המספר האופטימלי של מוזמנים בחתונה שלכם!

עוד דוגמה קטנה לסיום: מהו המלבן בעל השטח הגדול ביותר ביחס להיקף שלו? אם אתם רוצים לבנות גדר לשטח ריבועי ולהשקיע כמה שפחות מאמץ וחומרים בבניה ושהשטח שאתם לוכדים יהיה מקסימלי, מה כדאי לכם לעשות? בואו נניח שיש לנו בסך הכל {::nomarkdown}\( N\){:/nomarkdown} מטרים של גדר שאפשר להשתמש בהם. אם נבנה מלבן שאורך צלעו האחת {::nomarkdown}\( x\){:/nomarkdown}, אז אורך צלעו השניה יהיה חייב להיות {::nomarkdown}\( \frac{N}{2}-x\){:/nomarkdown} (בדקו זאת!) ולכן השטח יהיה {::nomarkdown}\( f\left(x\right)=x\cdot\left(\frac{N}{2}-x\right)=\frac{N}{2}x-x^{2}\){:/nomarkdown}. הנגזרת היא {::nomarkdown}\( f^{\prime}\left(x\right)=\frac{N}{2}-2x\){:/nomarkdown} והיא מתאפסת כאשר {::nomarkdown}\( 2x=\frac{N}{2}\){:/nomarkdown}, כלומר כאשר {::nomarkdown}\( x=\frac{N}{4}\){:/nomarkdown}. קל לבדוק במצב כזה שזוהי אכן נקודת מקסימום (הנגזרת השנייה שלילית) ומכאן, באופן לחלוטין לא מפתיע, שריבוע היא הצורה הטובה ביותר.

אם כן, זה הרעיון הכללי של שימוש בנגזרות לפתרון בעיות קיצון. זה שימוש כה מיידי ופשוט, עד כי הוא נלמד גם בבית הספר - ולטעמי זו הזדמנות אחת לראות כבר בבית הספר יופי מתמטי. כאן מגיע מושג הנגזרת, שלכאורה מדבר על משהו לא קשור, וניתן להשתמש בו כדי לפתור בעיות מעניינות שהמילה "נגזרת" לא מוזכרת ולו ברמז בתיאור שלהן. למרות כל הזמן שחלף מאז שנתקלתי בשימוש הזה של נגזרות לראשונה, ולמרות שבבית הספר הוא הסתכם בגזירה שוב ושוב של המוני פונקציות מייגעות, אני עדיין מתלהב כשאני כותב עליו.
